var en=Object.defineProperty;var tn=(n,e,s)=>e in n?en(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s;var ne=(n,e,s)=>tn(n,typeof e!="symbol"?e+"":e,s);import{r as k,a as sn,g as ss,R as U,b as rn,c as ee}from"./vendor-B-wuX89F.js";import{C as Qs,H as rs,M as ve,F as Ys,X as Dt,S as nn,E as ye,B as ns,a as as,b as is,c as an,A as on,U as ln,d as cn,T as dn,P as dt,e as ut,f as un,I as hn,g as gn,h as Ve,i as mn,j as Zs,k as fn,L as pn,l as xn,m as Nt,n as Mt,o as Re,p as ft,q as pt,r as gs,s as xt,t as bn,u as ms,v as yn,w as vn,D as wn,x as jn,y as _n,z as Nn}from"./icons-DUjGwAU-.js";import{N as Sn,u as je,L as B,a as kn,b as De,B as En,R as Cn,c as z}from"./router-Sr1wJwBh.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();var Xs={exports:{}},bt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tn=k,Pn=Symbol.for("react.element"),An=Symbol.for("react.fragment"),On=Object.prototype.hasOwnProperty,In=Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$n={key:!0,ref:!0,__self:!0,__source:!0};function er(n,e,s){var r,a={},i=null,o=null;s!==void 0&&(i=""+s),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)On.call(e,r)&&!$n.hasOwnProperty(r)&&(a[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:Pn,type:n,key:i,ref:o,props:a,_owner:In.current}}bt.Fragment=An;bt.jsx=er;bt.jsxs=er;Xs.exports=bt;var t=Xs.exports,tr,fs=sn;tr=fs.createRoot,fs.hydrateRoot;var Rn=typeof Element<"u",Ln=typeof Map=="function",Dn=typeof Set=="function",Mn=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function ot(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){if(n.constructor!==e.constructor)return!1;var s,r,a;if(Array.isArray(n)){if(s=n.length,s!=e.length)return!1;for(r=s;r--!==0;)if(!ot(n[r],e[r]))return!1;return!0}var i;if(Ln&&n instanceof Map&&e instanceof Map){if(n.size!==e.size)return!1;for(i=n.entries();!(r=i.next()).done;)if(!e.has(r.value[0]))return!1;for(i=n.entries();!(r=i.next()).done;)if(!ot(r.value[1],e.get(r.value[0])))return!1;return!0}if(Dn&&n instanceof Set&&e instanceof Set){if(n.size!==e.size)return!1;for(i=n.entries();!(r=i.next()).done;)if(!e.has(r.value[0]))return!1;return!0}if(Mn&&ArrayBuffer.isView(n)&&ArrayBuffer.isView(e)){if(s=n.length,s!=e.length)return!1;for(r=s;r--!==0;)if(n[r]!==e[r])return!1;return!0}if(n.constructor===RegExp)return n.source===e.source&&n.flags===e.flags;if(n.valueOf!==Object.prototype.valueOf&&typeof n.valueOf=="function"&&typeof e.valueOf=="function")return n.valueOf()===e.valueOf();if(n.toString!==Object.prototype.toString&&typeof n.toString=="function"&&typeof e.toString=="function")return n.toString()===e.toString();if(a=Object.keys(n),s=a.length,s!==Object.keys(e).length)return!1;for(r=s;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,a[r]))return!1;if(Rn&&n instanceof Element)return!1;for(r=s;r--!==0;)if(!((a[r]==="_owner"||a[r]==="__v"||a[r]==="__o")&&n.$$typeof)&&!ot(n[a[r]],e[a[r]]))return!1;return!0}return n!==n&&e!==e}var Un=function(e,s){try{return ot(e,s)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}};const Fn=ss(Un);var Bn=function(n,e,s,r,a,i,o,d){if(!n){var l;if(e===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[s,r,a,i,o,d],u=0;l=new Error(e.replace(/%s/g,function(){return c[u++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}},Hn=Bn;const ps=ss(Hn);var qn=function(e,s,r,a){var i=r?r.call(a,e,s):void 0;if(i!==void 0)return!!i;if(e===s)return!0;if(typeof e!="object"||!e||typeof s!="object"||!s)return!1;var o=Object.keys(e),d=Object.keys(s);if(o.length!==d.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(s),c=0;c<o.length;c++){var u=o[c];if(!l(u))return!1;var h=e[u],g=s[u];if(i=r?r.call(a,h,g,u):void 0,i===!1||i===void 0&&h!==g)return!1}return!0};const zn=ss(qn);var sr=(n=>(n.BASE="base",n.BODY="body",n.HEAD="head",n.HTML="html",n.LINK="link",n.META="meta",n.NOSCRIPT="noscript",n.SCRIPT="script",n.STYLE="style",n.TITLE="title",n.FRAGMENT="Symbol(react.fragment)",n))(sr||{}),St={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},xs=Object.values(sr),os={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},Wn=Object.entries(os).reduce((n,[e,s])=>(n[s]=e,n),{}),re="data-rh",Ie={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},$e=(n,e)=>{for(let s=n.length-1;s>=0;s-=1){const r=n[s];if(Object.prototype.hasOwnProperty.call(r,e))return r[e]}return null},Gn=n=>{let e=$e(n,"title");const s=$e(n,Ie.TITLE_TEMPLATE);if(Array.isArray(e)&&(e=e.join("")),s&&e)return s.replace(/%s/g,()=>e);const r=$e(n,Ie.DEFAULT_TITLE);return e||r||void 0},Jn=n=>$e(n,Ie.ON_CHANGE_CLIENT_STATE)||(()=>{}),kt=(n,e)=>e.filter(s=>typeof s[n]<"u").map(s=>s[n]).reduce((s,r)=>({...s,...r}),{}),Kn=(n,e)=>e.filter(s=>typeof s.base<"u").map(s=>s.base).reverse().reduce((s,r)=>{if(!s.length){const a=Object.keys(r);for(let i=0;i<a.length;i+=1){const d=a[i].toLowerCase();if(n.indexOf(d)!==-1&&r[d])return s.concat(r)}}return s},[]),Vn=n=>console&&typeof console.warn=="function"&&console.warn(n),Fe=(n,e,s)=>{const r={};return s.filter(a=>Array.isArray(a[n])?!0:(typeof a[n]<"u"&&Vn(`Helmet: ${n} should be of type "Array". Instead found type "${typeof a[n]}"`),!1)).map(a=>a[n]).reverse().reduce((a,i)=>{const o={};i.filter(l=>{let c;const u=Object.keys(l);for(let g=0;g<u.length;g+=1){const m=u[g],x=m.toLowerCase();e.indexOf(x)!==-1&&!(c==="rel"&&l[c].toLowerCase()==="canonical")&&!(x==="rel"&&l[x].toLowerCase()==="stylesheet")&&(c=x),e.indexOf(m)!==-1&&(m==="innerHTML"||m==="cssText"||m==="itemprop")&&(c=m)}if(!c||!l[c])return!1;const h=l[c].toLowerCase();return r[c]||(r[c]={}),o[c]||(o[c]={}),r[c][h]?!1:(o[c][h]=!0,!0)}).reverse().forEach(l=>a.push(l));const d=Object.keys(o);for(let l=0;l<d.length;l+=1){const c=d[l],u={...r[c],...o[c]};r[c]=u}return a},[]).reverse()},Qn=(n,e)=>{if(Array.isArray(n)&&n.length){for(let s=0;s<n.length;s+=1)if(n[s][e])return!0}return!1},Yn=n=>({baseTag:Kn(["href"],n),bodyAttributes:kt("bodyAttributes",n),defer:$e(n,Ie.DEFER),encode:$e(n,Ie.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:kt("htmlAttributes",n),linkTags:Fe("link",["rel","href"],n),metaTags:Fe("meta",["name","charset","http-equiv","property","itemprop"],n),noscriptTags:Fe("noscript",["innerHTML"],n),onChangeClientState:Jn(n),scriptTags:Fe("script",["src","innerHTML"],n),styleTags:Fe("style",["cssText"],n),title:Gn(n),titleAttributes:kt("titleAttributes",n),prioritizeSeoTags:Qn(n,Ie.PRIORITIZE_SEO_TAGS)}),rr=n=>Array.isArray(n)?n.join(""):n,Zn=(n,e)=>{const s=Object.keys(n);for(let r=0;r<s.length;r+=1)if(e[s[r]]&&e[s[r]].includes(n[s[r]]))return!0;return!1},Et=(n,e)=>Array.isArray(n)?n.reduce((s,r)=>(Zn(r,e)?s.priority.push(r):s.default.push(r),s),{priority:[],default:[]}):{default:n,priority:[]},bs=(n,e)=>({...n,[e]:void 0}),Xn=["noscript","script","style"],Ut=(n,e=!0)=>e===!1?String(n):String(n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),nr=n=>Object.keys(n).reduce((e,s)=>{const r=typeof n[s]<"u"?`${s}="${n[s]}"`:`${s}`;return e?`${e} ${r}`:r},""),ea=(n,e,s,r)=>{const a=nr(s),i=rr(e);return a?`<${n} ${re}="true" ${a}>${Ut(i,r)}</${n}>`:`<${n} ${re}="true">${Ut(i,r)}</${n}>`},ta=(n,e,s=!0)=>e.reduce((r,a)=>{const i=a,o=Object.keys(i).filter(c=>!(c==="innerHTML"||c==="cssText")).reduce((c,u)=>{const h=typeof i[u]>"u"?u:`${u}="${Ut(i[u],s)}"`;return c?`${c} ${h}`:h},""),d=i.innerHTML||i.cssText||"",l=Xn.indexOf(n)===-1;return`${r}<${n} ${re}="true" ${o}${l?"/>":`>${d}</${n}>`}`},""),ar=(n,e={})=>Object.keys(n).reduce((s,r)=>{const a=os[r];return s[a||r]=n[r],s},e),sa=(n,e,s)=>{const r={key:e,[re]:!0},a=ar(s,r);return[U.createElement("title",a,e)]},lt=(n,e)=>e.map((s,r)=>{const a={key:r,[re]:!0};return Object.keys(s).forEach(i=>{const d=os[i]||i;if(d==="innerHTML"||d==="cssText"){const l=s.innerHTML||s.cssText;a.dangerouslySetInnerHTML={__html:l}}else a[d]=s[i]}),U.createElement(n,a)}),X=(n,e,s=!0)=>{switch(n){case"title":return{toComponent:()=>sa(n,e.title,e.titleAttributes),toString:()=>ea(n,e.title,e.titleAttributes,s)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>ar(e),toString:()=>nr(e)};default:return{toComponent:()=>lt(n,e),toString:()=>ta(n,e,s)}}},ra=({metaTags:n,linkTags:e,scriptTags:s,encode:r})=>{const a=Et(n,St.meta),i=Et(e,St.link),o=Et(s,St.script);return{priorityMethods:{toComponent:()=>[...lt("meta",a.priority),...lt("link",i.priority),...lt("script",o.priority)],toString:()=>`${X("meta",a.priority,r)} ${X("link",i.priority,r)} ${X("script",o.priority,r)}`},metaTags:a.default,linkTags:i.default,scriptTags:o.default}},na=n=>{const{baseTag:e,bodyAttributes:s,encode:r=!0,htmlAttributes:a,noscriptTags:i,styleTags:o,title:d="",titleAttributes:l,prioritizeSeoTags:c}=n;let{linkTags:u,metaTags:h,scriptTags:g}=n,m={toComponent:()=>{},toString:()=>""};return c&&({priorityMethods:m,linkTags:u,metaTags:h,scriptTags:g}=ra(n)),{priority:m,base:X("base",e,r),bodyAttributes:X("bodyAttributes",s,r),htmlAttributes:X("htmlAttributes",a,r),link:X("link",u,r),meta:X("meta",h,r),noscript:X("noscript",i,r),script:X("script",g,r),style:X("style",o,r),title:X("title",{title:d,titleAttributes:l},r)}},Ft=na,st=[],ir=!!(typeof window<"u"&&window.document&&window.document.createElement),Bt=class{constructor(n,e){ne(this,"instances",[]);ne(this,"canUseDOM",ir);ne(this,"context");ne(this,"value",{setHelmet:n=>{this.context.helmet=n},helmetInstances:{get:()=>this.canUseDOM?st:this.instances,add:n=>{(this.canUseDOM?st:this.instances).push(n)},remove:n=>{const e=(this.canUseDOM?st:this.instances).indexOf(n);(this.canUseDOM?st:this.instances).splice(e,1)}}});this.context=n,this.canUseDOM=e||!1,e||(n.helmet=Ft({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},aa={},or=U.createContext(aa),be,lr=(be=class extends k.Component{constructor(s){super(s);ne(this,"helmetData");this.helmetData=new Bt(this.props.context||{},be.canUseDOM)}render(){return U.createElement(or.Provider,{value:this.helmetData.value},this.props.children)}},ne(be,"canUseDOM",ir),be),Ne=(n,e)=>{const s=document.head||document.querySelector("head"),r=s.querySelectorAll(`${n}[${re}]`),a=[].slice.call(r),i=[];let o;return e&&e.length&&e.forEach(d=>{const l=document.createElement(n);for(const c in d)if(Object.prototype.hasOwnProperty.call(d,c))if(c==="innerHTML")l.innerHTML=d.innerHTML;else if(c==="cssText")l.styleSheet?l.styleSheet.cssText=d.cssText:l.appendChild(document.createTextNode(d.cssText));else{const u=c,h=typeof d[u]>"u"?"":d[u];l.setAttribute(c,h)}l.setAttribute(re,"true"),a.some((c,u)=>(o=u,l.isEqualNode(c)))?a.splice(o,1):i.push(l)}),a.forEach(d=>{var l;return(l=d.parentNode)==null?void 0:l.removeChild(d)}),i.forEach(d=>s.appendChild(d)),{oldTags:a,newTags:i}},Ht=(n,e)=>{const s=document.getElementsByTagName(n)[0];if(!s)return;const r=s.getAttribute(re),a=r?r.split(","):[],i=[...a],o=Object.keys(e);for(const d of o){const l=e[d]||"";s.getAttribute(d)!==l&&s.setAttribute(d,l),a.indexOf(d)===-1&&a.push(d);const c=i.indexOf(d);c!==-1&&i.splice(c,1)}for(let d=i.length-1;d>=0;d-=1)s.removeAttribute(i[d]);a.length===i.length?s.removeAttribute(re):s.getAttribute(re)!==o.join(",")&&s.setAttribute(re,o.join(","))},ia=(n,e)=>{typeof n<"u"&&document.title!==n&&(document.title=rr(n)),Ht("title",e)},ys=(n,e)=>{const{baseTag:s,bodyAttributes:r,htmlAttributes:a,linkTags:i,metaTags:o,noscriptTags:d,onChangeClientState:l,scriptTags:c,styleTags:u,title:h,titleAttributes:g}=n;Ht("body",r),Ht("html",a),ia(h,g);const m={baseTag:Ne("base",s),linkTags:Ne("link",i),metaTags:Ne("meta",o),noscriptTags:Ne("noscript",d),scriptTags:Ne("script",c),styleTags:Ne("style",u)},x={},b={};Object.keys(m).forEach(p=>{const{newTags:y,oldTags:C}=m[p];y.length&&(x[p]=y),C.length&&(b[p]=m[p].oldTags)}),e&&e(),l(n,x,b)},Be=null,oa=n=>{Be&&cancelAnimationFrame(Be),n.defer?Be=requestAnimationFrame(()=>{ys(n,()=>{Be=null})}):(ys(n),Be=null)},la=oa,vs=class extends k.Component{constructor(){super(...arguments);ne(this,"rendered",!1)}shouldComponentUpdate(e){return!zn(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:s}=this.props.context;let r=null;const a=Yn(e.get().map(i=>{const o={...i.props};return delete o.context,o}));lr.canUseDOM?la(a):Ft&&(r=Ft(a)),s(r)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},Lt,Qe=(Lt=class extends k.Component{shouldComponentUpdate(n){return!Fn(bs(this.props,"helmetData"),bs(n,"helmetData"))}mapNestedChildrenToProps(n,e){if(!e)return null;switch(n.type){case"script":case"noscript":return{innerHTML:e};case"style":return{cssText:e};default:throw new Error(`<${n.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(n,e,s,r){return{...e,[n.type]:[...e[n.type]||[],{...s,...this.mapNestedChildrenToProps(n,r)}]}}mapObjectTypeChildren(n,e,s,r){switch(n.type){case"title":return{...e,[n.type]:r,titleAttributes:{...s}};case"body":return{...e,bodyAttributes:{...s}};case"html":return{...e,htmlAttributes:{...s}};default:return{...e,[n.type]:{...s}}}}mapArrayTypeChildrenToProps(n,e){let s={...e};return Object.keys(n).forEach(r=>{s={...s,[r]:n[r]}}),s}warnOnInvalidChildren(n,e){return ps(xs.some(s=>n.type===s),typeof n.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${xs.join(", ")} are allowed. Helmet does not support rendering <${n.type}> elements. Refer to our API for more information.`),ps(!e||typeof e=="string"||Array.isArray(e)&&!e.some(s=>typeof s!="string"),`Helmet expects a string as a child of <${n.type}>. Did you forget to wrap your children in braces? ( <${n.type}>{\`\`}</${n.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(n,e){let s={};return U.Children.forEach(n,r=>{if(!r||!r.props)return;const{children:a,...i}=r.props,o=Object.keys(i).reduce((l,c)=>(l[Wn[c]||c]=i[c],l),{});let{type:d}=r;switch(typeof d=="symbol"?d=d.toString():this.warnOnInvalidChildren(r,a),d){case"Symbol(react.fragment)":e=this.mapChildrenToProps(a,e);break;case"link":case"meta":case"noscript":case"script":case"style":s=this.flattenArrayTypeChildren(r,s,o,a);break;default:e=this.mapObjectTypeChildren(r,e,o,a);break}}),this.mapArrayTypeChildrenToProps(s,e)}render(){const{children:n,...e}=this.props;let s={...e},{helmetData:r}=e;if(n&&(s=this.mapChildrenToProps(n,s)),r&&!(r instanceof Bt)){const a=r;r=new Bt(a.context,!0),delete s.helmetData}return r?U.createElement(vs,{...s,context:r.value}):U.createElement(or.Consumer,null,a=>U.createElement(vs,{...s,context:a}))}},ne(Lt,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),Lt);const ws=({label:n,value:e,isOpen:s,onToggle:r,children:a,className:i="w-48"})=>t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:n}),t.jsxs("button",{onClick:r,className:`${i} px-4 py-3 bg-white border border-gray-300 rounded-xl text-left flex items-center justify-between hover:border-blue-400 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200`,children:[t.jsx("span",{className:"text-gray-800 font-medium",children:e}),t.jsx(Qs,{className:`w-4 h-4 text-gray-500 transition-transform duration-200 ${s?"rotate-180":""}`})]}),s&&t.jsx("div",{className:"absolute z-[99999] mt-2 bg-white border border-gray-200 rounded-xl shadow-2xl max-h-96 overflow-y-auto min-w-full",children:a})]}),js=({label:n,selectedItems:e,onToggle:s,onItemChange:r,isOpen:a,items:i,placeholder:o,className:d="w-48",columns:l=1})=>{const c=()=>e.length===0?o:e.length===1?e[0]:`${e.length} избрани`;return t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:n}),t.jsxs("button",{onClick:s,className:`${d} px-4 py-3 bg-white border border-gray-300 rounded-xl text-left flex items-center justify-between hover:border-blue-400 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200`,children:[t.jsx("span",{className:"text-gray-800 font-medium truncate",children:c()}),t.jsx(Qs,{className:`w-4 h-4 text-gray-500 transition-transform duration-200 ${a?"rotate-180":""}`})]}),a&&t.jsx("div",{className:"absolute z-[99999] mt-2 bg-white border border-gray-200 rounded-xl shadow-2xl p-4 max-h-96 overflow-y-auto min-w-full",children:t.jsx("div",{className:"grid grid-cols-1 gap-2",children:i.map(u=>t.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded-lg cursor-pointer transition-colors duration-150",children:[t.jsx("input",{type:"checkbox",checked:e.includes(u),onChange:()=>r(u),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),t.jsx("span",{className:"text-sm text-gray-700",children:u})]},u))})})]})},ct={"София (столица)":["София"],"Област Варна":["Варна","Аксаково","Белослав","Бяла","Ветрино","Вълчи дол","Девня","Долни чифлик","Дългопол","Провадия","Суворово"],"Област Силистра":["Силистра","Алфатар","Главиница","Дулово","Кайнарджа","Ситово","Тутракан"],"Област Благоевград":["Благоевград","Банско","Гоце Делчев","Петрич","Разлог","Сандански","Симитли"],"Област Бургас":["Бургас","Айтос","Карнобат","Малко Търново","Несебър","Поморие","Приморско","Созопол","Средец","Сунгурларе","Царево"],"Област Велико Търново":["Велико Търново","Арбанаси","Горна Оряховица","Елена","Златарица","Лясковец","Павликени","Полски Тръмбеш","Свищов","Стражица"],"Област Видин":["Видин","Белоградчик","Бойница","Брегово","Грамада","Димово","Кула","Макреш","Ново село","Ружинци","Чупрене"],"Област Враца":["Враца","Борован","Бяла Слатина","Козлодуй","Криводол","Мездра","Мизия","Оряхово","Роман","Хайредин"],"Област Габрово":["Габрово","Дряново","Севлиево","Трявна"],"Област Добрич":["Добрич","Балчик","Генерал Тошево","Каварна","Крушари","Тервел","Шабла"],"Област Кърджали":["Кърджали","Ардино","Джебел","Кирково","Крумовград","Момчилград","Черноочене"],"Област Кюстендил":["Кюстендил","Бобов дол","Бобошево","Дупница","Невестино","Рила","Сапарева баня","Трекляно"],"Област Ловеч":["Ловеч","Априлци","Летница","Луковит","Тетевен","Троян","Угърчин"],"Област Монтана":["Монтана","Берковица","Бойчиновци","Брусарци","Вършец","Георги Дамяново","Лом","Медковец","Чипровци","Якимово"],"Област Пазарджик":["Пазарджик","Батак","Белово","Брацигово","Велинград","Лесичово","Панагюрище","Пещера","Ракитово","Септември","Стрелча"],"Област Перник":["Перник","Брезник","Земен","Ковачевци","Радомир","Трън"],"Област Плевен":["Плевен","Белене","Гулянци","Долна Митрополия","Долни Дъбник","Искър","Кнежа","Левски","Никопол","Пордим"],"Област Пловдив":["Пловдив","Асеновград","Брезово","Калояново","Карлово","Кричим","Куклен","Лъки","Марица","Перущица","Първомай","Раковски","Родопи","Садово","Сопот","Стамболийски","Съединение","Хисаря"],"Област Разград":["Разград","Завет","Исперих","Кубрат","Лозница","Самуил","Цар Калоян"],"Област Русе":["Русе","Бяла","Ветово","Две могили","Иваново","Ценово","Сливо поле","Борово"],"Област Сливен":["Сливен","Котел","Нова Загора","Твърдица"],"Област Смолян":["Смолян","Банките","Борино","Девин","Доспат","Златоград","Мадан","Неделино","Рудозем","Чепеларе"],"Област Стара Загора":["Стара Загора","Братя Даскалови","Гурково","Гълъбово","Казанлък","Мъглиж","Николаево","Опан","Павел баня","Раднево","Чирпан"],"Област Търговище":["Търговище","Антоново","Омуртаг","Опака","Попово"],"Област Хасково":["Хасково","Димитровград","Ивайловград","Любимец","Маджарово","Минерални бани","Свиленград","Симеоновград","Стамболово","Тополовград","Харманли"],"Област Шумен":["Шумен","Велики Преслав","Венец","Върбица","Каспичан","Китен","Никола Козлево","Нови пазар","Смядово","Хитрино"],"Област Ямбол":["Ямбол","Болярово","Елхово","Стралджа","Тунджа"]},cr=["1-СТАЕН","2-СТАЕН","3-СТАЕН","4-СТАЕН","МНОГОСТАЕН","МЕЗОНЕТ","АТЕЛИЕ, ТАВАН","ОФИС","МАГАЗИН","ЗАВЕДЕНИЕ","СКЛАД","ХОТЕЛ","КЪЩА","ВИЛА","ПАРЦЕЛ","ГАРАЖ","ЗЕМЕДЕЛСКА ЗЕМЯ","ПРОИЗВОДСТВЕНО ПОМЕЩЕНИЕ","БИЗНЕС ИМОТ"],ca={София:["Банишора","Беляковско шосе","Борово","Ботунец","Бояна","Бусманци","Витоша","Владая","Враждебна","Връбница 1","Връбница 2","Герман","Горна баня","Горубляне","Гоце Делчев","Градина","Диана бад","Докторски паметник","Драгалевци","Дружба 1","Дружба 2","Дървеница","Западен парк","Захарна фабрика","Зона Б-18","Зона Б-19","Зона Б-5","Иван Вазов","Изгрев","Изток","Илинден","Илиянци","Казичене","Капитан Андреево","Карпузица","Кокаляне","Красна поляна 1","Красна поляна 2","Красна поляна 3","Красно село","Кремиковци","Кръстова вада","Княжево","Левски","Левски В","Левски Г","Лозенец","Люлин 1","Люлин 2","Люлин 3","Люлин 4","Люлин 5","Люлин 6","Люлин 7","Люлин 8","Люлин 9","Люлин 10","Люлин-център","Малашевци","Малинова долина","Манастирски ливади","Милево","Младост 1","Младост 1А","Младост 2","Младост 3","Младост 4","Модерно предградие","Мусагеница","Надежда 1","Надежда 2","Надежда 3","Надежда 4","НПЗ Изток","НПЗ Искър","НПЗ Хаджи Димитър","Обеля","Обеля 1","Обеля 2","Овча купел 1","Овча купел 2","Орландовци","Павлово","Панчарево","Подуяне","Полигона","Разсадника","Редута","Света Троица","Свобода","Сердика","Симеоново","Славия","Слатина","Стрелбище","Студентски град","Сухата река","Суходол","Толстой","Триъгълника","Филиповци","Фондови жилища","Хаджи Димитър","Хиподрума","Хладилника","Христо Ботев","Център","Челопечене","Яворов","Ястребец"],Варна:["Аспарухово","Бриз","Възраждане","Галата","Гръцка махала","Дружба","Западна промишлена зона","Зимно кино","Изгрев","Кайсиева градина","Каменар","Кв. Чайка","Левски","Лятно кино Тракия","Младост","Морска градина","Одесос","Окръжна болница","Операта","Планова","Победа","Приморски","Ретро","Салтанат","Св. Константин и Елена","Св. Никола","Център","Чаталджа","Червен площад","Чернево","Шипка","Южна промишлена зона"],Силистра:["Дунав","Център","Север","Изток","Запад"],Пловдив:["Въстанически","Гагарин","Данаил Дечев","Дружба","Изгрев","Каменица 1","Каменица 2","Капана","Кършияка","Коматево","Кукленско шосе","Лаута","Марица","Младост","Мараша","Остромила","Прослав","Пъдарско плато","Северен","Смирненски","Столипиново","Тракия","Тримонциум","Христо Г. Данов","Център","Широк център","Южен"],Бургас:["Акациите","Банево","Богориди","Братя Миладинови","Ветрен","Възраждане","Горно Езерово","Долно Езерово","Зорница","Изгрев","Крайморие","Лазур","Меден рудник","Победа","Принцеса Мария Луиза","Сарафово","Славейков","Център"],Русе:["Възраждане","Дружба 1","Дружба 2","Здравец","Изгрев","Кенана","Младост","Образцов чифлик","Родина 1","Родина 2","Родина 3","Средец","Стабилизатор","Център","Чародейка"],"Стара Загора":["Аязмото","Българка","Ген. Столетов","Голеш","Железник","Загоре","Индустриален","Казански","Кольо Ганчев","Лозенград","Македонски","Младост","Опълченски","Самара 1","Самара 2","Самара 3","Три чучура - Север","Три чучура - Юг","Център"],Плевен:["Дружба","Изгрев","Кайлъка","Мара Денчева","Младост","Сторгозия","Център","Широк център"],Сливен:["Асеновец","Българка","Дружба","Клуцохор","Младост","Речица","Стоян Заимов","Център"],Добрич:["Балик","Дружба 1","Дружба 2","Дружба 3","Изгрев","Рилци","Север","Център"],Шумен:["Дивдядово","Младост","Тракийски","Център"],Перник:["Изток","Мошино","Център"],Ямбол:["Георги Бенковски","Дивдядово","Каргон","Център"],Хасково:["Дружба","Изгрев","Младост","Център"],Пазарджик:["Изток","Младост","Център"],Благоевград:["Еленово","Запад","Изток","Център"],"Велико Търново":["Бузлуджа","Картала","Чолаковци","Център"],Враца:["Бистрец","Дъбника","Младост","Център"],Видин:["Калето","Нов град","Център"],Монтана:["Младост","Център"],Габрово:["Младост","Център"],Кърджали:["Възрожденци","Изгрев","Център"],Кюстендил:["Запад","Изток","Център","Баня"],Ловеч:["Младост","Център","Стратеш","Дренов дол"],Разград:["Дружба","Център"],Смолян:["Устово","Център"],Търговище:["Въпраждане","Център"],Банско:["Център","Разлог","Старата част"],Несебър:["Стар Несебър","Нов Несебър","Слънчев бряг"],Созопол:["Стар град","Нов град","Харманите","Буджака"],Поморие:["Център","Стария град","Нов Поморие"],Приморско:["Център","Север","Юг"],Царево:["Център","Лозенец","Ахтопол"],Балчик:["Център","Дворец","Кранево"],Каварна:["Център","Калиакра","Болата"],Свищов:["Център","Дунав","Индустриален"],"Горна Оряховица":["Център","Гара","Индустриален"],Казанлък:["Център","Розова долина","Индустриален"],Димитровград:["Център","Марица","Индустриален"],Свиленград:["Център","Гранична застава","Индустриален"],Асеновград:["Център","Асеновата крепост","Индустриален"],Карлово:["Център","Розова долина","Индустриален"],Панагюрище:["Център","Априлци","Индустриален"],Велинград:["Център","Каменица","Лъджене","Чепино"],Сандански:["Център","Баня","Индустриален"],Петрич:["Център","Кулата","Индустриален"],Дупница:["Център","Бистрица","Индустриален"],Троян:["Център","Орешак","Индустриален"],Севлиево:["Център","Индустриален","Север"],Козлодуй:["Център","АЕЦ","Дунав"],Белене:["Център","Дунав","Остров"],Никопол:["Център","Дунав","Индустриален"]},dr=["Тухла","Панел","ЕПК","ПК","Монолит"],ur=["Ново строителство","Обзаведен","Необзаведен","За ремонт","След ремонт"],da=["ТЕЦ","Локално","Газ","Климатик","Камина","Без"],hr=[{value:"full",label:"Напълно обзаведен"},{value:"partial",label:"Частично обзаведен"},{value:"none",label:"Необзаведен"},{value:"unfurnished",label:"Необзаведена"}],ua=()=>{const n=new Set;return Object.values(ct).forEach(e=>{e.forEach(s=>n.add(s))}),Array.from(n).sort().map((e,s)=>({key:`${e}-${s}`,value:e}))},gr=n=>ca[n]||[],ha=({formData:n,onUpdate:e})=>t.jsx("div",{className:"mt-8 pt-8 border-t border-gray-200",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Цена (€)"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",placeholder:"€ От",value:n.priceMin,onChange:s=>e({priceMin:s.target.value}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"}),t.jsx("input",{type:"text",placeholder:"€ До",value:n.priceMax,onChange:s=>e({priceMax:s.target.value}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Площ (кв.м)"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",placeholder:"От",value:n.areaMin,onChange:s=>e({areaMin:s.target.value}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"}),t.jsx("input",{type:"text",placeholder:"До",value:n.areaMax,onChange:s=>e({areaMax:s.target.value}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Код на имота"}),t.jsx("input",{type:"text",placeholder:"Въведете код",value:n.advancedSearchCode,onChange:s=>e({advancedSearchCode:s.target.value}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Вид строителство"}),t.jsxs("select",{value:n.constructionType,onChange:s=>e({constructionType:s.target.value}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[t.jsx("option",{value:"",children:"Изберете вид"}),dr.map(s=>t.jsx("option",{value:s,children:s},s))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Състояние"}),t.jsxs("select",{value:n.condition,onChange:s=>e({condition:s.target.value}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[t.jsx("option",{value:"",children:"Изберете състояние"}),ur.map(s=>t.jsx("option",{value:s,children:s},s))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Година на строителство"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",placeholder:"От",value:n.yearBuilt.min,onChange:s=>e({yearBuilt:{...n.yearBuilt,min:s.target.value}}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"}),t.jsx("input",{type:"text",placeholder:"До",value:n.yearBuilt.max,onChange:s=>e({yearBuilt:{...n.yearBuilt,max:s.target.value}}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Етаж"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",placeholder:"От",value:n.floors.min,onChange:s=>e({floors:{...n.floors,min:s.target.value}}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"}),t.jsx("input",{type:"text",placeholder:"До",value:n.floors.max,onChange:s=>e({floors:{...n.floors,max:s.target.value}}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Спални"}),t.jsx("input",{type:"text",placeholder:"Брой спални",value:n.bedrooms,onChange:s=>e({bedrooms:s.target.value}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Бани"}),t.jsx("input",{type:"text",placeholder:"Брой бани",value:n.bathrooms,onChange:s=>e({bathrooms:s.target.value}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Тераси"}),t.jsx("input",{type:"text",placeholder:"Брой тераси",value:n.terrace,onChange:s=>e({terrace:s.target.value}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Ниво на обзавеждане"}),t.jsxs("select",{value:n.furnishingLevel,onChange:s=>e({furnishingLevel:s.target.value}),className:"w-full px-3 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[t.jsx("option",{value:"",children:"Изберете ниво"}),hr.map(s=>t.jsx("option",{value:s.value,children:s.label},s.value))]})]})]})}),_s={transactionType:"sale",keyword:"",region:"София (столица)",settlement:"София",propertyTypes:[],selectedDistricts:[],priceMin:"",priceMax:"",areaMin:"",areaMax:"",rooms:[],floors:{min:"",max:""},bedrooms:"",bathrooms:"",terrace:"",constructionType:"",condition:"",exposure:"",heating:"",hasGarage:!1,hasSouthernExposure:!1,newConstruction:!1,advancedSearchCode:"",yearBuilt:{min:"",max:""},furnishingLevel:""},Ns={region:!1,settlement:!1,propertyType:!1,districts:!1,constructionType:!1,condition:!1,heating:!1,furnishingLevel:!1},ga=()=>{const[n,e]=k.useState(_s),[s,r]=k.useState(Ns),[a,i]=k.useState(!1);return{formData:n,dropdowns:s,showAdvanced:a,updateFormData:h=>{e(g=>({...g,...h}))},toggleDropdown:h=>{r(g=>({...g,[h]:!g[h]}))},closeDropdown:h=>{r(g=>({...g,[h]:!1}))},clearAllFilters:()=>{e(_s),r(Ns),i(!1)},handleSearch:()=>{console.log("Търсене с параметри:",n)},setShowAdvanced:i}},mr=({onSearch:n})=>{const{formData:e,dropdowns:s,showAdvanced:r,updateFormData:a,toggleDropdown:i,closeDropdown:o,clearAllFilters:d,setShowAdvanced:l}=ga(),c=()=>{const j={};if(e.transactionType&&(j.transaction_type=e.transactionType),e.keyword&&(j.keyword=e.keyword),e.settlement&&e.settlement!=="Всички")j.city_region=e.settlement;else if(e.region&&e.region!=="Всички"){const w=e.region.match(/^([^(]+)/);w&&(j.city_region=w[1].trim())}e.propertyTypes.length>0&&(j.property_type=e.propertyTypes[0]),e.selectedDistricts.length>0&&(j.district=e.selectedDistricts[0]),e.priceMin&&(j.price_min=e.priceMin),e.priceMax&&(j.price_max=e.priceMax),e.areaMin&&(j.area_min=e.areaMin),e.areaMax&&(j.area_max=e.areaMax),e.newConstruction&&(j.new_construction="true"),e.hasElevator&&(j.has_elevator="true"),e.hasGarage&&(j.has_garage="true"),e.advancedSearchCode&&(j.id=e.advancedSearchCode),e.constructionType&&(j.construction_type=e.constructionType),e.condition&&(j.condition_type=e.condition),e.heating&&(j.heating=e.heating),e.yearBuilt.min&&(j.year_built_min=e.yearBuilt.min),e.yearBuilt.max&&(j.year_built_max=e.yearBuilt.max),e.bedrooms&&(j.bedrooms=e.bedrooms),e.bathrooms&&(j.bathrooms=e.bathrooms),e.terrace&&(j.terraces=e.terrace),console.log("Search parameters:",j),n?n(j):console.log("No onSearch handler provided, search params:",j)},u=k.useRef(null),h=k.useRef(null),g=k.useRef(null),m=k.useRef(null);k.useEffect(()=>{const j=w=>{u.current&&!u.current.contains(w.target)&&o("region"),h.current&&!h.current.contains(w.target)&&o("settlement"),g.current&&!g.current.contains(w.target)&&o("propertyType"),m.current&&!m.current.contains(w.target)&&o("districts")};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[o]);const x=j=>{const w=e.propertyTypes.includes(j)?e.propertyTypes.filter(T=>T!==j):[...e.propertyTypes,j];a({propertyTypes:w})},b=j=>{const w=e.selectedDistricts.includes(j)?e.selectedDistricts.filter(T=>T!==j):[...e.selectedDistricts,j];a({selectedDistricts:w})},p=j=>{let w="Всички";if(j!=="Всички"){const T=ct[j]||[];T.length>0&&(w=T.find(W=>{var q;return W.toLowerCase().includes(((q=j.split(" ")[0])==null?void 0:q.toLowerCase())||j.toLowerCase())})||T[0])}a({region:j,settlement:w,selectedDistricts:[]}),o("region")},y=j=>{a({settlement:j,selectedDistricts:[]}),o("settlement")},N=!e.region||e.region==="Всички"?[]:ct[e.region]||[],S=e.settlement?gr(e.settlement):[];return U.useEffect(()=>{e.region==="Всички"&&a({region:"София (столица)",settlement:"София"})},[]),t.jsx("div",{className:"w-full",children:t.jsxs("div",{className:"bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl p-8 border border-white/20 relative z-10",children:[t.jsxs("div",{className:"flex gap-2 mb-8",children:[t.jsxs("button",{onClick:()=>a({transactionType:"sale"}),className:`px-6 py-3 rounded-xl font-medium transition-all duration-200 flex items-center gap-2 ${e.transactionType==="sale"?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[t.jsx(rs,{className:"w-4 h-4"}),"Продажба"]}),t.jsxs("button",{onClick:()=>a({transactionType:"rent"}),className:`px-6 py-3 rounded-xl font-medium transition-all duration-200 flex items-center gap-2 ${e.transactionType==="rent"?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[t.jsx(ve,{className:"w-4 h-4"}),"Наем"]})]}),t.jsxs("div",{className:"space-y-6 mb-8",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx("div",{ref:u,children:t.jsx(ws,{label:"Област",value:e.region||"Всички",isOpen:s.region,onToggle:()=>i("region"),className:"w-full",children:t.jsxs("div",{className:"p-2",children:[t.jsx("button",{onClick:()=>p("Всички"),className:`w-full px-6 py-2 text-left rounded-lg hover:bg-gray-50 transition-colors ${e.region==="Всички"?"bg-blue-50 text-blue-700 font-medium":"text-gray-700"}`,children:"Всички области"}),Object.keys(ct).map(j=>t.jsx("button",{onClick:()=>p(j),className:`w-full px-6 py-2 text-left rounded-lg hover:bg-gray-50 transition-colors ${e.region===j?"bg-blue-50 text-blue-700 font-medium":"text-gray-700"}`,children:j},j))]})})}),t.jsx("div",{ref:h,children:t.jsx(ws,{label:"Населено място",value:e.settlement||"Всички",isOpen:s.settlement,onToggle:()=>i("settlement"),className:"w-full",children:t.jsxs("div",{className:"p-2",children:[t.jsx("button",{onClick:()=>y("Всички"),className:`w-full px-6 py-2 text-left rounded-lg hover:bg-gray-50 transition-colors ${e.settlement==="Всички"?"bg-blue-50 text-blue-700 font-medium":"text-gray-700"}`,children:"Всички места"}),N.map(j=>t.jsx("button",{onClick:()=>y(j),className:`w-full px-6 py-2 text-left rounded-lg hover:bg-gray-50 transition-colors ${e.settlement===j?"bg-blue-50 text-blue-700 font-medium":"text-gray-700"}`,children:j},j))]})})}),t.jsx("div",{ref:g,children:t.jsx(js,{label:"Тип имот",selectedItems:e.propertyTypes,onToggle:()=>i("propertyType"),onItemChange:x,isOpen:s.propertyType,items:cr,placeholder:"Всички типове",className:"w-full"})}),t.jsx("div",{ref:m,children:t.jsx(js,{label:"Квартал",selectedItems:e.selectedDistricts,onToggle:()=>i("districts"),onItemChange:b,isOpen:s.districts,items:S,placeholder:"Всички квартали",className:"w-full",columns:3})})]}),t.jsxs("div",{className:"flex flex-col md:flex-row gap-6 mb-8 items-start",children:[t.jsxs("div",{className:"w-full md:w-64",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Търсене по ключова дума"}),t.jsx("input",{type:"text",value:e.keyword,onChange:j=>a({keyword:j.target.value}),className:"w-full px-4 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"Търсене в заглавие, описание, квартал..."})]}),t.jsxs("div",{className:"flex items-center gap-8 mt-8",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:e.newConstruction,onChange:j=>a({newConstruction:j.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"Ново строителство"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:e.hasElevator,onChange:j=>a({hasElevator:j.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"Асансьор"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:e.hasGarage,onChange:j=>a({hasGarage:j.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"Гараж"})]})]})]}),t.jsx("div",{className:"flex flex-col gap-4",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[t.jsxs("button",{onClick:()=>l(!r),className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 font-medium transition-colors hover:bg-blue-50 px-4 py-2 rounded-lg",children:[t.jsx(Ys,{className:"w-4 h-4"}),r?"Скрий разширеното търсене":"Разширено търсене"]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsxs("button",{onClick:d,className:"flex items-center justify-center gap-2 px-6 py-3 text-red-600 hover:text-red-700 font-medium transition-colors hover:bg-red-50 rounded-xl",children:[t.jsx(Dt,{className:"w-4 h-4"}),"Изчистване"]}),t.jsxs("button",{onClick:c,className:"flex items-center justify-center gap-2 px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[t.jsx(nn,{className:"w-5 h-5"}),"Покажи резултатите"]})]})]})}),r&&t.jsx(ha,{formData:e,onUpdate:a})]})]})})},Je=()=>{const n=[{label:"Начало",href:"/"},{label:"Имоти",href:"/properties"},{label:"Контакти",href:"/contact"}];return t.jsx("nav",{className:"hidden md:flex items-center gap-8",children:n.map(e=>t.jsx(Sn,{to:e.href,end:e.href==="/",className:({isActive:s})=>`px-4 py-2 backdrop-blur-sm rounded-lg border border-white/20 font-medium transition-colors ${s?"bg-white/10 text-white":"text-white/80 hover:text-white hover:bg-white/5"}`,children:e.label},e.href))})},ma=()=>{const n=je(),e=s=>{const r=new URLSearchParams;Object.keys(s).forEach(i=>{s[i]&&s[i]!==""&&r.append(i,s[i])});const a=r.toString();n(`/properties${a?`?${a}`:""}`)};return t.jsxs("div",{className:"relative min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800 overflow-visible",children:[t.jsxs(Qe,{children:[t.jsx("title",{children:"ConsultingG Real Estate - Недвижими имоти в България | Продажба и Наем"}),t.jsx("meta",{name:"description",content:"Водещата платформа за недвижими имоти в България с над 15 години опит. Намерете перфектния дом, апартамент или инвестиция. Професионални услуги за продажба и наем."}),t.jsx("meta",{name:"keywords",content:"недвижими имоти българия, имоти софия, апартаменти продажба, къщи наем, консултинг недвижими имоти, брокер имоти софия, инвестиции недвижими имоти"}),t.jsx("link",{rel:"canonical",href:"https://consultingg.com"}),t.jsx("script",{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org","@type":"WebSite",name:"ConsultingG Real Estate",description:"Водещата платформа за недвижими имоти в България",url:"https://consultingg.com",potentialAction:{"@type":"SearchAction",target:"https://consultingg.com/properties?keyword={search_term_string}","query-input":"required name=search_term_string"},publisher:{"@type":"Organization",name:"ConsultingG Real Estate",logo:"https://consultingg.com/logo.png"}})})]}),t.jsxs("div",{className:"absolute inset-0 opacity-10",children:[t.jsxs("svg",{className:"absolute left-10 top-20 w-32 h-80",viewBox:"0 0 120 300",fill:"none",children:[t.jsx("path",{d:"M20 300V50L40 30H80L100 50V300H20Z",stroke:"white",strokeWidth:"1",fill:"none",opacity:"0.3"}),t.jsx("path",{d:"M30 80H90M30 100H90M30 120H90M30 140H90M30 160H90M30 180H90M30 200H90M30 220H90M30 240H90M30 260H90",stroke:"white",strokeWidth:"0.5",opacity:"0.2"}),t.jsx("rect",{x:"35",y:"60",width:"8",height:"12",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.25"}),t.jsx("rect",{x:"50",y:"60",width:"8",height:"12",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.25"}),t.jsx("rect",{x:"65",y:"60",width:"8",height:"12",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.25"}),t.jsx("rect",{x:"80",y:"60",width:"8",height:"12",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.25"})]}),t.jsxs("svg",{className:"absolute right-20 top-32 w-28 h-64",viewBox:"0 0 100 240",fill:"none",children:[t.jsx("path",{d:"M10 240V40L30 20H70L90 40V240H10Z",stroke:"white",strokeWidth:"1",fill:"none",opacity:"0.3"}),t.jsx("path",{d:"M20 60H80M20 80H80M20 100H80M20 120H80M20 140H80M20 160H80M20 180H80M20 200H80",stroke:"white",strokeWidth:"0.5",opacity:"0.2"}),t.jsx("rect",{x:"25",y:"45",width:"6",height:"10",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.25"}),t.jsx("rect",{x:"40",y:"45",width:"6",height:"10",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.25"}),t.jsx("rect",{x:"55",y:"45",width:"6",height:"10",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.25"}),t.jsx("rect",{x:"70",y:"45",width:"6",height:"10",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.25"})]}),t.jsxs("svg",{className:"absolute left-1/2 top-16 transform -translate-x-1/2 w-40 h-72",viewBox:"0 0 150 270",fill:"none",children:[t.jsx("path",{d:"M25 270V60L45 40H105L125 60V270H25Z",stroke:"white",strokeWidth:"1",fill:"none",opacity:"0.2"}),t.jsx("path",{d:"M35 80H115M35 100H115M35 120H115M35 140H115M35 160H115M35 180H115M35 200H115M35 220H115M35 240H115",stroke:"white",strokeWidth:"0.5",opacity:"0.15"}),t.jsx("rect",{x:"40",y:"65",width:"7",height:"10",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.2"}),t.jsx("rect",{x:"55",y:"65",width:"7",height:"10",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.2"}),t.jsx("rect",{x:"70",y:"65",width:"7",height:"10",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.2"}),t.jsx("rect",{x:"85",y:"65",width:"7",height:"10",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.2"}),t.jsx("rect",{x:"100",y:"65",width:"7",height:"10",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.2"})]}),t.jsxs("svg",{className:"absolute left-32 bottom-32 w-24 h-48",viewBox:"0 0 90 180",fill:"none",children:[t.jsx("path",{d:"M5 180V80L15 70H35L45 80V180H5Z",stroke:"white",strokeWidth:"1",fill:"none",opacity:"0.25"}),t.jsx("path",{d:"M50 180V100L60 90H80L90 100V180H50Z",stroke:"white",strokeWidth:"1",fill:"none",opacity:"0.25"}),t.jsx("rect",{x:"10",y:"85",width:"5",height:"8",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.2"}),t.jsx("rect",{x:"20",y:"85",width:"5",height:"8",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.2"}),t.jsx("rect",{x:"30",y:"85",width:"5",height:"8",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.2"})]}),t.jsxs("svg",{className:"absolute right-32 bottom-20 w-20 h-60",viewBox:"0 0 75 225",fill:"none",children:[t.jsx("path",{d:"M15 225V45L25 35H50L60 45V225H15Z",stroke:"white",strokeWidth:"1",fill:"none",opacity:"0.2"}),t.jsx("path",{d:"M20 60H55M20 75H55M20 90H55M20 105H55M20 120H55M20 135H55M20 150H55M20 165H55M20 180H55M20 195H55",stroke:"white",strokeWidth:"0.5",opacity:"0.15"}),t.jsx("circle",{cx:"30",cy:"52",r:"2",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.2"}),t.jsx("circle",{cx:"45",cy:"52",r:"2",stroke:"white",strokeWidth:"0.5",fill:"none",opacity:"0.2"})]}),t.jsx("div",{className:"absolute inset-0 opacity-5",children:t.jsx("div",{className:"w-full h-full",style:{backgroundImage:`
              linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px),
              linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)
            `,backgroundSize:"40px 40px"}})})]}),t.jsx("div",{className:"absolute top-20 left-10 w-32 h-32 bg-blue-500/10 rounded-full blur-xl animate-pulse"}),t.jsx("div",{className:"absolute top-40 right-20 w-24 h-24 bg-purple-500/10 rounded-full blur-xl animate-pulse delay-1000"}),t.jsx("div",{className:"absolute bottom-40 left-1/4 w-40 h-40 bg-indigo-500/10 rounded-full blur-xl animate-pulse delay-2000"}),t.jsxs("div",{className:"relative z-10 container mx-auto px-4 py-12",children:[t.jsxs("header",{className:"flex items-center justify-between mb-16",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("img",{src:"/logo.png",alt:"ConsultingG Logo",className:"w-24 h-24 rounded-xl shadow-lg object-contain"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-white",children:"ConsultingG"}),t.jsx("p",{className:"text-blue-200 text-sm",children:"Real Estate"})]})]}),t.jsx(Je,{})]}),t.jsx("div",{className:"text-center mb-16",children:t.jsxs("h2",{className:"text-5xl md:text-7xl font-bold text-white mb-6 leading-tight",children:["Намерете своя",t.jsx("span",{className:"block bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"перфектен дом"})]})}),t.jsx("div",{className:"max-w-6xl mx-auto",children:t.jsx(mr,{onSearch:e})})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0",children:t.jsx("svg",{viewBox:"0 0 1200 120",fill:"none",className:"w-full h-20",children:t.jsx("path",{d:"M0,60 C300,120 900,0 1200,60 L1200,120 L0,120 Z",fill:"white",fillOpacity:"0.1"})})})]})},$="/backend/api".replace(/\/+$/,"")||"/api",fr=window.location.hostname.includes("webcontainer")||window.location.hostname.includes("stackblitz");console.log("API_BASE configured as:",$,"Fallback mode:",fr);async function M(n){const e=n.headers.get("content-type")||"",s=await n.text();if(!s||s.trim()==="")throw console.error("Empty response from server:",{status:n.status,url:n.url}),new Error(`Empty response from server (status ${n.status})`);let r=null;if(e.includes("application/json"))try{r=s?JSON.parse(s):null}catch(a){throw console.error("JSON parsing error:",a,{status:n.status,url:n.url,raw:s.slice(0,500)}),new Error(`Invalid JSON from server (status ${n.status})`)}else throw console.error("Non-JSON response:",{status:n.status,url:n.url,contentType:e,raw:s.slice(0,500)}),new Error(`Non-JSON response (status ${n.status})`);if(!n.ok){const a=r&&(r.error||r.message)||`HTTP ${n.status}`;throw console.error("API error:",{status:n.status,url:n.url,data:r}),new Error(a)}return r}class fa{constructor(){ne(this,"API_BASE",$)}getAuthHeaders(){const e=localStorage.getItem("admin_token");return{"Content-Type":"application/json",Accept:"application/json",...e&&{Authorization:`Bearer ${e}`}}}async login(e,s){console.log("Login attempt to:",`${$}/auth/login`);try{const r=await fetch(`${$}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:e,password:s})});console.log("Login response status:",r.status),console.log("Login response headers:",Object.fromEntries(r.headers.entries()));const a=await M(r);return a.success&&a.data&&localStorage.setItem("admin_token",a.data.token),a}catch(r){return console.error("Login API error:",r),{success:!1,error:r instanceof Error?r.message:"Невалиден имейл или парола"}}}async logout(){localStorage.removeItem("admin_token");try{await fetch(`${$}/auth/logout`,{method:"POST",headers:this.getAuthHeaders()})}catch{}}async getCurrentUser(){try{const e=await fetch(`${$}/auth/me`,{headers:this.getAuthHeaders()});return await M(e)}catch{return{success:!1,error:"Network error"}}}async getProperties(e,s=1,r=16){var a,i,o,d;if(fr){console.log("Using fallback data for getProperties");const l=this.getLocalProperties(),c=this.filterLocalProperties(l,e),u=((a=c.data)==null?void 0:a.length)||0,h=(s-1)*r,g=h+r;return{success:!0,data:((i=c.data)==null?void 0:i.slice(h,g))||[],meta:{page:s,limit:r,total:u,pages:Math.ceil(u/r),hasPrev:s>1,hasNext:s<Math.ceil(u/r)}}}try{console.log("API: Making request to get properties");const l=new URLSearchParams;l.set("page",String(s)),l.set("limit",String(r)),e&&Object.keys(e).forEach(g=>{e[g]!==void 0&&e[g]!==""&&l.append(g,e[g])});const c=`${$}/properties${l.toString()?`?${l.toString()}`:""}`;console.log("API: Full request URL:",c);const u=await fetch(c,{headers:this.getAuthHeaders()}),h=await M(u);return{success:h.success,data:h.data,meta:h.meta,error:h.error}}catch(l){console.error("API error in getProperties:",l),console.log("Using fallback local data");const c=this.getLocalProperties(),u=this.filterLocalProperties(c,e),h=((o=u.data)==null?void 0:o.length)||0,g=(s-1)*r,m=g+r;return{success:!0,data:((d=u.data)==null?void 0:d.slice(g,m))||[],meta:{page:s,limit:r,total:h,pages:Math.ceil(h/r),hasPrev:s>1,hasNext:s<Math.ceil(h/r)}}}}async getProperty(e){var s,r,a;console.log("API: getProperty called for",e);try{const i=await fetch(`${$}/properties/${e}`,{headers:this.getAuthHeaders()}),o=await M(i);if(console.log("API: getProperty response",o),o.success&&o.data)return console.log("API: Property found with images:",((s=o.data.images)==null?void 0:s.length)||0),o;console.log("API: Property not found, trying fallback");const l=this.getLocalProperties().find(c=>c.id===e);return l?(console.log("Fallback: Property found with images:",((r=l.images)==null?void 0:r.length)||0),{success:!0,data:l}):{success:!1,error:"Имотът не е намерен"}}catch(i){console.error("API error in getProperty:",i),console.log("API: Error occurred, using fallback");const d=this.getLocalProperties().find(l=>l.id===e);return d?(console.log("Fallback: Property found with images:",((a=d.images)==null?void 0:a.length)||0),{success:!0,data:d}):{success:!1,error:"Имотът не е намерен"}}}async createProperty(e){try{const s=await fetch(`${$}/properties`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return await M(s)}catch(s){return console.error("API error in createProperty:",s),{success:!1,error:s instanceof Error?s.message:"Грешка при създаване на имота"}}}async updateProperty(e,s){try{const r=await fetch(`${$}/properties/${e}`,{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(s)});return await M(r)}catch(r){console.error("API error in updateProperty:",r);const a=this.getLocalProperties(),i=a.findIndex(o=>o.id===e);return i!==-1?(a[i]={...a[i],...s,updated_at:new Date().toISOString()},this.saveLocalProperties(a),{success:!0,data:a[i]}):{success:!1,error:"Имотът не е намерен"}}}async deleteProperty(e){try{const s=await fetch(`${$}/properties/${e}`,{method:"DELETE",headers:this.getAuthHeaders()});return await M(s)}catch(s){console.error("API error in deleteProperty:",s);const a=this.getLocalProperties().filter(i=>i.id!==e);return this.saveLocalProperties(a),{success:!0}}}async uploadImage(e,s,r=!1){try{console.log("Uploading image:",{fileName:e.name,fileSize:e.size,propertyId:s,isMain:r});const a=new FormData;a.append("image",e),a.append("property_id",s),a.append("is_main",r.toString()),a.append("sort_order","0"),a.append("alt_text","Property image");const i=this.getAuthHeaders();delete i["Content-Type"],console.log("FormData contents:",{image:e.name,property_id:s,is_main:r,file_size:e.size,file_type:e.type}),console.log("FormData entries:");for(let[c,u]of a.entries())console.log(c,u);const o=localStorage.getItem("admin_token");console.log("Using token:",o?"Present":"Missing");const d=await fetch(`${$}/images/upload`,{method:"POST",headers:i,body:a});if(console.log("Upload response status:",d.status),console.log("Upload response headers:",Object.fromEntries(d.headers.entries())),!d.ok){const c=await d.text();throw console.error("Upload error response:",c),new Error(`Upload failed: ${d.status} - ${c}`)}const l=await M(d);return console.log("Upload response text:",l),console.log("Image upload result:",l),l}catch(a){return console.error("API error in uploadImage:",a),{success:!1,error:a instanceof Error?a.message:"Грешка при качване на снимката"}}}async deleteImage(e,s){try{const r=await fetch(`${$}/images/${s}`,{method:"DELETE",headers:this.getAuthHeaders()});return await M(r)}catch(r){return console.error("API error in deleteImage:",r),{success:!1,error:r instanceof Error?r.message:"Failed to upload image"}}}async setMainImage(e,s){try{const r=await fetch(`${$}/images/set-main`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify({property_id:s,image_id:e})});return await M(r)}catch(r){return console.error("API error in setMainImage:",r),{success:!1,error:"Грешка при задаване на главна снимка"}}}async updateImageOrder(e,s,r){try{const a=await fetch(`${$}/properties/${e}/images/${s}`,{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify({sort_order:r})});return await M(a)}catch(a){return console.error("API error in updateImageOrder:",a),{success:!1,error:"Грешка при обновяване на реда на снимките"}}}async updateImageAltText(e,s,r){try{const a=await fetch(`${$}/properties/${e}/images/${s}`,{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify({alt_text:r})});return await M(a)}catch(a){return console.error("API error in updateImageAltText:",a),{success:!1,error:"Грешка при обновяване на alt текста"}}}async uploadDocument(e,s){try{const r=new FormData;r.append("document",s),r.append("property_id",e);const a=this.getAuthHeaders();delete a["Content-Type"];const i=await fetch(`${$}/documents/upload`,{method:"POST",headers:a,body:r});return await M(i)}catch(r){return console.error("API error in uploadDocument:",r),{success:!1,error:"Грешка при качване на документа"}}}async deleteDocument(e){try{const s=await fetch(`${$}/documents/${e}`,{method:"DELETE",headers:this.getAuthHeaders()});return await M(s)}catch(s){return console.error("API error in deleteDocument:",s),{success:!1,error:"Грешка при изтриване на документа"}}}async getPages(){try{const s=await fetch(`${$}/pages`,{credentials:"include",headers:{Accept:"application/json",...this.getAuthHeaders()}});if(!s.ok){const r=await s.text();throw console.error("Set main image error response:",r),new Error(`Set main failed: ${s.status} - ${r}`)}if(!s.ok)throw new Error(`HTTP ${s.status}`);return await M(s)}catch(s){return console.error("API error in getPages:",s),{success:!1,error:"Грешка при зареждане на страниците"}}}async getPage(e){try{const s=await fetch(`${$}/pages/${e}`,{headers:this.getAuthHeaders()});return await M(s)}catch(s){return console.error("API error in getPage:",s),{success:!1,error:"Грешка при зареждане на страницата"}}}async getPageBySlug(e){try{const s=await fetch(`${$}/pages/slug/${e}`,{headers:this.getAuthHeaders()});return await M(s)}catch(s){return console.error("API error in getPageBySlug:",s),{success:!1,error:"Грешка при зареждане на страницата"}}}async createPage(e){try{const s=await fetch(`${$}/pages`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return await M(s)}catch{return{success:!1,error:"Network error"}}}async updatePage(e,s){try{const r=await fetch(`${$}/pages/${e}`,{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(s)});return await M(r)}catch{return{success:!1,error:"Network error"}}}async deletePage(e){try{const s=await fetch(`${$}/pages/${e}`,{method:"DELETE",headers:this.getAuthHeaders()});return await M(s)}catch{return{success:!1,error:"Network error"}}}async getServices(){try{const e=await fetch(`${$}/services`,{headers:this.getAuthHeaders()});return await M(e)}catch(e){return console.error("API error in getServices:",e),{success:!1,error:"Грешка при зареждане на услугите"}}}async getService(e){try{const s=await fetch(`${$}/services/${e}`,{headers:this.getAuthHeaders()});return await M(s)}catch{return{success:!1,error:"Network error"}}}async createService(e){try{const s=await fetch(`${$}/services`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return await M(s)}catch{return{success:!1,error:"Network error"}}}async updateService(e,s){try{const r=await fetch(`${$}/services/${e}`,{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(s)});return await M(r)}catch{return{success:!1,error:"Network error"}}}async deleteService(e){try{const s=await fetch(`${$}/services/${e}`,{method:"DELETE",headers:this.getAuthHeaders()});return await M(s)}catch{return{success:!1,error:"Network error"}}}async getSections(e){try{const s=new URLSearchParams;e&&Object.keys(e).forEach(i=>{e[i]!==void 0&&e[i]!==""&&s.append(i,e[i])});const r=`${$}/sections${s.toString()?`?${s.toString()}`:""}`,a=await fetch(r,{headers:this.getAuthHeaders()});return await M(a)}catch{return{success:!1,error:"Network error"}}}async getSection(e){try{const s=await fetch(`${$}/sections/${e}`,{headers:this.getAuthHeaders()});return await M(s)}catch{return{success:!1,error:"Network error"}}}async createSection(e){try{const s=await fetch(`${$}/sections`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return await M(s)}catch{return{success:!1,error:"Network error"}}}async updateSection(e,s){try{const r=await fetch(`${$}/sections/${e}`,{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(s)});return await M(r)}catch{return{success:!1,error:"Network error"}}}async deleteSection(e){try{const s=await fetch(`${$}/sections/${e}`,{method:"DELETE",headers:this.getAuthHeaders()});return await M(s)}catch{return{success:!1,error:"Network error"}}}async updateSectionsSortOrder(e){try{const s=await fetch(`${$}/sections/sort-order`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});return await M(s)}catch{return{success:!1,error:"Network error"}}}async getStats(){try{const e=await fetch(`${$}/properties/stats`,{headers:this.getAuthHeaders()});return await M(e)}catch(e){console.error("API error in getStats:",e);const s=this.getLocalProperties();return{success:!0,data:{totalProperties:s.length,activeProperties:s.filter(r=>r.active).length,featuredProperties:s.filter(r=>r.featured).length,totalViews:1250}}}}isAuthenticated(){const e=localStorage.getItem("admin_token");if(!e)return!1;const s=e.split(".");if(s.length!==3)return console.warn("Invalid token format, removing from localStorage"),localStorage.removeItem("admin_token"),!1;try{const r=JSON.parse(atob(s[1]));return!r.exp||!r.user_id||!r.role?(console.warn("Invalid token payload, removing from localStorage"),localStorage.removeItem("admin_token"),!1):r.exp*1e3<Date.now()?(console.warn("Token expired, removing from localStorage"),localStorage.removeItem("admin_token"),!1):!0}catch{return console.warn("Invalid token, removing from localStorage"),localStorage.removeItem("admin_token"),!1}}getLocalProperties(){const e=localStorage.getItem("consultingg_properties");if(e)try{return JSON.parse(e)}catch(s){return console.error("Error parsing stored properties:",s),localStorage.removeItem("consultingg_properties"),this.getDefaultProperties()}return this.getDefaultProperties()}saveLocalProperties(e){localStorage.setItem("consultingg_properties",JSON.stringify(e))}filterLocalProperties(e,s){let r=[...e];if(s){if(s.keyword){const a=s.keyword.toLowerCase();r=r.filter(i=>i.title.toLowerCase().includes(a)||i.description&&i.description.toLowerCase().includes(a)||i.district&&i.district.toLowerCase().includes(a)||i.address&&i.address.toLowerCase().includes(a)||i.property_type&&i.property_type.toLowerCase().includes(a))}s.transaction_type&&(r=r.filter(a=>a.transaction_type===s.transaction_type)),s.city_region&&(r=r.filter(a=>a.city_region===s.city_region)),s.district&&(r=r.filter(a=>a.district===s.district)),s.property_type&&(r=r.filter(a=>a.property_type===s.property_type)),s.featured==="true"&&(r=r.filter(a=>a.featured)),s.active!=="all"&&(r=r.filter(a=>a.active)),s.price_min&&(r=r.filter(a=>a.price>=parseInt(s.price_min))),s.price_max&&(r=r.filter(a=>a.price<=parseInt(s.price_max))),s.area_min&&(r=r.filter(a=>a.area>=parseInt(s.area_min))),s.area_max&&(r=r.filter(a=>a.area<=parseInt(s.area_max))),s.limit&&(r=r.slice(0,parseInt(s.limit)))}return{success:!0,data:r,total:r.length}}getDefaultProperties(){return[{id:"prop-001",title:"Модерна самостоятелна къща в Симеоново",description:`✨ Модерна самостоятелна къща с просторен двор и панорамни гледки в Симеоново ✨

Представяме Ви елегантен дом, съчетаващ модерна архитектура, функционално разпределение и просторна градина в един от най-престижните райони на София – кв. Симеоново, ул. Крайречна, в непосредствена близост до Симеоновско шосе.


🏡 Основни характеристики:

• Разрешение за ползване (Акт 16) – 2023 г.

• РЗП къща: 400 кв.м

• Двор: 1200 кв.м с възможност за изграждане на зони за отдих и зеленина

• Отопление: газова инсталация


📐 Разпределение:

• I ниво: просторна и светла всекидневна, кабинет, мокро помещение и тоалетна.

• II ниво: три самостоятелни спални, всяка с лична баня и дрешник, както и три тераси с впечатляващи гледки към града и планината.

Имотът се предлага на шпакловка и замазка, което Ви дава свободата да реализирате своя личен стил и интериорни идеи.


🌿 Предимства:

• Отлична локация в престижен и тих район

• Просторен двор, подходящ за градина, басейн или детска площадка

• Уникални панорамни гледки, осигуряващи усещане за свобода и уединение`,price:29e4,currency:"EUR",transaction_type:"sale",property_type:"3-СТАЕН",city_region:"София",district:"Симеоново",address:"ул. Симеоновско шосе 123",area:400,bedrooms:3,bathrooms:3,floors:2,floor_number:2,terraces:3,construction_type:"Тухла",condition_type:"Ново строителство",heating:"Газ",exposure:"Ю-И-З",year_built:2023,furnishing_level:"none",has_elevator:!0,has_garage:!0,has_southern_exposure:!0,new_construction:!0,featured:!0,active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[{id:"img-001",property_id:"prop-001",image_url:"/images/prop-001/1_kachta_simeonovo.jpg",thumbnail_url:"/images/prop-001/1_kachta_simeonovo_thumb.jpg",sort_order:0,is_main:!0,created_at:new Date().toISOString()},{id:"img-001b",property_id:"prop-001",image_url:"/images/prop-001/2_kachta_simeonovo.jpg",thumbnail_url:"/images/prop-001/2_kachta_simeonovo_thumb.jpg",sort_order:1,is_main:!1,created_at:new Date().toISOString()},{id:"img-001c",property_id:"prop-001",image_url:"/images/prop-001/3_kachta_simeonovo.jpg",sort_order:3,is_main:!1,created_at:new Date().toISOString()},{id:"img-001d",property_id:"prop-001",image_url:"/images/prop-001/4_kachta_simeonovo.jpg",sort_order:4,is_main:!1,created_at:new Date().toISOString()},{id:"img-001e",property_id:"prop-001",image_url:"/images/prop-001/5_kachta_simeonovo.jpg",sort_order:5,is_main:!1,created_at:new Date().toISOString()},{id:"img-001f",property_id:"prop-001",image_url:"/images/prop-001/6_kachta_simeonovo.jpg",sort_order:6,is_main:!1,created_at:new Date().toISOString()},{id:"img-001g",property_id:"prop-001",image_url:"/images/prop-001/7_kachta_simeonovo.jpg",sort_order:7,is_main:!1,created_at:new Date().toISOString()},{id:"img-001h",property_id:"prop-001",image_url:"/images/prop-001/8_kachta_simeonovo.jpg",sort_order:2,is_main:!1,created_at:new Date().toISOString()}]},{id:"prop-002",title:"Модерна самостоятелна къща с двор в Драгалевци",description:`✨ Модерна самостоятелна къща с двор в Драгалевци ✨

В непосредствена близост до комплекс Царско село и BRITANICA Park School. Проектът е в процес на строителство (до Акт 15) с планирано въвеждане в експлоатация – Акт 16, февруари 2024 г.

🏡 Основни характеристики:

• Статус: в строеж, до Акт 15

• Въвеждане в експлоатация: Акт 16 – февруари 2024 г.

• Отопление: газова инсталация

• Издаване: шпакловка и замазка

📐 Разпределение:

• Сутерен: коридор, гараж за две коли, склад

• Партер: входно антре, просторна дневна с трапезария и кухненски бокс, кабинет/стая за гости, тоалетна

• Първи етаж: спалня с дрешник и собствена баня с тоалетна, две спални, перално помещение, баня с тоалетна, тераса

🌿 Предимства:

• Отлична локация в престижен и спокоен район

• Просторен гараж за два автомобила

• Функционално и модерно вътрешно разпределение

• Близост до училище и спортно-развлекателни комплекси`,price:52e4,currency:"EUR",transaction_type:"sale",property_type:"КЪЩА",city_region:"София",district:"Драгалевци",address:"в близост до комплекс Царско село",area:280,bedrooms:3,bathrooms:2,floors:3,floor_number:0,terraces:1,construction_type:"Тухла",condition_type:"Ново строителство",heating:"Газ",exposure:"Ю-И-З",year_built:2024,furnishing_level:"none",has_elevator:!1,has_garage:!0,has_southern_exposure:!0,new_construction:!0,featured:!0,active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[{id:"img-002",property_id:"prop-002",image_url:"/images/prop-002/1_kachta_dragalevci.jpg",thumbnail_url:"/images/prop-002/1_kachta_dragalevci_thumb.jpg",sort_order:0,is_main:!0,created_at:new Date().toISOString()},{id:"img-002b",property_id:"prop-002",image_url:"/images/prop-002/2_kachta_dragalevci.jpg",thumbnail_url:"/images/prop-002/2_kachta_dragalevci_thumb.jpg",sort_order:1,is_main:!1,created_at:new Date().toISOString()}]},{id:"prop-006",title:"Самостоятелна къща с 360° панорамна гледка в кв. Бояна",description:`✨ Самостоятелна къща с 360° панорамна гледка в кв. Бояна ✨

Изключителен дом, предлагащ изглед към Витоша, Ботаническата градина и София. Ново строителство (2026 г.), разположен на обилен парцел в престижната Бояна, с материали и технологии от висок клас.

🏡 Характеристики:

• РЗП: 538,80 кв.м

• Двор: 1101 кв.м – ландшафтен дизайн

• Конструкция: тухла Wienerberger

• Дограма: алуминиева с троен стъклопакет ETEM

• Отопление: термопомпа Daikin + газово котле + подово отопление + конвектори

• Гараж: подземен за 3 автомобила + фитнес със сауна

📐 Разпределение:

• Партер: хол с камина, кухня + склад, стая за гости/офис, тоалетна за гости, дрешник, перално

• Етаж 2: родителска спалня с баня, 2 детски стаи с бани, горен хол/офис

• Панорамен покрив: с ток, вода и възможност за кухня, бар или басейн

• Подземно ниво: гараж, баня, котелно, склад, фитнес, сауна

🌿 Удобства и допълнителни характеристики:

• Алуминиева входна врата

• Външна мазилка с врачански камък

• Южно изложение

• Тихо място с бърз достъп до града

🏆 Предимства:

• Имоти без аналог — комбинация от стил, простор и гледка в сърцето на Бояна

• Високо качество на строителството и използваните материали

• Идеално за жилище, престиж / представителство или комфортен, луксозен начин на живот`,price:135e4,currency:"EUR",transaction_type:"sale",property_type:"КЪЩА",city_region:"София",district:"Бояна",address:"кв. Бояна",area:538.8,bedrooms:3,bathrooms:5,floors:3,floor_number:0,terraces:3,construction_type:"Тухла",condition_type:"Ново строителство",heating:"Локално",exposure:"Юг",year_built:2026,furnishing_level:"none",has_elevator:!1,has_garage:!0,has_southern_exposure:!0,new_construction:!0,featured:!0,active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[{id:"img-006",property_id:"prop-006",image_url:"/images/prop-006/kachta_boyana_1.jpg",thumbnail_url:"/images/prop-006/kachta_boyana_1_thumb.jpg",sort_order:0,is_main:!0,created_at:new Date().toISOString()},{id:"img-006b",property_id:"prop-006",image_url:"/images/prop-006/kachta_boyana_2.jpg",thumbnail_url:"/images/prop-006/kachta_boyana_2_thumb.jpg",sort_order:1,is_main:!1,created_at:new Date().toISOString()},{id:"img-006c",property_id:"prop-006",image_url:"/images/prop-006/kachta_boyana_3.jpg",thumbnail_url:"/images/prop-006/kachta_boyana_3_thumb.jpg",sort_order:2,is_main:!1,created_at:new Date().toISOString()},{id:"img-006d",property_id:"prop-006",image_url:"/images/prop-006/kachta_boyana_4.jpg",thumbnail_url:"/images/prop-006/kachta_boyana_4_thumb.jpg",sort_order:3,is_main:!1,created_at:new Date().toISOString()},{id:"img-006e",property_id:"prop-006",image_url:"/images/prop-006/kachta_boyana_5.jpg",thumbnail_url:"/images/prop-006/kachta_boyana_5_thumb.jpg",sort_order:4,is_main:!1,created_at:new Date().toISOString()}]},{id:"prop-010",title:"Луксозна самостоятелна къща в кв. Бояна | 580.70 кв.м РЗП | Двор 1200 кв.м | 360° панорама",description:`🏡 Луксозна самостоятелна къща в кв. Бояна | 580.70 кв.м РЗП | Двор 1200 кв.м | 360° панорама

Нова къща в процес на строителство, с планирано въвеждане в експлоатация през 2026 г., разположена в престижната част на кв. Бояна. Имотът се отличава с южно изложение, панорамни 360° гледки към Витоша, Ботаническата градина и цяла София, двор от 1200 кв.м с професионален ландшафтен проект, както и големи тераси със стъклени парапети, осигуряващи простор и светлина.

👉 Къщата разполага с дизайнерски проект и 3D визуализации за баните, тоалетните и кухнята – изключително предимство за бъдещото довършване и обзавеждане на дома.

✔️ Основни характеристики:
 • РЗП: 580.70 кв.м
 • Двор: 1101 кв.м (ландшафтинг)
 • Строителство: тухла Wienerberger
 • Дограма: алуминиева ETEM, троен шумоизолиращ стъклопакет
 • Отопление и охлаждане: термопомпа Daikin, газово котле, 500 л бойлер, подово отопление, конвектори
 • Газ: Да

🔻 Подземно ниво :
 • Гараж за 2/3 автомобила с луксозни врати BENINCA
 • Широка рампа с павета за 4–6 автомобила
 • Котелно помещение, малък склад
 • Фитнес със сауна, парна баня, баня и тоалетна

🔸 Първи етаж (партер):
 • Тоалетна за гости
 • Голям дрешник и перално помещение
 • Стая за гости или персонал
 • Просторен хол с камина
 • Кухня със складово помещение
 • Големи тераси със стъклени парапети

🔸 Втори етаж:
 • Родителска спалня с три отделни помещения: баня, тоалетна и дрешник
 • Две детски стаи, всяка със собствена баня и дрешник
 • Излаз към панорамни тераси

🌇 Панорамен покрив:
 • Вътрешен достъп
 • 360° гледка към София и Витоша
 • Изводи за ток и вода
 • Подходящ за лятна кухня, бар, roof-top зона или басейн

🎯 Предимства:
 • Топ локация
 • Дизайнерски проект с визуализации за бани, тоалетни и кухня
 • Простор, комфорт и гледки без аналог в София`,price:217e5,currency:"EUR",transaction_type:"sale",property_type:"КЪЩА",city_region:"София",district:"Бояна",address:"кв. Бояна",area:580.7,bedrooms:4,bathrooms:5,floors:3,floor_number:0,terraces:4,construction_type:"Тухла",condition_type:"Ново строителство",heating:"Термопомпа",exposure:"Юг",year_built:2026,furnishing_level:"none",has_elevator:!1,has_garage:!0,has_southern_exposure:!0,new_construction:!0,featured:!1,active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),pricing_mode:"total",images:[{id:"img-010a",property_id:"prop-010",image_url:"/images/prop-010/image1.jpeg",sort_order:1,is_main:!0,created_at:new Date().toISOString()},{id:"img-010b",property_id:"prop-010",image_url:"/images/prop-010/image2.jpeg",sort_order:2,is_main:!1,created_at:new Date().toISOString()},{id:"img-010c",property_id:"prop-010",image_url:"/images/prop-010/image3.jpeg",sort_order:3,is_main:!1,created_at:new Date().toISOString()},{id:"img-010d",property_id:"prop-010",image_url:"/images/prop-010/image4.jpeg",sort_order:4,is_main:!1,created_at:new Date().toISOString()},{id:"img-010e",property_id:"prop-010",image_url:"/images/prop-010/image5.jpeg",sort_order:5,is_main:!1,created_at:new Date().toISOString()}]},{id:"prop-007",title:"✨ Слънчев четиристаен апартамент в Оборище с панорамни гледки ✨",description:`Представяме ви просторен и светъл апартамент, разположен в сърцето на кв. Оборище, в непосредствена близост до Малък градски театър, парк „Заимов", метростанция Театрална и удобни спирки на градски транспорт. Жилището разкрива впечатляващи гледки към Витоша и към емблематичния храм-паметник „Св. Александър Невски".

📐 Разпределение:
• Просторна всекидневна с кухненски бокс
• Три самостоятелни спални
• Две бани с тоалетни
• Отделна тоалетна за гости
• Три тераси с гледки

🌿 Предимства:
• Отлична локация в престижен квартал
• Панорамни гледки към планината и центъра
• Баланс между градски комфорт и спокойствие

⚙️ Удобства:
• Възможност за паркомясто или гараж
• Панорамни гледки
• Напълно оборудвано жилище
• Тиха и престижна локация`,price:1500,currency:"EUR",transaction_type:"rent",property_type:"4-СТАЕН",city_region:"София",district:"Оборище",address:"кв. Оборище, близо до метростанция Театрална",area:120,bedrooms:3,bathrooms:2,floors:8,floor_number:7,terraces:3,construction_type:"Тухла",condition_type:"Обзаведен",heating:"ТЕЦ",exposure:"Ю-И-З",year_built:null,furnishing_level:"full",has_elevator:!0,has_garage:!1,has_southern_exposure:!0,new_construction:!1,featured:!0,active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[{id:"img-007a",property_id:"prop-007",image_url:"/images/prop-007/ap_oborichte_1.jpg",sort_order:1,is_main:!0,created_at:new Date().toISOString()},{id:"img-007b",property_id:"prop-007",image_url:"/images/prop-007/ap_oborichte_2.jpg",sort_order:2,is_main:!1,created_at:new Date().toISOString()},{id:"img-007c",property_id:"prop-007",image_url:"/images/prop-007/ap_oborichte_3.jpg",sort_order:3,is_main:!1,created_at:new Date().toISOString()},{id:"img-007d",property_id:"prop-007",image_url:"/images/prop-007/ap_oborichte_4.jpg",sort_order:4,is_main:!1,created_at:new Date().toISOString()},{id:"img-007e",property_id:"prop-007",image_url:"/images/prop-007/ap_oborichte_5.jpg",sort_order:5,is_main:!1,created_at:new Date().toISOString()}]},{id:"prop-008",title:"Модерна самостоятелна къща с двор и панорамни гледки в Драгалевци",description:`✨ Модерна самостоятелна къща с двор и панорамни гледки в Драгалевци ✨

Разположена на ул. Пчелица, в близост до Киноцентъра, къщата предлага комфорт, функционалност и завършеност до ключ. Имотът е с Акт 16 / 2023 г., разполага с РЗП 460 кв.м и самостоятелен двор от 420 кв.м.

🏡 Основни характеристики:
• РЗП къща: 460 кв.м
• Двор: 420 кв.м
• Етажи: 3
• Разрешение за ползване: Акт 16 / 2023 г.
• Състояние: завършена до ключ

📐 Разпределение:
• I ниво: всекидневна, кухня, дрешник и тоалетна
• II ниво: три спални със самостоятелни бани
• III ниво: всекидневна, кухненски бокс, спалня, баня с тоалетна, камина

🌿 Предимства:
• Подови настилки: гранитогрес и ламинат
• Отопление на ток с климатици и камина
• Просторен и функционален имот, готов за обитаване
• Прекрасни панорамни гледки
• Престижна и спокойна локация в подножието на планината`,price:125e4,currency:"EUR",transaction_type:"sale",property_type:"КЪЩА",city_region:"София",district:"Драгалевци",address:"ул. Пчелица, в близост до Киноцентъра",area:460,bedrooms:4,bathrooms:4,floors:3,floor_number:0,terraces:1,construction_type:"Тухла",condition_type:"Завършена до ключ",heating:"Климатици",exposure:"Ю-И-З",year_built:2023,furnishing_level:"partial",has_elevator:!1,has_garage:!1,has_southern_exposure:!0,new_construction:!1,featured:!0,active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),images:[{id:"img-008a",property_id:"prop-008",image_url:"/images/prop-008/kachta_dragalevci_1.jpg",sort_order:1,is_main:!0,created_at:new Date().toISOString()},{id:"img-008b",property_id:"prop-008",image_url:"/images/prop-008/kachta_dragalevci_2.jpg",sort_order:2,is_main:!1,created_at:new Date().toISOString()},{id:"img-008c",property_id:"prop-008",image_url:"/images/prop-008/kachta_dragalevci_3.jpg",sort_order:3,is_main:!1,created_at:new Date().toISOString()},{id:"img-008d",property_id:"prop-008",image_url:"/images/prop-008/kachta_dragalevci_4.jpg",sort_order:4,is_main:!1,created_at:new Date().toISOString()},{id:"img-008e",property_id:"prop-008",image_url:"/images/prop-008/kachta_dragalevci_5.jpg",sort_order:5,is_main:!1,created_at:new Date().toISOString()}]},{id:"prop-009",title:'Офис площи / Обект "Метличина поляна 15", кв. Гоце Делчев',description:`✨ Офис площи / Обект "Метличина поляна 15", кв. Гоце Делчев ✨

Този имот предлага функционални офис пространства, разположени в добре позиционирана реновирана сграда с отлична достъпност и силна локация.

🏢 Основни характеристики:
• Обект: самостоятелен офис в сграда с монолитна стоманобетонова конструкция
• Разрешение за ползване: Акт 16 / 2024 г. (очакван)
• Площ: ≈ 1 117.58 кв.м общо по документи
• Нива: две нива (партер и първи етаж)

📐 Разпределение / помещения:
• Партер: портиерна, фоайе и приемна, 16 самостоятелни работни стаи, санитарен възел
• Етаж 2: 21 самостоятелни работни стаи, санитарен възел
• Паркинг: възможност за паркоместа в подземния гараж на сградата

🌍 Локация и удобства:
• Квартал Гоце Делчев — граничен с бул. България, бул. Гоце Делчев, и кварталите Стрелбище, Борово и Манастирски ливади
• Ул. „Метличина поляна" е тихa и спокойна, близо до ул. Костенски Водопад и Южния парк
• Район с добре развита инфраструктура — услуги, транспортни връзки, зелени площи, удобства около сградата – парк / междублоково пространство

⚙️ Предимства / Удобства:
• Голям брой отделни офисни помещения — подходящо за фирми, колективи или споделени офиси
• Санитарни възли и приемни във всеки етаж
• Подземен гараж / паркоместа — за служители / посетители
• Тиха локация, но с добър достъп до основни булеварди и градски транспорт`,price:8,currency:"EUR",transaction_type:"rent",property_type:"ОФИС",city_region:"София",district:"Гоце Делчев",address:"ул. Метличина поляна 15",area:1117.58,bedrooms:0,bathrooms:2,floors:2,floor_number:0,terraces:0,construction_type:"Монолит",condition_type:"Реновирана",heating:"ТЕЦ",exposure:"Ю-И",year_built:2024,furnishing_level:"none",has_elevator:!0,has_garage:!0,has_southern_exposure:!1,new_construction:!1,featured:!0,active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),pricing_mode:"per_sqm",images:[{id:"img-009a",property_id:"prop-009",image_url:"/images/prop-009/1_office_rent_gotze_delchev.jpg",sort_order:1,is_main:!0,created_at:new Date().toISOString()},{id:"img-009b",property_id:"prop-009",image_url:"/images/prop-009/2_office_rent_gotze_delchev.jpg",sort_order:2,is_main:!1,created_at:new Date().toISOString()},{id:"img-009c",property_id:"prop-009",image_url:"/images/prop-009/3_office_rent_gotze_delchev.jpg",sort_order:3,is_main:!1,created_at:new Date().toISOString()},{id:"img-009d",property_id:"prop-009",image_url:"/images/prop-009/4_office_rent_gotze_delchev.jpg",sort_order:4,is_main:!1,created_at:new Date().toISOString()}]}]}async uploadPropertyImages(e,s){try{const r=[];for(let a=0;a<s.length;a++){const i=s[a],o=new FormData;o.append("image",i),o.append("property_id",e),o.append("sort_order",a.toString()),o.append("is_main",a===0?"true":"false"),o.append("alt_text",`${i.name} - Property image`);const d=await fetch(`${$}/images/upload`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("admin_token")}`},body:o}),l=await M(d);r.push(l.data)}return{success:!0,data:r}}catch(r){return console.error("Upload error:",r),{success:!1,error:r instanceof Error?r.message:"Upload failed"}}}async deletePropertyImage(e){try{const s=await fetch(`${$}/images/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("admin_token")}`}});return await M(s)}catch(s){return console.error("Delete error:",s),{success:!1,error:s instanceof Error?s.message:"Delete failed"}}}}const O=new fa,pa=()=>{const[n,e]=k.useState([]),[s,r]=k.useState(!0),[a,i]=k.useState(1),[o,d]=k.useState({});U.useEffect(()=>{l();const c=()=>{l()};return window.addEventListener("featuredPropertiesChanged",c),()=>{window.removeEventListener("featuredPropertiesChanged",c)}},[a]);const l=async()=>{r(!0);try{const c=await O.getProperties({featured:"true"},a,16);c.success&&c.data&&(e(c.data),d(c.meta||{}))}catch(c){console.error("Error fetching featured properties:",c)}finally{r(!1)}};return s?t.jsx("section",{className:"py-12 bg-gray-50",children:t.jsxs("div",{className:"container mx-auto px-4",children:[t.jsxs("div",{className:"text-center mb-16",children:[t.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Препоръчани имоти"}),t.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Открийте най-добрите предложения, селектирани специално за вас"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[...Array(4)].map((c,u)=>t.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden animate-pulse",children:[t.jsx("div",{className:"h-48 bg-gray-200"}),t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),t.jsx("div",{className:"h-6 bg-gray-200 rounded mb-3"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded"})]})]},u))})]})}):t.jsx("section",{className:"py-12 bg-gray-50",children:t.jsxs("div",{className:"container mx-auto px-4",children:[t.jsxs("div",{className:"text-center mb-16",children:[t.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Препоръчани имоти"}),t.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Открийте най-добрите предложения, селектирани специално за вас"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:n.map(c=>{var u,h,g,m;return t.jsxs(B,{to:`/properties/${c.id}`,className:`bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden group cursor-pointer transform hover:-translate-y-2 ${c.transaction_type==="rent"?"ring-2 ring-sky-200 bg-gradient-to-br from-white to-sky-50":""}`,children:[t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:((h=(u=c.images)==null?void 0:u[0])==null?void 0:h.url)||((m=(g=c.images)==null?void 0:g[0])==null?void 0:m.image_url)||"/images/1_kachta_simeonovo.jpg",alt:c.title,className:"w-full h-48 object-cover group-hover:scale-110 transition-transform duration-500",onError:x=>{const b=x.target;b.src="/images/1_kachta_simeonovo.jpg"}}),t.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-2",children:[c.transaction_type==="rent"&&t.jsxs("div",{className:"bg-gradient-to-r from-sky-500 to-sky-600 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"Под наем"]}),c.featured&&t.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg",children:"Препоръчан"})]}),t.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:t.jsx("button",{className:"w-8 h-8 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center text-gray-700 hover:bg-white hover:text-blue-600 transition-all duration-200 shadow-lg",children:t.jsx(ye,{className:"w-4 h-4"})})})]}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-2",children:[t.jsx(ve,{className:"w-4 h-4"}),t.jsxs("span",{className:"text-sm font-medium",children:[c.district?`${c.district}, `:"",c.city_region||"Всички области"]})]}),t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-3 line-clamp-2",children:c.title}),t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["€",Math.floor(c.price||0).toLocaleString(),c.transaction_type==="rent"&&t.jsx("span",{className:"text-sm text-sky-600 font-medium",children:"/месец"})]})}),t.jsxs("div",{className:"flex items-center gap-4 text-gray-600",children:[c.bedrooms>0&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(ns,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:c.bedrooms})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(as,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:c.bathrooms||0})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(is,{className:"w-4 h-4"}),t.jsxs("span",{className:"text-sm",children:[c.area||0," м²"]})]})]})]})]},c.id)})}),t.jsxs("div",{className:"text-center mt-12",children:[o.pages>1&&t.jsx("div",{className:"flex justify-center mb-8",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>i(c=>Math.max(1,c-1)),disabled:!o.hasPrev,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Назад"}),Array.from({length:o.pages},(c,u)=>u+1).map(c=>t.jsx("button",{onClick:()=>i(c),className:`px-4 py-2 rounded-lg ${c===a?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors"}`,children:c},c)),t.jsx("button",{onClick:()=>i(c=>Math.min(o.pages,c+1)),disabled:!o.hasNext,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Напред"})]})}),t.jsx(B,{to:"/properties",className:"inline-block px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:"Вижте всички имоти"})]})]})})},xa=[{id:"service-001",title:"Продажба на имоти",description:"Професионално съдействие при продажба на всички видове недвижими имоти",icon:"Home",color:"from-blue-500 to-blue-600",sort_order:1,active:!0},{id:"service-002",title:"Инвестиционни консултации",description:"Експертни съвети за инвестиции в недвижими имоти с висока доходност",icon:"TrendingUp",color:"from-green-500 to-green-600",sort_order:2,active:!0},{id:"service-003",title:"Правна защита",description:"Пълна правна защита и съдействие при всички сделки с имоти",icon:"Shield",color:"from-purple-500 to-purple-600",sort_order:3,active:!0},{id:"service-004",title:"Управление на имоти",description:"Професионално управление и поддръжка на вашите недвижими имоти",icon:"Users",color:"from-orange-500 to-orange-600",sort_order:4,active:!0},{id:"service-005",title:"Оценка на имоти",description:"Точна и професионална оценка на пазарната стойност на имотите",icon:"Award",color:"from-red-500 to-red-600",sort_order:5,active:!0},{id:"service-006",title:"24/7 Поддръжка",description:"Непрекъсната поддръжка и консултации за всички ваши въпроси",icon:"Headphones",color:"from-indigo-500 to-indigo-600",sort_order:6,active:!0}],ba={Home:rs,TrendingUp:dn,Shield:cn,Users:ln,Award:on,Headphones:an},ya=()=>t.jsx("section",{className:"py-12 bg-white",children:t.jsxs("div",{className:"container mx-auto px-4",children:[t.jsxs("div",{className:"text-center mb-16",children:[t.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Нашите услуги"}),t.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Предлагаме пълен спектър от професионални услуги в областта на недвижимите имоти"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:xa.map(n=>{const e=ba[n.icon]||rs;return t.jsxs("div",{className:"group p-8 bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 border border-gray-100 hover:border-blue-200 cursor-pointer transform hover:-translate-y-2",children:[t.jsx("div",{className:`w-16 h-16 bg-gradient-to-r ${n.color} rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300`,children:t.jsx(e,{className:"w-8 h-8 text-white"})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4 group-hover:text-blue-600 transition-colors",children:n.title}),t.jsx("p",{className:"text-gray-600 leading-relaxed",children:n.description})]},n.id)})})]})});var va=Object.defineProperty,ht=Object.getOwnPropertySymbols,pr=Object.prototype.hasOwnProperty,xr=Object.prototype.propertyIsEnumerable,Ss=(n,e,s)=>e in n?va(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,qt=(n,e)=>{for(var s in e||(e={}))pr.call(e,s)&&Ss(n,s,e[s]);if(ht)for(var s of ht(e))xr.call(e,s)&&Ss(n,s,e[s]);return n},zt=(n,e)=>{var s={};for(var r in n)pr.call(n,r)&&e.indexOf(r)<0&&(s[r]=n[r]);if(n!=null&&ht)for(var r of ht(n))e.indexOf(r)<0&&xr.call(n,r)&&(s[r]=n[r]);return s};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var we;(n=>{const e=class L{constructor(l,c,u,h){if(this.version=l,this.errorCorrectionLevel=c,this.modules=[],this.isFunction=[],l<L.MIN_VERSION||l>L.MAX_VERSION)throw new RangeError("Version value out of range");if(h<-1||h>7)throw new RangeError("Mask value out of range");this.size=l*4+17;let g=[];for(let x=0;x<this.size;x++)g.push(!1);for(let x=0;x<this.size;x++)this.modules.push(g.slice()),this.isFunction.push(g.slice());this.drawFunctionPatterns();const m=this.addEccAndInterleave(u);if(this.drawCodewords(m),h==-1){let x=1e9;for(let b=0;b<8;b++){this.applyMask(b),this.drawFormatBits(b);const p=this.getPenaltyScore();p<x&&(h=b,x=p),this.applyMask(b)}}a(0<=h&&h<=7),this.mask=h,this.applyMask(h),this.drawFormatBits(h),this.isFunction=[]}static encodeText(l,c){const u=n.QrSegment.makeSegments(l);return L.encodeSegments(u,c)}static encodeBinary(l,c){const u=n.QrSegment.makeBytes(l);return L.encodeSegments([u],c)}static encodeSegments(l,c,u=1,h=40,g=-1,m=!0){if(!(L.MIN_VERSION<=u&&u<=h&&h<=L.MAX_VERSION)||g<-1||g>7)throw new RangeError("Invalid value");let x,b;for(x=u;;x++){const N=L.getNumDataCodewords(x,c)*8,S=o.getTotalBits(l,x);if(S<=N){b=S;break}if(x>=h)throw new RangeError("Data too long")}for(const N of[L.Ecc.MEDIUM,L.Ecc.QUARTILE,L.Ecc.HIGH])m&&b<=L.getNumDataCodewords(x,N)*8&&(c=N);let p=[];for(const N of l){s(N.mode.modeBits,4,p),s(N.numChars,N.mode.numCharCountBits(x),p);for(const S of N.getData())p.push(S)}a(p.length==b);const y=L.getNumDataCodewords(x,c)*8;a(p.length<=y),s(0,Math.min(4,y-p.length),p),s(0,(8-p.length%8)%8,p),a(p.length%8==0);for(let N=236;p.length<y;N^=253)s(N,8,p);let C=[];for(;C.length*8<p.length;)C.push(0);return p.forEach((N,S)=>C[S>>>3]|=N<<7-(S&7)),new L(x,c,C,g)}getModule(l,c){return 0<=l&&l<this.size&&0<=c&&c<this.size&&this.modules[c][l]}getModules(){return this.modules}drawFunctionPatterns(){for(let u=0;u<this.size;u++)this.setFunctionModule(6,u,u%2==0),this.setFunctionModule(u,6,u%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const l=this.getAlignmentPatternPositions(),c=l.length;for(let u=0;u<c;u++)for(let h=0;h<c;h++)u==0&&h==0||u==0&&h==c-1||u==c-1&&h==0||this.drawAlignmentPattern(l[u],l[h]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(l){const c=this.errorCorrectionLevel.formatBits<<3|l;let u=c;for(let g=0;g<10;g++)u=u<<1^(u>>>9)*1335;const h=(c<<10|u)^21522;a(h>>>15==0);for(let g=0;g<=5;g++)this.setFunctionModule(8,g,r(h,g));this.setFunctionModule(8,7,r(h,6)),this.setFunctionModule(8,8,r(h,7)),this.setFunctionModule(7,8,r(h,8));for(let g=9;g<15;g++)this.setFunctionModule(14-g,8,r(h,g));for(let g=0;g<8;g++)this.setFunctionModule(this.size-1-g,8,r(h,g));for(let g=8;g<15;g++)this.setFunctionModule(8,this.size-15+g,r(h,g));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let l=this.version;for(let u=0;u<12;u++)l=l<<1^(l>>>11)*7973;const c=this.version<<12|l;a(c>>>18==0);for(let u=0;u<18;u++){const h=r(c,u),g=this.size-11+u%3,m=Math.floor(u/3);this.setFunctionModule(g,m,h),this.setFunctionModule(m,g,h)}}drawFinderPattern(l,c){for(let u=-4;u<=4;u++)for(let h=-4;h<=4;h++){const g=Math.max(Math.abs(h),Math.abs(u)),m=l+h,x=c+u;0<=m&&m<this.size&&0<=x&&x<this.size&&this.setFunctionModule(m,x,g!=2&&g!=4)}}drawAlignmentPattern(l,c){for(let u=-2;u<=2;u++)for(let h=-2;h<=2;h++)this.setFunctionModule(l+h,c+u,Math.max(Math.abs(h),Math.abs(u))!=1)}setFunctionModule(l,c,u){this.modules[c][l]=u,this.isFunction[c][l]=!0}addEccAndInterleave(l){const c=this.version,u=this.errorCorrectionLevel;if(l.length!=L.getNumDataCodewords(c,u))throw new RangeError("Invalid argument");const h=L.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][c],g=L.ECC_CODEWORDS_PER_BLOCK[u.ordinal][c],m=Math.floor(L.getNumRawDataModules(c)/8),x=h-m%h,b=Math.floor(m/h);let p=[];const y=L.reedSolomonComputeDivisor(g);for(let N=0,S=0;N<h;N++){let j=l.slice(S,S+b-g+(N<x?0:1));S+=j.length;const w=L.reedSolomonComputeRemainder(j,y);N<x&&j.push(0),p.push(j.concat(w))}let C=[];for(let N=0;N<p[0].length;N++)p.forEach((S,j)=>{(N!=b-g||j>=x)&&C.push(S[N])});return a(C.length==m),C}drawCodewords(l){if(l.length!=Math.floor(L.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let c=0;for(let u=this.size-1;u>=1;u-=2){u==6&&(u=5);for(let h=0;h<this.size;h++)for(let g=0;g<2;g++){const m=u-g,b=(u+1&2)==0?this.size-1-h:h;!this.isFunction[b][m]&&c<l.length*8&&(this.modules[b][m]=r(l[c>>>3],7-(c&7)),c++)}}a(c==l.length*8)}applyMask(l){if(l<0||l>7)throw new RangeError("Mask value out of range");for(let c=0;c<this.size;c++)for(let u=0;u<this.size;u++){let h;switch(l){case 0:h=(u+c)%2==0;break;case 1:h=c%2==0;break;case 2:h=u%3==0;break;case 3:h=(u+c)%3==0;break;case 4:h=(Math.floor(u/3)+Math.floor(c/2))%2==0;break;case 5:h=u*c%2+u*c%3==0;break;case 6:h=(u*c%2+u*c%3)%2==0;break;case 7:h=((u+c)%2+u*c%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[c][u]&&h&&(this.modules[c][u]=!this.modules[c][u])}}getPenaltyScore(){let l=0;for(let g=0;g<this.size;g++){let m=!1,x=0,b=[0,0,0,0,0,0,0];for(let p=0;p<this.size;p++)this.modules[g][p]==m?(x++,x==5?l+=L.PENALTY_N1:x>5&&l++):(this.finderPenaltyAddHistory(x,b),m||(l+=this.finderPenaltyCountPatterns(b)*L.PENALTY_N3),m=this.modules[g][p],x=1);l+=this.finderPenaltyTerminateAndCount(m,x,b)*L.PENALTY_N3}for(let g=0;g<this.size;g++){let m=!1,x=0,b=[0,0,0,0,0,0,0];for(let p=0;p<this.size;p++)this.modules[p][g]==m?(x++,x==5?l+=L.PENALTY_N1:x>5&&l++):(this.finderPenaltyAddHistory(x,b),m||(l+=this.finderPenaltyCountPatterns(b)*L.PENALTY_N3),m=this.modules[p][g],x=1);l+=this.finderPenaltyTerminateAndCount(m,x,b)*L.PENALTY_N3}for(let g=0;g<this.size-1;g++)for(let m=0;m<this.size-1;m++){const x=this.modules[g][m];x==this.modules[g][m+1]&&x==this.modules[g+1][m]&&x==this.modules[g+1][m+1]&&(l+=L.PENALTY_N2)}let c=0;for(const g of this.modules)c=g.reduce((m,x)=>m+(x?1:0),c);const u=this.size*this.size,h=Math.ceil(Math.abs(c*20-u*10)/u)-1;return a(0<=h&&h<=9),l+=h*L.PENALTY_N4,a(0<=l&&l<=2568888),l}getAlignmentPatternPositions(){if(this.version==1)return[];{const l=Math.floor(this.version/7)+2,c=this.version==32?26:Math.ceil((this.version*4+4)/(l*2-2))*2;let u=[6];for(let h=this.size-7;u.length<l;h-=c)u.splice(1,0,h);return u}}static getNumRawDataModules(l){if(l<L.MIN_VERSION||l>L.MAX_VERSION)throw new RangeError("Version number out of range");let c=(16*l+128)*l+64;if(l>=2){const u=Math.floor(l/7)+2;c-=(25*u-10)*u-55,l>=7&&(c-=36)}return a(208<=c&&c<=29648),c}static getNumDataCodewords(l,c){return Math.floor(L.getNumRawDataModules(l)/8)-L.ECC_CODEWORDS_PER_BLOCK[c.ordinal][l]*L.NUM_ERROR_CORRECTION_BLOCKS[c.ordinal][l]}static reedSolomonComputeDivisor(l){if(l<1||l>255)throw new RangeError("Degree out of range");let c=[];for(let h=0;h<l-1;h++)c.push(0);c.push(1);let u=1;for(let h=0;h<l;h++){for(let g=0;g<c.length;g++)c[g]=L.reedSolomonMultiply(c[g],u),g+1<c.length&&(c[g]^=c[g+1]);u=L.reedSolomonMultiply(u,2)}return c}static reedSolomonComputeRemainder(l,c){let u=c.map(h=>0);for(const h of l){const g=h^u.shift();u.push(0),c.forEach((m,x)=>u[x]^=L.reedSolomonMultiply(m,g))}return u}static reedSolomonMultiply(l,c){if(l>>>8||c>>>8)throw new RangeError("Byte out of range");let u=0;for(let h=7;h>=0;h--)u=u<<1^(u>>>7)*285,u^=(c>>>h&1)*l;return a(u>>>8==0),u}finderPenaltyCountPatterns(l){const c=l[1];a(c<=this.size*3);const u=c>0&&l[2]==c&&l[3]==c*3&&l[4]==c&&l[5]==c;return(u&&l[0]>=c*4&&l[6]>=c?1:0)+(u&&l[6]>=c*4&&l[0]>=c?1:0)}finderPenaltyTerminateAndCount(l,c,u){return l&&(this.finderPenaltyAddHistory(c,u),c=0),c+=this.size,this.finderPenaltyAddHistory(c,u),this.finderPenaltyCountPatterns(u)}finderPenaltyAddHistory(l,c){c[0]==0&&(l+=this.size),c.pop(),c.unshift(l)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],n.QrCode=e;function s(d,l,c){if(l<0||l>31||d>>>l)throw new RangeError("Value out of range");for(let u=l-1;u>=0;u--)c.push(d>>>u&1)}function r(d,l){return(d>>>l&1)!=0}function a(d){if(!d)throw new Error("Assertion error")}const i=class H{constructor(l,c,u){if(this.mode=l,this.numChars=c,this.bitData=u,c<0)throw new RangeError("Invalid argument");this.bitData=u.slice()}static makeBytes(l){let c=[];for(const u of l)s(u,8,c);return new H(H.Mode.BYTE,l.length,c)}static makeNumeric(l){if(!H.isNumeric(l))throw new RangeError("String contains non-numeric characters");let c=[];for(let u=0;u<l.length;){const h=Math.min(l.length-u,3);s(parseInt(l.substring(u,u+h),10),h*3+1,c),u+=h}return new H(H.Mode.NUMERIC,l.length,c)}static makeAlphanumeric(l){if(!H.isAlphanumeric(l))throw new RangeError("String contains unencodable characters in alphanumeric mode");let c=[],u;for(u=0;u+2<=l.length;u+=2){let h=H.ALPHANUMERIC_CHARSET.indexOf(l.charAt(u))*45;h+=H.ALPHANUMERIC_CHARSET.indexOf(l.charAt(u+1)),s(h,11,c)}return u<l.length&&s(H.ALPHANUMERIC_CHARSET.indexOf(l.charAt(u)),6,c),new H(H.Mode.ALPHANUMERIC,l.length,c)}static makeSegments(l){return l==""?[]:H.isNumeric(l)?[H.makeNumeric(l)]:H.isAlphanumeric(l)?[H.makeAlphanumeric(l)]:[H.makeBytes(H.toUtf8ByteArray(l))]}static makeEci(l){let c=[];if(l<0)throw new RangeError("ECI assignment value out of range");if(l<128)s(l,8,c);else if(l<16384)s(2,2,c),s(l,14,c);else if(l<1e6)s(6,3,c),s(l,21,c);else throw new RangeError("ECI assignment value out of range");return new H(H.Mode.ECI,0,c)}static isNumeric(l){return H.NUMERIC_REGEX.test(l)}static isAlphanumeric(l){return H.ALPHANUMERIC_REGEX.test(l)}getData(){return this.bitData.slice()}static getTotalBits(l,c){let u=0;for(const h of l){const g=h.mode.numCharCountBits(c);if(h.numChars>=1<<g)return 1/0;u+=4+g+h.bitData.length}return u}static toUtf8ByteArray(l){l=encodeURI(l);let c=[];for(let u=0;u<l.length;u++)l.charAt(u)!="%"?c.push(l.charCodeAt(u)):(c.push(parseInt(l.substring(u+1,u+3),16)),u+=2);return c}};i.NUMERIC_REGEX=/^[0-9]*$/,i.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,i.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=i;n.QrSegment=i})(we||(we={}));(n=>{(e=>{const s=class{constructor(a,i){this.ordinal=a,this.formatBits=i}};s.LOW=new s(0,1),s.MEDIUM=new s(1,0),s.QUARTILE=new s(2,3),s.HIGH=new s(3,2),e.Ecc=s})(n.QrCode||(n.QrCode={}))})(we||(we={}));(n=>{(e=>{const s=class{constructor(a,i){this.modeBits=a,this.numBitsCharCount=i}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};s.NUMERIC=new s(1,[10,12,14]),s.ALPHANUMERIC=new s(2,[9,11,13]),s.BYTE=new s(4,[8,16,16]),s.KANJI=new s(8,[8,10,12]),s.ECI=new s(7,[0,0,0]),e.Mode=s})(n.QrSegment||(n.QrSegment={}))})(we||(we={}));var Oe=we;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var wa={L:Oe.QrCode.Ecc.LOW,M:Oe.QrCode.Ecc.MEDIUM,Q:Oe.QrCode.Ecc.QUARTILE,H:Oe.QrCode.Ecc.HIGH},br=128,yr="L",vr="#FFFFFF",wr="#000000",jr=!1,_r=1,ja=4,_a=0,Na=.1;function Nr(n,e=0){const s=[];return n.forEach(function(r,a){let i=null;r.forEach(function(o,d){if(!o&&i!==null){s.push(`M${i+e} ${a+e}h${d-i}v1H${i+e}z`),i=null;return}if(d===r.length-1){if(!o)return;i===null?s.push(`M${d+e},${a+e} h1v1H${d+e}z`):s.push(`M${i+e},${a+e} h${d+1-i}v1H${i+e}z`);return}o&&i===null&&(i=d)})}),s.join("")}function Sr(n,e){return n.slice().map((s,r)=>r<e.y||r>=e.y+e.h?s:s.map((a,i)=>i<e.x||i>=e.x+e.w?a:!1))}function Sa(n,e,s,r){if(r==null)return null;const a=n.length+s*2,i=Math.floor(e*Na),o=a/e,d=(r.width||i)*o,l=(r.height||i)*o,c=r.x==null?n.length/2-d/2:r.x*o,u=r.y==null?n.length/2-l/2:r.y*o,h=r.opacity==null?1:r.opacity;let g=null;if(r.excavate){let x=Math.floor(c),b=Math.floor(u),p=Math.ceil(d+c-x),y=Math.ceil(l+u-b);g={x,y:b,w:p,h:y}}const m=r.crossOrigin;return{x:c,y:u,h:l,w:d,excavation:g,opacity:h,crossOrigin:m}}function ka(n,e){return e!=null?Math.max(Math.floor(e),0):n?ja:_a}function kr({value:n,level:e,minVersion:s,includeMargin:r,marginSize:a,imageSettings:i,size:o,boostLevel:d}){let l=U.useMemo(()=>{const x=(Array.isArray(n)?n:[n]).reduce((b,p)=>(b.push(...Oe.QrSegment.makeSegments(p)),b),[]);return Oe.QrCode.encodeSegments(x,wa[e],s,void 0,void 0,d)},[n,e,s,d]);const{cells:c,margin:u,numCells:h,calculatedImageSettings:g}=U.useMemo(()=>{let m=l.getModules();const x=ka(r,a),b=m.length+x*2,p=Sa(m,o,x,i);return{cells:m,margin:x,numCells:b,calculatedImageSettings:p}},[l,o,i,r,a]);return{qrcode:l,margin:u,cells:c,numCells:h,calculatedImageSettings:g}}var Ea=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Ca=U.forwardRef(function(e,s){const r=e,{value:a,size:i=br,level:o=yr,bgColor:d=vr,fgColor:l=wr,includeMargin:c=jr,minVersion:u=_r,boostLevel:h,marginSize:g,imageSettings:m}=r,b=zt(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:p}=b,y=zt(b,["style"]),C=m==null?void 0:m.src,N=U.useRef(null),S=U.useRef(null),j=U.useCallback(v=>{N.current=v,typeof s=="function"?s(v):s&&(s.current=v)},[s]),[w,T]=U.useState(!1),{margin:I,cells:W,numCells:q,calculatedImageSettings:K}=kr({value:a,level:o,minVersion:u,boostLevel:h,includeMargin:c,marginSize:g,imageSettings:m,size:i});U.useEffect(()=>{if(N.current!=null){const v=N.current,E=v.getContext("2d");if(!E)return;let P=W;const R=S.current,Z=K!=null&&R!==null&&R.complete&&R.naturalHeight!==0&&R.naturalWidth!==0;Z&&K.excavation!=null&&(P=Sr(W,K.excavation));const le=window.devicePixelRatio||1;v.height=v.width=i*le;const ge=i/q*le;E.scale(ge,ge),E.fillStyle=d,E.fillRect(0,0,q,q),E.fillStyle=l,Ea?E.fill(new Path2D(Nr(P,I))):W.forEach(function(et,tt){et.forEach(function(Zr,Xr){Zr&&E.fillRect(Xr+I,tt+I,1,1)})}),K&&(E.globalAlpha=K.opacity),Z&&E.drawImage(R,K.x+I,K.y+I,K.w,K.h)}}),U.useEffect(()=>{T(!1)},[C]);const f=qt({height:i,width:i},p);let _=null;return C!=null&&(_=U.createElement("img",{src:C,key:C,style:{display:"none"},onLoad:()=>{T(!0)},ref:S,crossOrigin:K==null?void 0:K.crossOrigin})),U.createElement(U.Fragment,null,U.createElement("canvas",qt({style:f,height:i,width:i,ref:j,role:"img"},y)),_)});Ca.displayName="QRCodeCanvas";var Er=U.forwardRef(function(e,s){const r=e,{value:a,size:i=br,level:o=yr,bgColor:d=vr,fgColor:l=wr,includeMargin:c=jr,minVersion:u=_r,boostLevel:h,title:g,marginSize:m,imageSettings:x}=r,b=zt(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:p,cells:y,numCells:C,calculatedImageSettings:N}=kr({value:a,level:o,minVersion:u,boostLevel:h,includeMargin:c,marginSize:m,imageSettings:x,size:i});let S=y,j=null;x!=null&&N!=null&&(N.excavation!=null&&(S=Sr(y,N.excavation)),j=U.createElement("image",{href:x.src,height:N.h,width:N.w,x:N.x+p,y:N.y+p,preserveAspectRatio:"none",opacity:N.opacity,crossOrigin:N.crossOrigin}));const w=Nr(S,p);return U.createElement("svg",qt({height:i,width:i,viewBox:`0 0 ${C} ${C}`,ref:s,role:"img"},b),!!g&&U.createElement("title",null,g),U.createElement("path",{fill:d,d:`M0,0 h${C}v${C}H0z`,shapeRendering:"crispEdges"}),U.createElement("path",{fill:l,d:w,shapeRendering:"crispEdges"}),j)});Er.displayName="QRCodeSVG";const Cr=()=>t.jsx("footer",{className:"bg-slate-900 text-white",children:t.jsxs("div",{className:"container mx-auto px-4 py-12",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-8",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx("img",{src:"/logo.png",alt:"ConsultingG Logo",className:"w-12 h-12 rounded-xl shadow-lg object-contain"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold",children:"ConsultingG"}),t.jsx("p",{className:"text-blue-200 text-sm",children:"Real Estate"})]})]}),t.jsx("p",{className:"text-gray-300 mb-4 leading-relaxed text-sm",children:"Водещата компания за недвижими имоти в България с над 15 години опит и хиляди доволни клиенти."})]}),t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"relative",children:t.jsxs("div",{className:"w-48 h-48 rounded-full overflow-hidden shadow-2xl border-4 border-white bg-gradient-to-br from-blue-100 to-purple-100 p-1 transform hover:scale-105 transition-transform duration-300 relative",children:[t.jsx("div",{className:"absolute inset-0 rounded-full shadow-[0_8px_32px_rgba(0,0,0,0.3),0_16px_64px_rgba(0,0,0,0.2),inset_0_2px_4px_rgba(255,255,255,0.8),inset_0_-2px_4px_rgba(0,0,0,0.1)]"}),t.jsx("div",{className:"absolute top-2 left-1/2 transform -translate-x-1/2 w-16 h-8 bg-gradient-to-b from-white/40 to-transparent rounded-full blur-sm"}),t.jsx("img",{src:"/images/georgiev.jpg",alt:"Георги Георгиев",className:"w-full h-full rounded-full object-cover relative z-10"})]})})}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-bold mb-6",children:"Контакти"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ve,{className:"w-5 h-5 text-blue-400"}),t.jsx("span",{className:"text-gray-300 text-sm",children:"бул. Янко Съкъзов 16, София, България"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(dt,{className:"w-5 h-5 text-blue-400"}),t.jsx("a",{href:"tel:0888825445",className:"text-gray-300 text-sm hover:text-blue-400 transition-colors",children:"0888825445"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ut,{className:"w-5 h-5 text-blue-400"}),t.jsx("a",{href:"mailto:office@consultingg.com?subject=Запитване за недвижим имот&body=Здравейте,%0D%0A%0D%0AИмам въпрос относно:",className:"text-gray-300 text-sm hover:text-blue-400 transition-colors",children:"office@consultingg.com"})]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium mb-4 text-center",children:"Сканирайте за контакт"}),t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"bg-white p-3 rounded-lg",children:t.jsx(Er,{value:`BEGIN:VCARD
VERSION:3.0
N:Георгиев;Георги;;;
FN:ConsultingG Real Estate
ORG:ConsultingG Real Estate
TEL;TYPE=CELL:+35988882445
EMAIL:office@consultingg.com
ADR;TYPE=WORK:;;бул. Янко Съкъзов 16;София;;1504;България
END:VCARD`,size:120,level:"M",includeMargin:!1})})})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-bold mb-6",children:"Последвайте ни"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("a",{href:"https://www.facebook.com/search/top/?q=consultingg%20real%20estate",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-white/10 rounded-lg flex items-center justify-center hover:bg-blue-600 transition-colors",children:t.jsx(un,{className:"w-5 h-5"})}),t.jsx("a",{href:"https://www.instagram.com/consultinggrealestate?igsh=MThvazF6OHI5YnVuOA%3D%3D",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-white/10 rounded-lg flex items-center justify-center hover:bg-pink-600 transition-colors",children:t.jsx(hn,{className:"w-5 h-5"})})]})]})]}),t.jsxs("div",{className:"relative mt-8 pt-8 text-center",children:[t.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-gray-600 to-transparent shadow-lg"}),t.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-gray-500 to-transparent shadow-2xl blur-sm"}),t.jsx("p",{className:"text-gray-400 text-sm",children:"© 2024 ConsultingG Real Estate. Всички права запазени."})]})]})}),Ta=()=>{const[n,e]=k.useState([]),[s,r]=k.useState(!0),[a,i]=k.useState(null),[o,d]=k.useState({}),[l,c]=k.useState(!1),[u,h]=k.useState({}),[g,m]=kn(),[x,b]=k.useState(1),p=16;k.useEffect(()=>{const S=g.get("page"),j=S?parseInt(S):1;b(j);const w=new URLSearchParams(g.toString()),T={};w.forEach((I,W)=>{T[W]=I}),h(T),y(T,j)},[]);const y=async(S,j=1)=>{r(!0),i(null);try{const w=await O.getProperties(S,j,p);w.success&&w.data?(e(w.data),d(w.meta||{})):(e([]),i(w.error||"Грешка при зареждане на имотите"))}catch(w){console.error("Error fetching properties:",w),e([]),i("Грешка при зареждане на имотите")}finally{r(!1)}},C=S=>{h(S||{}),y(S,1),b(1);const j=new URLSearchParams(S);j.set("page","1"),m(j)},N=S=>{b(S),y(u,S);const j=new URLSearchParams(u);j.set("page",S.toString()),m(j)};return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsxs(Qe,{children:[t.jsx("title",{children:"Имоти за продажба и наем в България - ConsultingG Real Estate"}),t.jsx("meta",{name:"description",content:"Разгледайте всички налични имоти за продажба и наем в България. Апартаменти, къщи, офиси и други недвижими имоти от ConsultingG Real Estate."}),t.jsx("meta",{name:"keywords",content:"имоти продажба, имоти наем, апартаменти софия, къщи продажба, недвижими имоти българия"}),t.jsx("link",{rel:"canonical",href:"https://consultingg.com/properties"}),t.jsx("meta",{property:"og:title",content:"Имоти за продажба и наем в България - ConsultingG Real Estate"}),t.jsx("meta",{property:"og:description",content:"Разгледайте всички налични имоти за продажба и наем в България"}),t.jsx("meta",{property:"og:url",content:"https://consultingg.com/properties"}),t.jsx("meta",{property:"og:type",content:"website"})]}),t.jsxs("header",{className:"relative z-10 bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800",children:[t.jsx("div",{className:"absolute inset-0 opacity-10",children:t.jsx("div",{className:`absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.1"%3E%3Ccircle cx="30" cy="30" r="2"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')]`})}),t.jsx("div",{className:"absolute top-10 left-10 w-20 h-20 bg-blue-500/10 rounded-full blur-xl animate-pulse"}),t.jsx("div",{className:"absolute top-20 right-20 w-16 h-16 bg-purple-500/10 rounded-full blur-xl animate-pulse delay-1000"}),t.jsxs("div",{className:"container mx-auto px-4 py-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs(B,{to:"/",className:"flex items-center gap-3 hover:opacity-80 transition-opacity",children:[t.jsx("img",{src:"/logo.png",alt:"ConsultingG Logo",className:"w-24 h-24 rounded-xl shadow-lg object-contain"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-white",children:"ConsultingG"}),t.jsx("p",{className:"text-blue-200 text-sm",children:"Real Estate"})]})]}),t.jsx(Je,{})]}),t.jsxs("div",{className:"text-center pb-16",children:[t.jsxs("h1",{className:"text-5xl md:text-6xl font-bold text-white mb-4 leading-tight",children:["Всички",t.jsx("span",{className:"block bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"имоти"})]}),t.jsx("p",{className:"text-xl text-blue-200",children:"Открийте перфектния имот за вас"})]})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0",children:t.jsx("svg",{viewBox:"0 0 1200 120",fill:"none",className:"w-full h-20",children:t.jsx("path",{d:"M0,60 C300,120 900,0 1200,60 L1200,120 L0,120 Z",fill:"white",fillOpacity:"0.1"})})})]}),t.jsxs("div",{className:"container mx-auto px-4 py-12",children:[t.jsxs("div",{className:"mb-12",children:[t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsxs("button",{onClick:()=>c(!l),className:"md:hidden flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg shadow-lg hover:bg-blue-700 transition-colors",children:[t.jsx(Ys,{className:"w-4 h-4"}),l?"Скрий филтрите":"Покажи филтрите"]})}),t.jsx("div",{className:`${l?"block":"hidden"} md:block`,children:t.jsx(mr,{onSearch:C})})]}),s?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 mb-12",children:[...Array(8)].map((S,j)=>t.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden animate-pulse border border-gray-100",children:[t.jsx("div",{className:"h-48 bg-gray-200"}),t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),t.jsx("div",{className:"h-6 bg-gray-200 rounded mb-3"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded mb-4"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded flex-1"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded flex-1"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded flex-1"})]})]})]},j))}):n.length===0?t.jsxs("div",{className:"text-center py-16 bg-white rounded-2xl shadow-lg border border-gray-100 mb-12",children:[t.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:t.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H9m0 0H5m0 0h2M7 7h10M7 11h6m-6 4h6"})})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Няма намерени имоти"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Няма имоти, които отговарят на зададените критерии."}),t.jsx("button",{onClick:()=>fetchProperties(),className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:"Покажи всички имоти"})]}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 mb-12",children:n.map(S=>{var j,w,T,I;return t.jsxs(B,{to:`/properties/${S.id}`,className:`bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden group cursor-pointer transform hover:-translate-y-2 border border-gray-100 ${S.transaction_type==="rent"?"ring-2 ring-sky-200 bg-gradient-to-br from-white to-sky-50 hover:border-sky-300":"hover:border-blue-200"}`,children:[t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:((w=(j=S.images)==null?void 0:j[0])==null?void 0:w.url)||((I=(T=S.images)==null?void 0:T[0])==null?void 0:I.image_url)||"/images/1_kachta_simeonovo.jpg",alt:S.title,className:"w-full h-48 object-cover group-hover:scale-110 transition-transform duration-500",onError:W=>{const q=W.target;q.src="/images/1_kachta_simeonovo.jpg"}}),t.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-2",children:[S.transaction_type==="rent"&&t.jsxs("div",{className:"bg-gradient-to-r from-sky-500 to-sky-600 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"Под наем"]}),S.featured&&t.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg",children:"Препоръчан"})]}),t.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:t.jsx("button",{className:"w-8 h-8 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center text-gray-700 hover:bg-white hover:text-blue-600 transition-all duration-200 shadow-lg",children:t.jsx(ye,{className:"w-4 h-4"})})})]}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-2",children:[t.jsx(ve,{className:"w-4 h-4"}),t.jsxs("span",{className:"text-sm font-medium",children:[S.district?`${S.district}, `:"",S.city_region||"Всички области"]})]}),t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-3 line-clamp-2",children:S.title}),t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["€",Math.floor(S.price||0).toLocaleString(),S.transaction_type==="rent"&&t.jsx("span",{className:"text-sm text-sky-600 font-medium",children:"/месец"})]})}),t.jsxs("div",{className:"flex items-center gap-4 text-gray-600",children:[S.bedrooms>0&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(ns,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:S.bedrooms})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(as,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:S.bathrooms||0})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(is,{className:"w-4 h-4"}),t.jsxs("span",{className:"text-sm",children:[S.area||0," м²"]})]})]})]})]},S.id)})}),n.length>0&&o.pages>1&&t.jsx("div",{className:"flex justify-center bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>N(o.page-1),disabled:!o.hasPrev,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Предишна"}),Array.from({length:o.pages},(S,j)=>j+1).map(S=>t.jsx("button",{onClick:()=>N(S),className:`px-4 py-2 rounded-lg ${S===o.page?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors"}`,children:S},S)),t.jsx("button",{onClick:()=>N(o.page+1),disabled:!o.hasNext,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Следваща"})]})})]})]})},Pa=()=>t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsxs(Qe,{children:[t.jsx("title",{children:"Контакти - ConsultingG Real Estate"}),t.jsx("meta",{name:"description",content:"Свържете се с ConsultingG Real Estate - телефон 0888825445, имейл office@consultingg.com, адрес бул. Янко Съкъзов 16, София. Професионални консултации за недвижими имоти."}),t.jsx("meta",{name:"keywords",content:"контакти консултинг, недвижими имоти софия, телефон брокер, имейл консултации, офис адрес"}),t.jsx("link",{rel:"canonical",href:"https://consultingg.com/contact"}),t.jsx("script",{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org","@type":"LocalBusiness","@id":"https://consultingg.com/#organization",name:"ConsultingG Real Estate",description:"Водещата компания за недвижими имоти в България",url:"https://consultingg.com",telephone:"+359888825445",email:"office@consultingg.com",address:{"@type":"PostalAddress",streetAddress:"бул. Янко Съкъзов 16",addressLocality:"София",postalCode:"1504",addressCountry:"BG"},geo:{"@type":"GeoCoordinates",latitude:"42.6977",longitude:"23.3219"},openingHours:["Mo-Fr 09:00-18:00","Sa 10:00-16:00"],priceRange:"€€€",image:"https://consultingg.com/logo.png",logo:"https://consultingg.com/logo.png",sameAs:["https://www.facebook.com/consultingg","https://www.instagram.com/consultingg"]})})]}),t.jsxs("header",{className:"relative z-10 bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800",children:[t.jsx("div",{className:"absolute inset-0 opacity-10",children:t.jsx("div",{className:`absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.1"%3E%3Ccircle cx="30" cy="30" r="2"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')]`})}),t.jsx("div",{className:"absolute top-10 left-10 w-20 h-20 bg-blue-500/10 rounded-full blur-xl animate-pulse"}),t.jsx("div",{className:"absolute top-20 right-20 w-16 h-16 bg-purple-500/10 rounded-full blur-xl animate-pulse delay-1000"}),t.jsxs("div",{className:"container mx-auto px-4 py-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs(B,{to:"/",className:"flex items-center gap-3 hover:opacity-80 transition-opacity",children:[t.jsx("img",{src:"/logo.png",alt:"ConsultingG Logo",className:"w-24 h-24 rounded-xl shadow-lg object-contain"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-white",children:"ConsultingG"}),t.jsx("p",{className:"text-blue-200 text-sm",children:"Real Estate"})]})]}),t.jsx(Je,{})]}),t.jsxs("div",{className:"text-center pb-16",children:[t.jsxs("h1",{className:"text-5xl md:text-6xl font-bold text-white mb-4 leading-tight",children:["Свържете се",t.jsx("span",{className:"block bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"с нас"})]}),t.jsx("p",{className:"text-xl text-blue-200",children:"Нашият екип е на ваше разположение"})]})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0",children:t.jsx("svg",{viewBox:"0 0 1200 120",fill:"none",className:"w-full h-20",children:t.jsx("path",{d:"M0,60 C300,120 900,0 1200,60 L1200,120 L0,120 Z",fill:"white",fillOpacity:"0.1"})})})]}),t.jsx("div",{className:"container mx-auto px-4 py-12",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-8 text-center",children:"Контактна информация"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-6 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center",children:t.jsx(dt,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:"Телефон"}),t.jsx("a",{href:"tel:0888825445",className:"text-blue-600 font-medium hover:text-blue-700 transition-colors",children:"0888 825 445"})]})]})}),t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-6 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center",children:t.jsx(ut,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:"Имейл"}),t.jsx("a",{href:"mailto:office@consultingg.com",className:"text-green-600 font-medium hover:text-green-700 transition-colors",children:"office@consultingg.com"})]})]})}),t.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-2xl p-6 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-purple-500 rounded-xl flex items-center justify-center",children:t.jsx(ve,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:"Адрес"}),t.jsxs("div",{className:"text-purple-600 font-medium",children:[t.jsx("div",{children:"бул. Янко Съкъзов 16"}),t.jsx("div",{children:"София 1504, България"})]})]})]})}),t.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-2xl p-6 hover:shadow-lg transition-shadow",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-xl flex items-center justify-center",children:t.jsx(gn,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:"Работно време"}),t.jsxs("div",{className:"text-orange-600 font-medium",children:[t.jsx("div",{children:"Пон-Пет: 09:00-18:00"}),t.jsx("div",{children:"Събота: 10:00-16:00"})]})]})]})})]})]}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-8 text-center",children:"Намерете ни"}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[t.jsx("div",{className:"h-96 bg-gray-100 flex items-center justify-center",children:t.jsx("iframe",{src:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2932.8!2d23.3219!3d42.6977!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x40aa8682cb317bf5%3A0x400a01269bf5e60!2z0LHRg9C7LiDQr9C90LrQviDQodGK0LrRitC30L7QsiAxNiwgMTUwNCDQodC-0YTQuNGPLCDQkdGK0LvQs9Cw0YDQuNGP!5e0!3m2!1sen!2sbg!4v1640995200000!5m2!1sen!2sbg",width:"100%",height:"100%",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",title:"ConsultingG Real Estate Office Location"})}),t.jsxs("div",{className:"p-6",children:[t.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:"София"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"бул. Янко Съкъзов 16, София 1504, България"})]})]})]})]})})]}),ks=()=>{const{id:n}=De(),[e,s]=k.useState(null),[r,a]=k.useState(!0),[i,o]=k.useState(null),[d,l]=k.useState(0);if(k.useEffect(()=>{(async()=>{if(n)try{a(!0),console.log("PropertyDetail: Fetching property",n);const g=await O.getProperty(n);console.log("PropertyDetail: API result",g),g.success&&g.data?(console.log("PropertyDetail: Images received",g.data.images),s(g.data)):o(g.error||"Грешка при зареждане на имота")}catch(g){o("Грешка при зареждане на имота"),console.error("Error fetching property:",g)}finally{a(!1)}})()},[n]),r)return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),t.jsx("p",{className:"text-white",children:"Зареждане..."})]})});if(i||!e)return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-red-400 mb-4",children:i||"Имотът не е намерен"}),t.jsx(B,{to:"/properties",className:"text-blue-400 hover:underline",children:"Обратно към имотите"})]})});const c=e.images||[];console.log("PropertyDetail: Final images array",c);const u=c[d];return console.log("PropertyDetail: Current image",u),t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800",children:[t.jsxs(Qe,{children:[t.jsxs("title",{children:[e.title," - ConsultingG Real Estate"]}),t.jsx("meta",{name:"description",content:e.description||`${e.title} - ${e.city_region}, ${e.area}м², €${Math.floor(e.price).toLocaleString()}`}),t.jsx("link",{rel:"canonical",href:`https://consultingg.com/properties/${e.id}`})]}),t.jsx("header",{className:"relative z-10 p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(B,{to:"/properties",className:"flex items-center text-white hover:text-blue-200 transition-colors",children:[t.jsx(Ve,{className:"w-5 h-5 mr-2"}),"Назад към търсенето"]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsxs(B,{to:"/",className:"flex items-center gap-3 hover:opacity-80 transition-opacity",children:[t.jsx("img",{src:"/logo.png",alt:"ConsultingG Logo",className:"w-16 h-16 rounded-full object-contain border-4 border-white/20"}),t.jsxs("div",{className:"text-white",children:[t.jsx("h1",{className:"text-xl font-bold",children:"ConsultingG"}),t.jsx("p",{className:"text-sm text-blue-200",children:"Real Estate"})]})]})})]})}),t.jsx("div",{className:"container mx-auto px-6 py-8",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[t.jsx("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"aspect-video bg-gray-200 relative",children:[u?t.jsx("img",{src:u.url||u.image_url,alt:u.alt_text||e.title,className:"w-full h-full object-cover",onError:h=>{const g=h.target;g.src="/images/placeholder.jpg"}}):t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx("div",{className:"w-16 h-16 text-gray-400"})}),e.featured&&t.jsx("div",{className:"absolute top-4 left-4",children:t.jsx("div",{className:"bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-medium shadow-lg",children:"Препоръчан"})})]}),c.length>1&&t.jsx("div",{className:"p-4 bg-gray-50",children:t.jsx("div",{className:"flex gap-3 overflow-x-auto scrollbar-hide",children:c.map((h,g)=>t.jsx("button",{onClick:()=>l(g),className:`relative flex-shrink-0 w-20 h-16 rounded-lg overflow-hidden border-2 transition-all ${g===d?"border-blue-500 scale-105":"border-gray-200 hover:border-gray-300"}`,children:t.jsx("img",{src:h.url||h.image_url,alt:h.alt_text||`Снимка ${g+1}`,className:"w-full h-full object-cover",onError:m=>{const x=m.target;x.src="/images/placeholder.jpg"}})},h.id))})})]})}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8",children:[t.jsxs("div",{className:"flex items-center text-blue-600 mb-4",children:[t.jsx(ve,{className:"w-5 h-5 mr-2"}),t.jsxs("span",{className:"text-lg font-medium",children:[e.district?`${e.district}, `:"",e.city_region]})]}),t.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-6",children:e.title}),t.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-8",children:e.pricing_mode==="per_sqm"?t.jsxs(t.Fragment,{children:["€",Math.floor(e.price).toLocaleString(),t.jsx("span",{className:"text-lg text-gray-600 font-normal",children:"/м²"})]}):t.jsxs(t.Fragment,{children:["€",Math.floor(e.price).toLocaleString(),e.transaction_type==="rent"&&t.jsx("span",{className:"text-lg text-gray-600 font-normal",children:"/месец"})]})}),t.jsxs("div",{className:"grid grid-cols-4 gap-8 mb-8",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:t.jsx(is,{className:"w-6 h-6 text-blue-600"})}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:e.area}),t.jsx("div",{className:"text-sm text-gray-600",children:"м²"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:t.jsx(ns,{className:"w-6 h-6 text-blue-600"})}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:e.bedrooms||0}),t.jsx("div",{className:"text-sm text-gray-600",children:"спални"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:t.jsx(as,{className:"w-6 h-6 text-blue-600"})}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:e.bathrooms||0}),t.jsx("div",{className:"text-sm text-gray-600",children:"бани"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:t.jsx(mn,{className:"w-6 h-6 text-blue-600"})}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:e.year_built||2023}),t.jsx("div",{className:"text-sm text-gray-600",children:"година"})]})]}),e.description&&t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Описание"}),e.id==="prop-001"?t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"text-center bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl border border-blue-100",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"✨ Модерна самостоятелна къща с просторен двор и панорамни гледки в Симеоново"}),t.jsx("p",{className:"text-gray-700 leading-relaxed",children:"Представяме Ви елегантен дом, съчетаващ модерна архитектура, функционално разпределение и просторна градина в един от най-престижните райони на София – кв. Симеоново, ул. Крайречна, в непосредствена близост до Симеоновско шосе."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🏡 Основни характеристики"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• Разрешение за ползване (Акт 16) – ",t.jsx("strong",{children:"2023 г."})]}),t.jsxs("li",{children:["• РЗП къща: ",t.jsx("strong",{children:"400 кв.м"})]}),t.jsxs("li",{children:["• Двор: ",t.jsx("strong",{children:"1200 кв.м"})," с възможност за изграждане на зони за отдих и зеленина"]}),t.jsx("li",{children:"• Отопление: газова инсталация"})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"📐 Разпределение"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• ",t.jsx("strong",{children:"I ниво:"})," просторна и светла всекидневна, кабинет, мокро помещение и тоалетна"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"II ниво:"})," три самостоятелни спални, всяка с лична баня и дрешник, както и три тераси с впечатляващи гледки към града и планината"]})]}),t.jsx("p",{className:"text-gray-700 mt-4 italic",children:"Имотът се предлага на шпакловка и замазка, което Ви дава свободата да реализирате своя личен стил и интериорни идеи."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🌿 Предимства"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsx("li",{children:"• Отлична локация в престижен и тих район"}),t.jsx("li",{children:"• Просторен двор, подходящ за градина, басейн или детска площадка"}),t.jsx("li",{children:"• Уникални панорамни гледки, осигуряващи усещане за свобода и уединение"})]})]})]}):e.id==="prop-002"?t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"text-center bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl border border-blue-100",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"✨ Модерна самостоятелна къща с двор и панорамни гледки в Драгалевци"}),t.jsx("p",{className:"text-gray-700 leading-relaxed",children:"На тиха улица Пчелица, в близост до Киноцентъра. Имотът е с разрешение за ползване (Акт 16 / 2023 г.) и предлага съчетание от простор, комфорт и прекрасни гледки към София и планината."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🏡 Основни характеристики"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• РЗП къща: ",t.jsx("strong",{children:"460 кв.м"})]}),t.jsxs("li",{children:["• Двор: ",t.jsx("strong",{children:"420 кв.м"})]}),t.jsxs("li",{children:["• Етажи: ",t.jsx("strong",{children:"3"})]}),t.jsxs("li",{children:["• Разрешение за ползване: ",t.jsx("strong",{children:"Акт 16 / 2023 г."})]}),t.jsxs("li",{children:["• Състояние: ",t.jsx("strong",{children:"завършена до ключ"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"📐 Разпределение"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• ",t.jsx("strong",{children:"I ниво:"})," всекидневна, кухня, дрешник и тоалетна"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"II ниво:"})," три спални със самостоятелни бани"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"III ниво:"})," всекидневна, кухненски бокс, спалня, баня с тоалетна, камина"]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🌿 Предимства"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsx("li",{children:"• Подови настилки: гранитогрес и ламинат"}),t.jsx("li",{children:"• Отопление на ток с климатици и камина"}),t.jsx("li",{children:"• Просторен и функционален имот, готов за обитаване"}),t.jsx("li",{children:"• Прекрасни панорамни гледки"}),t.jsx("li",{children:"• Престижна и спокойна локация в подножието на планината"})]})]})]}):e.id==="prop-005"?t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"text-center bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl border border-blue-100",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"✨ Слънчев четиристаен апартамент в Оборище"}),t.jsx("p",{className:"text-gray-700 leading-relaxed",children:'В непосредствена близост до Малък Градски театър, парк „Заимов", метростанция Театрална и спирки на градски транспорт. Имотът предлага чудесна панорамна гледка към Витоша и храм-паметник „Св. Александър Невски".'})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🏡 Основни характеристики"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• Тип имот: ",t.jsx("strong",{children:"Апартамент, 4-стаен"})]}),t.jsxs("li",{children:["• Етаж: ",t.jsx("strong",{children:"7 от 8"})]}),t.jsxs("li",{children:["• Изложение: ",t.jsx("strong",{children:"Юг / Изток / Запад"})]}),t.jsxs("li",{children:["• Настилка: ",t.jsx("strong",{children:"паркет"})]}),t.jsxs("li",{children:["• Отопление: ",t.jsx("strong",{children:"ТЕЦ или климатици на ток"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"📐 Разпределение"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Всекидневна"})," с кухненски бокс"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Три самостоятелни спални"})]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Две бани"})," с тоалетни"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Отделна тоалетна"})," за гости"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Три тераси"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🌿 Предимства"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsx("li",{children:"• Напълно оборудвано жилище, готово за обитаване"}),t.jsx("li",{children:'• Панорамни гледки към Витоша и „Ал. Невски"'}),t.jsx("li",{children:"• Възможност за наемане на паркомясто или гараж"}),t.jsx("li",{children:"• Отлична локация – близо до парк, метро и градски транспорт"})]})]})]}):e.id==="prop-004"?t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"text-center bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl border border-blue-100",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:'✨ Офис площи / Обект "Метличина поляна 15", кв. Гоце Делчев ✨'}),t.jsx("p",{className:"text-gray-700 leading-relaxed",children:"Този имот предлага функционални офис пространства, разположени в добре позиционирана реновирана сграда с отлична достъпност и силна локация."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🏢 Основни характеристики"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• Обект: ",t.jsx("strong",{children:"самостоятелен офис в сграда с монолитна стоманобетонова конструкция"})]}),t.jsxs("li",{children:["• Разрешение за ползване: ",t.jsx("strong",{children:"Акт 16 / 2024 г. (очакван)"})]}),t.jsxs("li",{children:["• Площ: ",t.jsx("strong",{children:"≈ 1 117.58 кв.м общо по документи"})]}),t.jsxs("li",{children:["• Нива: ",t.jsx("strong",{children:"две нива (партер и първи етаж)"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"📐 Разпределение / помещения"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Партер:"})," портиерна, фоайе и приемна, 16 самостоятелни работни стаи, санитарен възел"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Етаж 2:"})," 21 самостоятелни работни стаи, санитарен възел"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Паркинг:"})," възможност за паркоместа в подземния гараж на сградата"]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🌍 Локация и удобства"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsx("li",{children:"• Квартал Гоце Делчев — граничен с бул. България, бул. Гоце Делчев, и кварталите Стрелбище, Борово и Манастирски ливади"}),t.jsx("li",{children:'• Ул. „Метличина поляна" е тихa и спокойна, близо до ул. Костенски Водопад и Южния парк'}),t.jsx("li",{children:"• Район с добре развита инфраструктура — услуги, транспортни връзки, зелени площи, удобства около сградата – парк / междублоково пространство"})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"⚙️ Предимства / Удобства"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsx("li",{children:"• Голям брой отделни офисни помещения — подходящо за фирми, колективи или споделени офиси"}),t.jsx("li",{children:"• Санитарни възли и приемни във всеки етаж"}),t.jsx("li",{children:"• Подземен гараж / паркоместа — за служители / посетители"}),t.jsx("li",{children:"• Тиха локация, но с добър достъп до основни булеварди и градски транспорт"})]})]})]}):e.id==="prop-006"?t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"text-center bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl border border-blue-100",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"✨ Самостоятелна къща с 360° панорамна гледка в кв. Бояна ✨"}),t.jsx("p",{className:"text-gray-700 leading-relaxed",children:"Изключителен дом, предлагащ изглед към Витоша, Ботаническата градина и София. Ново строителство (2026 г.), разположен на обилен парцел в престижната Бояна, с материали и технологии от висок клас."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🏡 Характеристики"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• РЗП: ",t.jsx("strong",{children:"538,80 кв.м"})]}),t.jsxs("li",{children:["• Двор: ",t.jsx("strong",{children:"1101 кв.м – ландшафтен дизайн"})]}),t.jsxs("li",{children:["• Конструкция: ",t.jsx("strong",{children:"тухла Wienerberger"})]}),t.jsxs("li",{children:["• Дограма: ",t.jsx("strong",{children:"алуминиева с троен стъклопакет ETEM"})]}),t.jsxs("li",{children:["• Отопление: ",t.jsx("strong",{children:"термопомпа Daikin + газово котле + подово отопление + конвектори"})]}),t.jsxs("li",{children:["• Гараж: ",t.jsx("strong",{children:"подземен за 3 автомобила + фитнес със сауна"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"📐 Разпределение"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Партер:"})," хол с камина, кухня + склад, стая за гости/офис, тоалетна за гости, дрешник, перално"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Етаж 2:"})," родителска спалня с баня, 2 детски стаи с бани, горен хол/офис"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Панорамен покрив:"})," с ток, вода и възможност за кухня, бар или басейн"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Подземно ниво:"})," гараж, баня, котелно, склад, фитнес, сауна"]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🌿 Удобства и допълнителни характеристики"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsx("li",{children:"• Алуминиева входна врата"}),t.jsx("li",{children:"• Външна мазилка с врачански камък"}),t.jsx("li",{children:"• Южно изложение"}),t.jsx("li",{children:"• Тихо място с бърз достъп до града"})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🏆 Предимства"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsx("li",{children:"• Имоти без аналог — комбинация от стил, простор и гледка в сърцето на Бояна"}),t.jsx("li",{children:"• Високо качество на строителството и използваните материали"}),t.jsx("li",{children:"• Идеално за жилище, престиж / представителство или комфортен, луксозен начин на живот"})]})]})]}):e.id==="prop-007"?t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"text-center bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl border border-blue-100",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"✨ Слънчев четиристаен апартамент в Оборище с панорамни гледки ✨"}),t.jsx("p",{className:"text-gray-700 leading-relaxed",children:'Представяме ви просторен и светъл апартамент, разположен в сърцето на кв. Оборище, в непосредствена близост до Малък градски театър, парк „Заимов", метростанция Театрална и удобни спирки на градски транспорт. Жилището разкрива впечатляващи гледки към Витоша и към емблематичния храм-паметник „Св. Александър Невски".'})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"📐 Разпределение"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Просторна всекидневна"})," с кухненски бокс"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Три самостоятелни спални"})]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Две бани"})," с тоалетни"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Отделна тоалетна"})," за гости"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"Три тераси"})," с гледки"]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🌿 Предимства"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsx("li",{children:"• Отлична локация в престижен квартал"}),t.jsx("li",{children:"• Панорамни гледки към планината и центъра"}),t.jsx("li",{children:"• Баланс между градски комфорт и спокойствие"})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"⚙️ Удобства"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsx("li",{children:"• Възможност за паркомясто или гараж"}),t.jsx("li",{children:"• Панорамни гледки"}),t.jsx("li",{children:"• Напълно оборудвано жилище"}),t.jsx("li",{children:"• Тиха и престижна локация"})]})]})]}):e.id==="prop-008"?t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"text-center bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl border border-blue-100",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"✨ Модерна самостоятелна къща с двор и панорамни гледки в Драгалевци ✨"}),t.jsx("p",{className:"text-gray-700 leading-relaxed",children:"Разположена на ул. Пчелица, в близост до Киноцентъра, къщата предлага комфорт, функционалност и завършеност до ключ. Имотът е с Акт 16 / 2023 г., разполага с РЗП 460 кв.м и самостоятелен двор от 420 кв.м."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🏡 Основни характеристики"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• РЗП къща: ",t.jsx("strong",{children:"460 кв.м"})]}),t.jsxs("li",{children:["• Двор: ",t.jsx("strong",{children:"420 кв.м"})]}),t.jsxs("li",{children:["• Етажи: ",t.jsx("strong",{children:"3"})]}),t.jsxs("li",{children:["• Разрешение за ползване: ",t.jsx("strong",{children:"Акт 16 / 2023 г."})]}),t.jsxs("li",{children:["• Състояние: ",t.jsx("strong",{children:"завършена до ключ"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"📐 Разпределение"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsxs("li",{children:["• ",t.jsx("strong",{children:"I ниво:"})," всекидневна, кухня, дрешник и тоалетна"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"II ниво:"})," три спални със самостоятелни бани"]}),t.jsxs("li",{children:["• ",t.jsx("strong",{children:"III ниво:"})," всекидневна, кухненски бокс, спалня, баня с тоалетна, камина"]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"flex items-center gap-2 text-lg font-bold text-gray-900 mb-4",children:"🌿 Предимства"}),t.jsxs("ul",{className:"space-y-2 text-gray-700",children:[t.jsx("li",{children:"• Подови настилки: гранитогрес и ламинат"}),t.jsx("li",{children:"• Отопление на ток с климатици и камина"}),t.jsx("li",{children:"• Просторен и функционален имот, готов за обитаване"}),t.jsx("li",{children:"• Прекрасни панорамни гледки"}),t.jsx("li",{children:"• Престижна и спокойна локация в подножието на планината"})]})]})]}):t.jsx("div",{className:"text-gray-700 leading-relaxed whitespace-pre-line",children:e.description})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Основни характеристики"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Тип имот:"}),t.jsx("span",{className:"font-medium text-gray-900",children:e.property_type})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Тип сделка:"}),t.jsx("span",{className:"font-medium text-gray-900",children:e.transaction_type==="sale"?"Продажба":"Наем"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Площ:"}),t.jsxs("span",{className:"font-medium text-gray-900",children:[e.area," м²"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Спални:"}),t.jsx("span",{className:"font-medium text-gray-900",children:e.bedrooms||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Бани:"}),t.jsx("span",{className:"font-medium text-gray-900",children:e.bathrooms||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Тераси:"}),t.jsx("span",{className:"font-medium text-gray-900",children:e.terraces||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Етаж:"}),t.jsx("span",{className:"font-medium text-gray-900",children:e.id==="prop-002"||e.id==="prop-006"?"3 от 3":e.id==="prop-007"?"7 от 8":e.id==="prop-008"?"3 от 3":`${e.floor_number||2} от ${e.floors||2}`})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Допълнителни характеристики"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Година на строителство:"}),t.jsx("span",{className:"font-medium text-gray-900",children:e.year_built||2023})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Строителство:"}),t.jsx("span",{className:"font-medium text-gray-900",children:e.construction_type||"Тухла"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Отопление:"}),t.jsx("span",{className:"font-medium text-gray-900",children:e.id==="prop-006"?"Термопомпа + Газ + Подово":e.id==="prop-007"?"ТЕЦ или електричество чрез климатици":e.heating||"Локално"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Изложение:"}),t.jsx("span",{className:"font-medium text-gray-900",children:e.exposure||"Не е посочено"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Обзавеждане:"}),t.jsx("span",{className:"font-medium text-gray-900",children:e.id==="prop-007"?"Напълно оборудвано":e.furnishing_level==="full"?"Напълно обзаведен":e.furnishing_level==="partial"?"Частично обзаведен":e.furnishing_level==="unfurnished"?"Необзаведена":(e.furnishing_level==="none","Необзаведен")})]})]})]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Удобства"}),t.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.transaction_type==="rent"&&t.jsxs("span",{className:"px-4 py-2 bg-gradient-to-r from-sky-500 to-sky-600 text-white rounded-full text-sm font-medium shadow-lg flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"Под наем"]}),(e.id==="prop-001"||e.id==="prop-007")&&t.jsx("span",{className:"px-4 py-2 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:"Панорамни гледки"}),e.id==="prop-001"&&t.jsx("span",{className:"px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:"Просторен двор"}),e.id==="prop-002"&&t.jsx("span",{className:"px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:"Просторен двор"}),e.id==="prop-008"&&t.jsx("span",{className:"px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:"Завършена до ключ"}),e.id==="prop-008"&&t.jsx("span",{className:"px-4 py-2 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:"Панорамни гледки"}),e.has_elevator&&e.id!=="prop-001"&&e.id!=="prop-002"&&e.id!=="prop-006"&&t.jsx("span",{className:"px-4 py-2 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:"Асансьор"}),e.id==="prop-006"&&t.jsx("span",{className:"px-4 py-2 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:"Подземен гараж"}),e.has_garage&&t.jsx("span",{className:"px-4 py-2 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:"Гараж"}),e.id==="prop-007"&&t.jsx("span",{className:"px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:"Напълно оборудвано"}),e.id==="prop-008"&&t.jsx("span",{className:"px-4 py-2 bg-purple-100 text-purple-800 rounded-full text-sm font-medium",children:"Камина"}),e.has_southern_exposure&&t.jsx("span",{className:"px-4 py-2 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:"Южно изложение"})]})]})]})]}),t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"lg:sticky lg:top-24",children:[t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 text-center",children:[t.jsx("div",{className:"mb-6",children:t.jsx("img",{src:"/logo.png",alt:"ConsultingG Logo",className:"w-24 h-24 mx-auto rounded-2xl object-contain"})}),t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"ConsultingG"}),t.jsx("p",{className:"text-gray-600",children:"Real Estate"})]}),t.jsxs("a",{href:"tel:0888825445",className:"flex items-center justify-center gap-3 w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-4 px-6 rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 mb-4",children:[t.jsx(dt,{className:"w-5 h-5"}),t.jsx("span",{className:"font-bold",children:"Обадете се 0888825445"})]}),t.jsxs("a",{href:"mailto:office@consultingg.com?subject=Запитване за имот&body=Здравейте,%0D%0A%0D%0AИмам въпрос относно:",className:"flex items-center justify-center gap-3 w-full bg-white border-2 border-gray-300 text-gray-700 py-4 px-6 rounded-xl hover:bg-gray-50 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 mb-8",children:[t.jsx(ut,{className:"w-5 h-5"}),t.jsx("span",{className:"font-bold",children:"Изпратете имейл office@consultingg.com"})]}),t.jsxs("div",{className:"text-left",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Контактна информация"}),t.jsxs("div",{className:"space-y-3 text-sm",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(ve,{className:"w-4 h-4 text-gray-500 mt-0.5 flex-shrink-0"}),t.jsx("span",{className:"text-gray-700",children:"бул. Янко Съкъзов 16, София, България"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(dt,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),t.jsx("span",{className:"text-gray-700",children:"0888825445"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ut,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),t.jsx("span",{className:"text-gray-700",children:"office@consultingg.com"})]})]})]})]}),e.documents&&e.documents.length>0&&t.jsx("div",{className:"mt-6",children:t.jsxs("button",{onClick:()=>{e.documents&&e.documents.length>0&&window.open(`/api/documents/${e.documents[0].id}`,"_blank")},className:"flex items-center justify-center gap-2 w-full bg-red-600 text-white py-3 px-4 rounded-xl hover:bg-red-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",title:"Отвори PDF документи",children:[t.jsx(Zs,{className:"w-5 h-5"}),t.jsxs("span",{className:"font-medium",children:["Виж документи (",e.documents.length,")"]})]})})]})})]})})]})},Es=()=>{const{slug:n}=De(),[e,s]=k.useState(null),[r,a]=k.useState(!0),[i,o]=k.useState("");k.useEffect(()=>{n&&d(n)},[n]);const d=async l=>{try{const c=await O.getPageBySlug(l);c.success&&c.data?s(c.data):o(c.error||"Страницата не е намерена")}catch{o("Грешка при зареждане на страницата")}finally{a(!1)}};return r?t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):i||!e?t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("header",{className:"relative z-10 bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800",children:t.jsx("div",{className:"container mx-auto px-4 py-4",children:t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs(B,{to:"/",className:"flex items-center gap-3",children:[t.jsx("img",{src:"/logo.png",alt:"ConsultingG Logo",className:"w-24 h-24 rounded-xl shadow-lg object-contain"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-white",children:"ConsultingG"}),t.jsx("p",{className:"text-blue-200 text-sm",children:"Real Estate"})]})]}),t.jsx(Je,{})]})})}),t.jsx("div",{className:"container mx-auto px-4 py-12",children:t.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Страницата не е намерена"}),t.jsx("p",{className:"text-gray-600 mb-8",children:i}),t.jsx(B,{to:"/",className:"inline-block px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200",children:"Върнете се към началната страница"})]})}),t.jsx(Cr,{})]}):t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsxs(Qe,{children:[t.jsxs("title",{children:[e.title," - ConsultingG Real Estate"]}),t.jsx("meta",{name:"description",content:e.meta_description||`${e.title} - ConsultingG Real Estate`}),t.jsx("link",{rel:"canonical",href:`https://consultingg.com/${e.slug}`}),t.jsx("meta",{property:"og:title",content:`${e.title} - ConsultingG Real Estate`}),t.jsx("meta",{property:"og:description",content:e.meta_description||e.title}),t.jsx("meta",{property:"og:url",content:`https://consultingg.com/${e.slug}`}),t.jsx("meta",{property:"og:type",content:"article"})]}),t.jsxs("header",{className:"relative z-10 bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800",children:[t.jsx("div",{className:"absolute inset-0 opacity-10",children:t.jsx("div",{className:`absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.1"%3E%3Ccircle cx="30" cy="30" r="2"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')]`})}),t.jsx("div",{className:"absolute top-10 left-10 w-20 h-20 bg-blue-500/10 rounded-full blur-xl animate-pulse"}),t.jsx("div",{className:"absolute top-20 right-20 w-16 h-16 bg-purple-500/10 rounded-full blur-xl animate-pulse delay-1000"}),t.jsxs("div",{className:"container mx-auto px-4 py-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs(B,{to:"/",className:"flex items-center gap-3 hover:opacity-80 transition-opacity",children:[t.jsx("img",{src:"/logo.png",alt:"ConsultingG Logo",className:"w-24 h-24 rounded-xl shadow-lg object-contain"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-white",children:"ConsultingG"}),t.jsx("p",{className:"text-blue-200 text-sm",children:"Real Estate"})]})]}),t.jsx(Je,{})]}),t.jsxs("div",{className:"text-center pb-16",children:[t.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-white mb-4 leading-tight",children:e.title}),e.meta_description&&t.jsx("p",{className:"text-xl text-blue-200",children:e.meta_description})]})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0",children:t.jsx("svg",{viewBox:"0 0 1200 120",fill:"none",className:"w-full h-20",children:t.jsx("path",{d:"M0,60 C300,120 900,0 1200,60 L1200,120 L0,120 Z",fill:"white",fillOpacity:"0.1"})})})]}),t.jsx("div",{className:"container mx-auto px-4 py-12",children:t.jsx("div",{className:"max-w-4xl mx-auto",children:t.jsx("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-8",children:t.jsx("div",{className:"prose prose-lg max-w-none",dangerouslySetInnerHTML:{__html:e.content}})})})})]})},Aa=()=>{const n=je(),[e,s]=k.useState(""),[r,a]=k.useState(""),[i,o]=k.useState(!1),[d,l]=k.useState(!1),[c,u]=k.useState("");k.useEffect(()=>{O.isAuthenticated()&&n("/admin")},[n]);const h=async g=>{g.preventDefault(),l(!0),u("");try{const m=await O.login(e,r);m.success?n("/admin"):u(m.error||"Невалиден имейл или парола")}catch(m){const x=m instanceof Error?m.message:"Грешка при свързване със сървъра";u(x)}finally{l(!1)}};return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("img",{src:"/logo.png",alt:"ConsultingG Logo",className:"w-16 h-16 mx-auto mb-4 rounded-xl object-contain"}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Admin Panel"}),t.jsx("p",{className:"text-gray-600",children:"Влезте в административния панел"})]}),t.jsxs("form",{onSubmit:h,className:"space-y-6",autoComplete:"off",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Имейл"}),t.jsx("input",{type:"email",value:e,onChange:g=>s(g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Въведете имейл адрес",autoComplete:"off",autoCapitalize:"none",autoCorrect:"off",spellCheck:!1,inputMode:"email","data-testid":"input-email",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Парола"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:i?"text":"password",value:r,onChange:g=>a(g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 pr-12",placeholder:"••••••••",autoComplete:"new-password","data-testid":"input-password",required:!0}),t.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:i?t.jsx(fn,{className:"w-5 h-5"}):t.jsx(ye,{className:"w-5 h-5"})})]})]}),c&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl",children:c}),t.jsx("button",{type:"submit",disabled:d,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold py-3 px-4 rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:d?t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):t.jsxs(t.Fragment,{children:[t.jsx(pn,{className:"w-5 h-5"}),"Вход"]})})]})]})})},Oa=()=>{const n=je(),[e,s]=k.useState([]),[r,a]=k.useState(!0),[i,o]=k.useState(null),[d,l]=k.useState(""),[c,u]=k.useState(1),[h,g]=k.useState(1),[m,x]=k.useState(0),b=10;k.useEffect(()=>{if(!O.isAuthenticated()){n("/admin/login");return}p()},[n]);const p=async(w=c)=>{a(!0);try{const T=await O.getProperties({active:"all"},w,b);T.success&&T.data?(s(T.data),T.meta&&(g(T.meta.pages||1),x(T.meta.total||0),u(T.meta.page||1))):l(T.error||"Грешка при зареждане на имотите")}catch{l("Грешка при зареждане на имотите")}finally{a(!1)}},y=async w=>{try{const T=await O.deleteProperty(w);T.success?(s(I=>I.filter(W=>W.id!==w)),o(null),p(c)):l(T.error||"Грешка при изтриване")}catch{l("Грешка при изтриване")}},C=w=>{w>=1&&w<=h&&w!==c&&(u(w),p(w))},N=async()=>{await O.logout(),n("/admin/login")},S=async(w,T)=>{try{(await O.updateProperty(w,{featured:!T})).success&&(s(W=>W.map(q=>q.code===w?{...q,featured:!T}:q)),window.dispatchEvent(new CustomEvent("featuredPropertiesChanged")))}catch{l("Грешка при обновяване")}},j=async(w,T)=>{try{(await O.updateProperty(w,{active:!T})).success&&s(W=>W.map(q=>q.code===w?{...q,active:!T}:q))}catch{l("Грешка при обновяване")}};return r?t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("header",{className:"bg-white shadow-sm border-b",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsxs("div",{className:"flex justify-between items-center py-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("img",{src:"/logo.png",alt:"ConsultingG Logo",className:"w-12 h-12 rounded-xl object-contain"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Panel"}),t.jsx("p",{className:"text-gray-600",children:"ConsultingG Real Estate"})]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs(B,{to:"/",target:"_blank",className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-900 transition-colors",children:[t.jsx(ye,{className:"w-4 h-4"}),"Виж сайта"]}),t.jsx(B,{to:"/admin/services",className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-900 transition-colors",children:"Услуги"}),t.jsx(B,{to:"/admin/pages",className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-900 transition-colors",children:"Страници"}),t.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 text-red-600 hover:text-red-700 transition-colors",children:[t.jsx(xn,{className:"w-4 h-4"}),"Изход"]})]})]})})}),t.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[t.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Общо имоти"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]}),t.jsx(Nt,{className:"w-8 h-8 text-blue-600"})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Активни"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:e.filter(w=>w.active).length})]}),t.jsx(ye,{className:"w-8 h-8 text-green-600"})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Препоръчани"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:e.filter(w=>w.featured).length})]}),t.jsx(Mt,{className:"w-8 h-8 text-yellow-600"})]})}),t.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"За продажба"}),t.jsx("p",{className:"text-2xl font-bold text-purple-600",children:e.filter(w=>w.transaction_type==="sale").length})]}),t.jsx(Nt,{className:"w-8 h-8 text-purple-600"})]})})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Управление на имоти"}),t.jsxs(B,{to:"/admin/new",className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-2 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200",children:[t.jsx(Re,{className:"w-4 h-4"}),"Добави имот"]})]}),d&&t.jsx("div",{className:"px-6 py-4 bg-red-50 border-b border-red-200",children:t.jsx("p",{className:"text-red-700",children:d})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Имот"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Цена"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Локация"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(w=>{var T,I,W,q;return t.jsxs("tr",{className:`hover:bg-gray-50 ${w.transaction_type==="rent"?"bg-gradient-to-r from-sky-50/30 to-transparent border-l-4 border-sky-400":""}`,children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0 h-12 w-12",children:t.jsx("img",{className:"h-12 w-12 rounded-lg object-cover",src:((I=(T=w.images)==null?void 0:T[0])==null?void 0:I.url)||((q=(W=w.images)==null?void 0:W[0])==null?void 0:q.image_url)||"/images/placeholder.jpg",alt:w.title,onError:K=>{const f=K.target;f.src="/images/placeholder.jpg"}})}),t.jsxs("div",{className:"ml-4",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900 max-w-xs truncate",children:w.title}),t.jsxs("div",{className:"text-sm text-gray-500",children:[w.property_type," • ",w.area,"м²"]})]})]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["€",Math.floor(w.price).toLocaleString()]}),t.jsxs("div",{className:`text-sm font-medium flex items-center gap-1 ${w.transaction_type==="rent"?"text-sky-600":"text-gray-500"}`,children:[w.transaction_type==="rent"&&t.jsx("div",{className:"w-2 h-2 bg-sky-500 rounded-full animate-pulse"}),w.transaction_type==="sale"?"Продажба":"Под наем"]})]}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsx("div",{className:"text-sm text-gray-900",children:w.city_region}),t.jsx("div",{className:"text-sm text-gray-500",children:w.district})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${w.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:w.active?"Активен":"Неактивен"}),w.featured&&t.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:"Препоръчан"})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(B,{to:`/properties/${w.id}`,target:"_blank",className:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"Преглед",children:t.jsx(ye,{className:"w-4 h-4"})}),t.jsx(B,{to:`/admin/edit/${w.id}`,className:"text-indigo-600 hover:text-indigo-900 p-1 rounded",title:"Редактиране",children:t.jsx(ft,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>S(w.id,w.featured),className:`p-1 rounded ${w.featured?"text-yellow-600 hover:text-yellow-900":"text-gray-400 hover:text-yellow-600"}`,title:w.featured?"Премахни от препоръчани":"Добави в препоръчани",children:t.jsx(Mt,{className:"w-4 h-4",fill:w.featured?"currentColor":"none"})}),t.jsx("button",{onClick:()=>j(w.id,w.active),className:`px-2 py-1 text-xs rounded ${w.active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,title:w.active?"Деактивирай":"Активирай",children:w.active?"Скрий":"Покажи"}),t.jsx("button",{onClick:()=>o(w.id),className:"text-red-600 hover:text-red-900 p-1 rounded",title:"Изтриване",children:t.jsx(pt,{className:"w-4 h-4"})})]})})]},w.id)})})]})}),e.length===0&&!r&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(Nt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Няма имоти"}),t.jsx("p",{className:"text-gray-500 mb-4",children:"Започнете като добавите първия имот"}),t.jsxs(B,{to:"/admin/new",className:"inline-flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[t.jsx(Re,{className:"w-4 h-4"}),"Добави имот"]})]}),e.length>0&&h>1&&t.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-700",children:["Показани ",t.jsx("span",{className:"font-medium",children:(c-1)*b+1})," до"," ",t.jsx("span",{className:"font-medium",children:Math.min(c*b,m)})," от"," ",t.jsx("span",{className:"font-medium",children:m})," имота"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>C(c-1),disabled:c===1,className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${c===1?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"}`,children:"Предишна"}),t.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(h,5)},(w,T)=>{let I;return h<=5||c<=3?I=T+1:c>=h-2?I=h-4+T:I=c-2+T,t.jsx("button",{onClick:()=>C(I),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${I===c?"bg-blue-600 text-white":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"}`,children:I},I)})}),t.jsx("button",{onClick:()=>C(c+1),disabled:c===h,className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${c===h?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"}`,children:"Следваща"})]})]})})]})]}),i&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Потвърждение за изтриване"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Сигурни ли сте, че искате да изтриете този имот? Това действие не може да бъде отменено."}),t.jsxs("div",{className:"flex gap-3 justify-end",children:[t.jsx("button",{onClick:()=>o(null),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Отказ"}),t.jsx("button",{onClick:()=>y(i),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Изтрий"})]})]})})]})},Cs=({mode:n})=>{const e=je(),{id:s}=De(),r=n==="edit"&&s,[a,i]=k.useState(!1),[o,d]=k.useState(""),[l,c]=k.useState([]),[u,h]=k.useState([]),[g,m]=k.useState({title:"",description:"",property_code:"",price:5e4,currency:"EUR",transaction_type:"sale",property_type:"",city_region:"София",district:"",address:"",area:50,bedrooms:0,bathrooms:0,floors:0,floor_number:0,terraces:0,construction_type:"",condition_type:"",heating:"",exposure:"",year_built:new Date().getFullYear(),furnishing_level:"",has_elevator:!1,has_garage:!1,has_southern_exposure:!1,new_construction:!1,featured:!1,active:!0,pricing_mode:"total"}),x=ua(),b=gr(g.city_region);k.useEffect(()=>{if(!O.isAuthenticated()){e("/admin/login");return}r&&s&&p(s)},[r,s,e]);const p=async f=>{i(!0);try{const _=await O.getProperty(f);if(_.success&&_.data){const v=_.data;m({title:v.title,description:v.description||"",price:v.price,currency:v.currency,transaction_type:v.transaction_type,property_type:v.property_type,city_region:v.city_region,district:v.district||"",address:v.address||"",area:v.area,bedrooms:v.bedrooms,bathrooms:v.bathrooms,floors:v.floors||0,floor_number:v.floor_number||0,terraces:v.terraces,construction_type:v.construction_type||"",condition:v.condition_type||"",heating:v.heating||"",year_built:v.year_built||new Date().getFullYear(),furnishing_level:v.furnishing_level||"",has_elevator:v.has_elevator,has_garage:v.has_garage,has_southern_exposure:v.has_southern_exposure,new_construction:v.new_construction,featured:v.featured,active:v.active}),v.images&&c(v.images.map(E=>({id:E.id,url:E.image_url,isMain:E.is_main,sortOrder:E.sort_order,altText:E.alt_text}))),v.documents&&h(v.documents.map(E=>({id:E.id,filename:E.filename,size:E.size,url:E.url})))}else d(_.error||"Грешка при зареждане на имота")}catch{d("Грешка при зареждане на имота")}finally{i(!1)}},y=(f,_)=>{m(v=>({...v,[f]:_}))},C=f=>{const _=Array.from(f.target.files||[]);_.length!==0&&(_.forEach(v=>{if(v.type!=="application/pdf"){d(`Неподдържан формат на файл: ${v.type}. Моля използвайте само PDF файлове.`);return}if(v.size>10*1024*1024){d(`Файлът е твърде голям: ${(v.size/1024/1024).toFixed(1)}MB. Максимум 10MB.`);return}const E={filename:v.name,size:v.size,file:v,uploading:!1};h(P=>[...P,E]),r&&s&&N(v,s)}),f.target.value="",d(""))},N=async(f,_)=>{try{h(E=>E.map(P=>P.file===f?{...P,uploading:!0,error:void 0}:P));const v=await O.uploadDocument(_,f);v.success?h(E=>E.map(P=>P.file===f?{id:v.data.id,filename:v.data.filename,size:v.data.size,url:v.data.url,uploading:!1}:P)):(h(E=>E.map(P=>P.file===f?{...P,uploading:!1,error:v.error}:P)),d(v.error||"Грешка при качване на документа"))}catch(v){console.error("Error uploading document:",v),h(E=>E.map(P=>P.file===f?{...P,uploading:!1,error:"Грешка при качване"}:P)),d("Грешка при качване на документа")}},S=async f=>{const _=u[f];if(_.id&&r&&s)try{const v=await O.deleteDocument(_.id);if(v.success)h(E=>E.filter((P,R)=>R!==f));else{d(v.error||"Грешка при изтриване на документа");return}}catch(v){console.error("Error deleting document:",v),d("Грешка при изтриване на документа");return}else h(v=>v.filter((E,P)=>P!==f))},j=f=>{if(f===0)return"0 Bytes";const _=1024,v=["Bytes","KB","MB","GB"],E=Math.floor(Math.log(f)/Math.log(_));return parseFloat((f/Math.pow(_,E)).toFixed(2))+" "+v[E]},w=f=>{const _=Array.from(f.target.files||[]);if(_.length!==0){if(l.length+_.length>50){d(`Не можете да качите повече от 50 снимки. Имате ${l.length}, опитвате да добавите ${_.length}.`);return}_.forEach(v=>{if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(v.type)){d(`Неподдържан формат на файл: ${v.type}. Моля използвайте JPEG, PNG или WebP.`);return}if(v.size>10*1024*1024){d(`Файлът е твърде голям: ${(v.size/1024/1024).toFixed(1)}MB. Максимум 10MB.`);return}const P=new FileReader;P.onload=R=>{var le;const Z={url:(le=R.target)==null?void 0:le.result,file:v,isMain:l.length===0,sortOrder:l.length,altText:`Property image ${l.length+1}`,uploading:!1};c(ge=>[...ge,Z]),r&&s&&T(v,s,l.length===0)},P.onerror=()=>{d("Грешка при четене на файла")},P.readAsDataURL(v)}),f.target.value="",d("")}},T=async(f,_,v)=>{try{c(P=>P.map((R,Z)=>R.file===f?{...R,uploading:!0,error:void 0}:R)),console.log("Uploading image:",{fileName:f.name,fileSize:f.size,fileType:f.type,propertyId:_,isMain:v});const E=await O.uploadImage(f,_,v);console.log("Upload result:",E),E.success?c(P=>P.map((R,Z)=>R.file===f?{...R,id:E.data.id,url:E.data.url,uploading:!1,file:void 0}:R)):(c(P=>P.map((R,Z)=>R.file===f?{...R,uploading:!1,error:E.error}:R)),console.error("Upload failed:",E.error),d(`Грешка при качване на снимката: ${E.error||"Неизвестна грешка"}`))}catch(E){console.error("Error uploading image:",E),c(P=>P.map((R,Z)=>R.file===f?{...R,uploading:!1,error:"Грешка при качване"}:R)),d(`Грешка при качване на снимката: ${E instanceof Error?E.message:"Неизвестна грешка"}`)}},I=async f=>{const _=l[f];if(_.id&&r&&s)try{console.log("Deleting image:",_.id,"from property:",s);const v=await O.deleteImage(s,_.id);if(console.log("Delete result:",v),v.success)c(E=>{const P=E.filter((R,Z)=>Z!==f);return E[f].isMain&&P.length>0&&(P[0].isMain=!0),P});else{d(v.error||"Грешка при изтриване на снимката");return}}catch(v){console.error("Error deleting image:",v),d("Грешка при изтриване на снимката");return}else c(v=>{const E=v.filter((P,R)=>R!==f);return v[f].isMain&&E.length>0&&(E[0].isMain=!0),E})},W=async f=>{const _=l[f];if(_.id&&r&&s)try{console.log("Setting main image:",_.id,"for property:",s);const v=await O.setMainImage(_.id,s);if(console.log("Set main result:",v),v.success)c(E=>E.map((P,R)=>({...P,isMain:R===f})));else{d(v.error||"Грешка при задаване на главна снимка");return}}catch(v){console.error("Error setting main image:",v),d("Грешка при задаване на главна снимка");return}else c(v=>v.map((E,P)=>({...E,isMain:P===f})))},q=f=>{var v,E,P,R,Z,le,ge,et,tt;const _={...f};return(v=_.description)!=null&&v.trim()||delete _.description,(E=_.property_code)!=null&&E.trim()||delete _.property_code,(P=_.district)!=null&&P.trim()||delete _.district,(R=_.address)!=null&&R.trim()||delete _.address,(Z=_.construction_type)!=null&&Z.trim()||delete _.construction_type,(le=_.condition_type)!=null&&le.trim()||delete _.condition_type,(ge=_.heating)!=null&&ge.trim()||delete _.heating,(et=_.exposure)!=null&&et.trim()||delete _.exposure,(tt=_.furnishing_level)!=null&&tt.trim()||delete _.furnishing_level,(!_.bedrooms||_.bedrooms<=0)&&delete _.bedrooms,(!_.bathrooms||_.bathrooms<=0)&&delete _.bathrooms,(!_.terraces||_.terraces<=0)&&delete _.terraces,(!_.floors||_.floors<=0)&&delete _.floors,(!_.floor_number||_.floor_number<=0)&&delete _.floor_number,(!_.year_built||_.year_built<=0)&&delete _.year_built,_},K=async f=>{f.preventDefault(),i(!0),d("");try{if(!g.title||g.title.trim().length<3)throw new Error("Заглавието трябва да бъде поне 3 символа");if(!g.price||g.price<=0)throw new Error("Цената трябва да бъде по-голяма от 0");if(!g.area||g.area<=0)throw new Error("Площта трябва да бъде по-голяма от 0");if(!g.property_type)throw new Error("Моля изберете тип имот");if(!g.transaction_type)throw new Error("Моля изберете тип сделка");if(!g.city_region)throw new Error("Моля изберете град/регион");let _,v;const E=q(g);if(r&&s){const P=await O.updateProperty(s,E);if(!P.success)throw new Error(P.error||"Failed to update property");v=s}else{const P=await O.createProperty(E);if(!P.success||!P.data)throw new Error(P.error||"Failed to create property");v=P.data.id}for(const P of l)if(P.file)try{const R=await O.uploadImage(P.file,v,P.isMain);console.log("Image uploaded:",R)}catch(R){console.error("Failed to upload image:",R)}e("/admin")}catch(_){const v=_ instanceof Error?_.message:"Грешка при запазване на имота";d(v)}finally{i(!1)}};return a&&r?t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("header",{className:"bg-white shadow-sm border-b",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"flex justify-between items-center py-6",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("button",{onClick:()=>e("/admin"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[t.jsx(Ve,{className:"w-5 h-5"}),"Назад"]}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?"Редактиране на имот":"Добавяне на нов имот"}),t.jsx("p",{className:"text-gray-600",children:r?"Редактирайте информацията за имота":"Попълнете всички полета за новия имот"})]})]})})})}),t.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs("form",{onSubmit:K,className:"space-y-8",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Основна информация"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Заглавие *"}),t.jsx("input",{type:"text",value:g.title,onChange:f=>y("title",f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Например: Луксозен апартамент в центъра",required:!0})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Описание"}),t.jsx("textarea",{value:g.description,onChange:f=>y("description",f.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Подробно описание на имота..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Код на имота"}),t.jsx("input",{type:"text",value:g.property_code||"",onChange:f=>y("property_code",f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Например: PROP-001"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Тип сделка *"}),t.jsxs("select",{value:g.transaction_type,onChange:f=>y("transaction_type",f.target.value),className:`w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none transition-all duration-200 ${g.transaction_type==="rent"?"focus:ring-2 focus:ring-sky-500 focus:border-sky-500 bg-sky-50/30":"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,required:!0,children:[t.jsx("option",{value:"sale",children:"🏠 Продажба"}),t.jsx("option",{value:"rent",children:"🏡 Под наем"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Тип имот *"}),t.jsxs("select",{value:g.property_type,onChange:f=>y("property_type",f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[t.jsx("option",{value:"",children:"Изберете тип"}),cr.map((f,_)=>{const v=typeof f=="string"?f:f.value??f.key??"",E=typeof f=="string"?f:f.key??f.value??String(_);return t.jsx("option",{value:v,children:v},E)})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цена * (€)"}),t.jsx("input",{type:"number",value:g.price,onChange:f=>y("price",Number(f.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",required:!0,min:"0"})]}),g.transaction_type==="rent"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цена на наем /м² (EUR)"}),t.jsx("input",{type:"number",step:"0.01",value:g.pricing_mode==="per_sqm"?g.price:"",onChange:f=>{const _=f.target.value.replace(",",".");_?(y("price",parseFloat(_)),y("pricing_mode","per_sqm")):y("pricing_mode","per_month")},className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 bg-sky-50/30",placeholder:"8.00",min:"0"}),t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Оставете празно за месечна цена. Попълнете за цена на кв.м."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Площ * (м²)"}),t.jsx("input",{type:"number",step:"0.01",value:g.area,onChange:f=>{const _=f.target.value.replace(",",".");y("area",_?parseFloat(_):0)},className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",required:!0,min:"0"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Локация"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Град *"}),t.jsx("select",{value:g.city_region,onChange:f=>{y("city_region",f.target.value),y("district","")},className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:x.map((f,_)=>{const v=typeof f=="string"?f:f.value??f.key??"",E=typeof f=="string"?f:f.key??f.value??String(_);return t.jsx("option",{value:v,children:v},E)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Квартал"}),t.jsxs("select",{value:g.district,onChange:f=>y("district",f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:b.length===0,children:[t.jsx("option",{value:"",children:"Изберете квартал"}),b.map((f,_)=>{const v=typeof f=="string"?f:f.value??f.key??"",E=typeof f=="string"?f:f.key??f.value??String(_);return t.jsx("option",{value:v,children:v},E)})]})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Адрес"}),t.jsx("input",{type:"text",value:g.address,onChange:f=>y("address",f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"ул. Примерна 123"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Детайли за имота"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Спални"}),t.jsx("input",{type:"number",value:g.bedrooms,onChange:f=>y("bedrooms",Number(f.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Бани"}),t.jsx("input",{type:"number",value:g.bathrooms,onChange:f=>y("bathrooms",Number(f.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Тераси"}),t.jsx("input",{type:"number",value:g.terraces,onChange:f=>y("terraces",Number(f.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Етаж на имота (незадължително)"}),t.jsx("input",{type:"number",value:g.floor_number,onChange:f=>y("floor_number",Number(f.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"На кой етаж се намира",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Общо етажи в сградата (незадължително)"}),t.jsx("input",{type:"text",value:g.floors,onChange:f=>y("floors",f.target.value?Number(f.target.value):void 0),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Общо етажи в сградата"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Изложение"}),t.jsxs("select",{value:g.exposure||"",onChange:f=>y("exposure",f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[t.jsx("option",{value:"",children:"Не е посочено"}),t.jsx("option",{value:"Север",children:"Север"}),t.jsx("option",{value:"Юг",children:"Юг"}),t.jsx("option",{value:"Изток",children:"Изток"}),t.jsx("option",{value:"Запад",children:"Запад"}),t.jsx("option",{value:"Ю-И",children:"Юг-Изток"}),t.jsx("option",{value:"Ю-З",children:"Юг-Запад"}),t.jsx("option",{value:"С-И",children:"Север-Изток"}),t.jsx("option",{value:"С-З",children:"Север-Запад"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Година на строителство (незадължително)"}),t.jsx("input",{type:"text",value:g.year_built,onChange:f=>y("year_built",f.target.value?Number(f.target.value):void 0),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:new Date().getFullYear().toString()})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Вид строителство"}),t.jsxs("select",{value:g.construction_type||"",onChange:f=>y("construction_type",f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[t.jsx("option",{value:"",children:"Изберете вид"}),dr.map((f,_)=>{const v=typeof f=="string"?f:f.value??f.key??"",E=typeof f=="string"?f:f.key??f.value??String(_);return t.jsx("option",{value:v,children:v},E)})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Състояние"}),t.jsxs("select",{value:g.condition_type||"",onChange:f=>y("condition_type",f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[t.jsx("option",{value:"",children:"Изберете състояние"}),ur.map((f,_)=>{const v=typeof f=="string"?f:f.value??f.key??"",E=typeof f=="string"?f:f.key??f.value??String(_);return t.jsx("option",{value:v,children:v},E)})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Отопление"}),t.jsxs("select",{value:g.heating||"",onChange:f=>y("heating",f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[t.jsx("option",{value:"",children:"Изберете отопление"}),da.map((f,_)=>{const v=typeof f=="string"?f:f.value??f.key??"",E=typeof f=="string"?f:f.key??f.value??String(_);return t.jsx("option",{value:v,children:v},E)})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ниво на обзавеждане"}),t.jsxs("select",{value:g.furnishing_level||"",onChange:f=>y("furnishing_level",f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[t.jsx("option",{value:"",children:"Изберете ниво"}),hr.map((f,_)=>{const v=typeof f=="string"?f:f.value??f.key??"",E=typeof f=="string"?f:f.key??f.value??String(_),P=typeof f=="string"?f:f.label??f.value??f.key??"";return t.jsx("option",{value:v,children:P},E)})]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Характеристики"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:g.has_elevator,onChange:f=>y("has_elevator",f.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Асансьор"})]}),t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:g.has_garage,onChange:f=>y("has_garage",f.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Гараж"})]}),t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:g.new_construction,onChange:f=>y("new_construction",f.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Ново строителство"})]}),t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:g.featured,onChange:f=>y("featured",f.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Препоръчан имот"})]}),t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:g.active,onChange:f=>y("active",f.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Активен"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Снимки"}),t.jsx("div",{className:"mb-6",children:t.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-xl cursor-pointer bg-gray-50 hover:bg-gray-100",children:[t.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[t.jsx(gs,{className:"w-8 h-8 mb-4 text-gray-500"}),t.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[t.jsx("span",{className:"font-semibold",children:"Кликнете за качване"})," или плъзнете файловете"]}),t.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG или JPEG (MAX. 10MB)"})]}),t.jsx("input",{type:"file",className:"hidden",multiple:!0,accept:"image/*",onChange:w})]})}),l.length>0&&t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:l.map((f,_)=>t.jsxs("div",{className:"relative group",children:[t.jsx("img",{src:f.thumbnail_url||f.url,alt:`Property image ${_+1}`,className:"w-full h-24 object-cover rounded-lg"}),t.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center gap-2",children:[t.jsx("button",{type:"button",onClick:()=>W(_),className:`p-1 rounded ${f.isMain?"bg-yellow-500 text-white":"bg-white text-gray-700 hover:bg-yellow-500 hover:text-white"} disabled:opacity-50`,disabled:f.uploading,children:t.jsx(Mt,{className:"w-4 h-4",fill:f.isMain?"currentColor":"none"})}),t.jsx("button",{type:"button",onClick:()=>I(_),disabled:f.uploading,className:"p-1 bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50",title:"Премахни снимка",children:t.jsx(Dt,{className:"w-4 h-4"})})]}),f.uploading&&t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-lg",children:t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"})}),f.isMain&&t.jsx("div",{className:"absolute top-1 left-1 bg-yellow-500 text-white text-xs px-2 py-1 rounded",children:"Главна"}),f.error&&t.jsx("div",{className:"absolute bottom-1 left-1 right-1 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"Грешка"})]},_))})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Документи (PDF)"}),t.jsx("div",{className:"mb-6",children:t.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-xl cursor-pointer bg-gray-50 hover:bg-gray-100",children:[t.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[t.jsx(gs,{className:"w-8 h-8 mb-4 text-gray-500"}),t.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[t.jsx("span",{className:"font-semibold",children:"Кликнете за качване"})," или плъзнете PDF файлове"]}),t.jsx("p",{className:"text-xs text-gray-500",children:"Само PDF файлове (MAX. 10MB)"})]}),t.jsx("input",{type:"file",className:"hidden",multiple:!0,accept:".pdf",onChange:C})]})}),u.length>0&&t.jsx("div",{className:"space-y-3",children:u.map((f,_)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:t.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:f.filename}),t.jsx("p",{className:"text-xs text-gray-500",children:j(f.size)})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[f.url&&t.jsx("button",{type:"button",onClick:()=>window.open(f.url,"_blank"),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Отвори PDF",children:t.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),t.jsx("button",{type:"button",onClick:()=>S(_),disabled:f.uploading,className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Премахни документ",children:t.jsx(Dt,{className:"w-4 h-4"})})]}),f.uploading&&t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-lg",children:t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"})}),f.error&&t.jsx("div",{className:"mt-1 text-xs text-red-600",children:f.error})]},_))})]}),o&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl",children:o}),t.jsxs("div",{className:"flex items-center justify-end gap-4",children:[t.jsx("button",{type:"button",onClick:()=>e("/admin"),className:"px-6 py-3 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:"Отказ"}),t.jsx("button",{type:"submit",disabled:a,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:a?t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):t.jsxs(t.Fragment,{children:[t.jsx(xt,{className:"w-5 h-5"}),r?"Обнови имот":"Създай имот"]})})]})]})})]})},Ia=()=>{const[n,e]=k.useState([]),[s,r]=k.useState(!0),[a,i]=k.useState(null),[o,d]=k.useState("");k.useEffect(()=>{l()},[]);const l=async()=>{r(!0),d("");try{const h=await O.getServices();console.log("Services API result:",h),h.success&&h.data?e(h.data):(console.error("Services API error:",h.error),d(h.error||"Грешка при зареждане на услугите"))}catch(h){console.error("Error fetching services:",h),d("Грешка при зареждане на услугите")}finally{r(!1)}},c=async h=>{try{const g=await O.deleteService(h);console.log("Delete service result:",g),g.success?(e(m=>m.filter(x=>x.id!==h)),i(null)):(console.error("Delete service error:",g.error),d(g.error||"Грешка при изтриване"))}catch(g){console.error("Error deleting service:",g),d("Грешка при изтриване")}},u=async(h,g)=>{try{const m=await O.updateService(h,{active:!g});console.log("Toggle active result:",m),m.success?e(x=>x.map(b=>b.id===h?{...b,active:!g}:b)):(console.error("Toggle active error:",m.error),d(m.error||"Грешка при обновяване"))}catch(m){console.error("Error updating service:",m),d("Грешка при обновяване")}};return s?t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((h,g)=>t.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[t.jsx("div",{className:"h-16 w-16 bg-gray-200 rounded-2xl mb-4"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"})]},g))})]})}):t.jsxs("div",{className:"p-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Услуги"}),t.jsxs("p",{className:"text-gray-600",children:["Управление на всички услуги (",n.length," общо)"]})]}),t.jsxs(B,{to:"/admin/services/new",className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg",children:[t.jsx(Re,{className:"w-5 h-5"}),"Добави услуга"]})]}),o&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:o}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(h=>t.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:`w-16 h-16 bg-gradient-to-r ${h.color} rounded-2xl flex items-center justify-center mb-4`,children:t.jsx(bn,{className:"w-8 h-8 text-white drop-shadow-lg"})}),t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:h.title}),t.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:h.description}),t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${h.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:h.active?"Активна":"Неактивна"}),t.jsxs("span",{className:"text-xs text-gray-500",children:["Ред: ",h.sort_order]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(B,{to:`/admin/services/${h.id}/edit`,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors text-sm",children:[t.jsx(ft,{className:"w-4 h-4"}),"Редактирай"]}),t.jsx("button",{onClick:()=>u(h.id,h.active),className:`px-3 py-2 text-xs rounded-lg ${h.active?"bg-red-50 text-red-700 hover:bg-red-100":"bg-green-50 text-green-700 hover:bg-green-100"}`,title:h.active?"Деактивирай":"Активирай",children:h.active?"Скрий":"Покажи"}),t.jsx("button",{onClick:()=>i(h.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Изтриване",children:t.jsx(pt,{className:"w-4 h-4"})})]})]})},h.id))}),a&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Потвърждение за изтриване"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Сигурни ли сте, че искате да изтриете тази услуга? Това действие не може да бъде отменено."}),t.jsxs("div",{className:"flex gap-3 justify-end",children:[t.jsx("button",{onClick:()=>i(null),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Отказ"}),t.jsx("button",{onClick:()=>c(a),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Изтрий"})]})]})})]})},$a=[{value:"Home",label:"Дом"},{value:"TrendingUp",label:"Тенденция нагоре"},{value:"Shield",label:"Щит"},{value:"Users",label:"Потребители"},{value:"Award",label:"Награда"},{value:"Headphones",label:"Слушалки"},{value:"Settings",label:"Настройки"},{value:"Star",label:"Звезда"},{value:"Heart",label:"Сърце"},{value:"Phone",label:"Телефон"}],Ra=[{value:"from-blue-500 to-blue-600",label:"Син"},{value:"from-green-500 to-green-600",label:"Зелен"},{value:"from-purple-500 to-purple-600",label:"Лилав"},{value:"from-orange-500 to-orange-600",label:"Оранжев"},{value:"from-red-500 to-red-600",label:"Червен"},{value:"from-indigo-500 to-indigo-600",label:"Индиго"},{value:"from-pink-500 to-pink-600",label:"Розов"},{value:"from-yellow-500 to-yellow-600",label:"Жълт"}],Ts=()=>{const n=je(),{id:e}=De(),s=!!e,[r,a]=k.useState(!1),[i,o]=k.useState(""),[d,l]=k.useState({title:"",description:"",icon:"Home",color:"from-blue-500 to-blue-600",sort_order:1,active:!0});k.useEffect(()=>{s&&e&&c(e)},[s,e]);const c=async g=>{a(!0);try{const m=await O.getService(g);m.success&&m.data?l({title:m.data.title,description:m.data.description,icon:m.data.icon,color:m.data.color,sort_order:m.data.sort_order,active:m.data.active}):o(m.error||"Грешка при зареждане на услугата")}catch(m){console.error("Error loading service:",m),o("Грешка при зареждане на услугата")}finally{a(!1)}},u=(g,m)=>{l(x=>({...x,[g]:m}))},h=async g=>{g.preventDefault(),a(!0),o("");try{let m;s&&e?m=await O.updateService(e,d):m=await O.createService(d),m.success?n("/admin/services"):o(m.error||"Грешка при запазване на услугата")}catch(m){console.error("Error saving service:",m),o("Грешка при запазване на услугата")}finally{a(!1)}};return r&&s?t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("header",{className:"bg-white shadow-sm border-b",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"flex justify-between items-center py-6",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("button",{onClick:()=>n("/admin/services"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[t.jsx(Ve,{className:"w-5 h-5"}),"Назад"]}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s?"Редактиране на услуга":"Добавяне на нова услуга"}),t.jsx("p",{className:"text-gray-600",children:s?"Редактирайте информацията за услугата":"Попълнете всички полета за новата услуга"})]})]})})})}),t.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs("form",{onSubmit:h,className:"space-y-8",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Основна информация"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Заглавие *"}),t.jsx("input",{type:"text",value:d.title,onChange:g=>u("title",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Например: Продажба на имоти",required:!0})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Описание *"}),t.jsx("textarea",{value:d.description,onChange:g=>u("description",g.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Кратко описание на услугата...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Икона *"}),t.jsx("select",{value:d.icon,onChange:g=>u("icon",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:$a.map(g=>t.jsx("option",{value:g.value,children:g.label},g.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Цвят *"}),t.jsx("select",{value:d.color,onChange:g=>u("color",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:Ra.map(g=>t.jsx("option",{value:g.value,children:g.label},g.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ред на показване"}),t.jsx("input",{type:"number",value:d.sort_order,onChange:g=>u("sort_order",Number(g.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"1",min:"1"})]}),t.jsx("div",{className:"flex items-center",children:t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:d.active,onChange:g=>u("active",g.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Активна услуга"})]})})]})]}),i&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl",children:i}),t.jsxs("div",{className:"flex items-center justify-end gap-4",children:[t.jsx("button",{type:"button",onClick:()=>n("/admin/services"),className:"px-6 py-3 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:"Отказ"}),t.jsx("button",{type:"submit",disabled:r,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:r?t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):t.jsxs(t.Fragment,{children:[t.jsx(xt,{className:"w-5 h-5"}),s?"Обнови услуга":"Създай услуга"]})})]})]})})]})},La=()=>{const[n,e]=k.useState([]),[s,r]=k.useState(!0),[a,i]=k.useState(null),[o,d]=k.useState("");k.useEffect(()=>{l()},[]);const l=async()=>{try{const h=await O.getPages();h.success&&h.data?e(h.data):d(h.error||"Грешка при зареждане на страниците")}catch{d("Грешка при зареждане на страниците")}finally{r(!1)}},c=async h=>{try{const g=await O.deletePage(h);g.success?(e(m=>m.filter(x=>x.id!==h)),i(null)):d(g.error||"Грешка при изтриване")}catch{d("Грешка при изтриване")}},u=async(h,g)=>{try{const m=await O.updatePage(h,{active:!g});m.success?e(x=>x.map(b=>b.id===h?{...b,active:!g}:b)):d(m.error||"Грешка при обновяване")}catch{d("Грешка при обновяване")}};return s?t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),t.jsx("div",{className:"space-y-4",children:[...Array(3)].map((h,g)=>t.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]},g))})]})}):t.jsxs("div",{className:"p-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Страници"}),t.jsxs("p",{className:"text-gray-600",children:["Управление на всички страници (",n.length," общо)"]})]}),t.jsxs(B,{to:"/admin/pages/new",className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg",children:[t.jsx(Re,{className:"w-5 h-5"}),"Добави страница"]})]}),t.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Страница"}),t.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"URL"}),t.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),t.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(h=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:t.jsx("div",{className:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center",children:t.jsx(Zs,{className:"w-5 h-5 text-blue-600"})})}),t.jsxs("div",{className:"ml-4",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:h.title}),t.jsx("div",{className:"text-sm text-gray-500",children:h.meta_description})]})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"text-sm text-gray-900",children:["/",h.slug]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${h.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:h.active?"Активна":"Неактивна"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(B,{to:`/${h.slug}`,target:"_blank",className:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"Преглед",children:t.jsx(ye,{className:"w-4 h-4"})}),t.jsx(B,{to:`/admin/pages/${h.id}/edit`,className:"text-indigo-600 hover:text-indigo-900 p-1 rounded",title:"Редактиране",children:t.jsx(ft,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>u(h.id,h.active),className:`px-2 py-1 text-xs rounded ${h.active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,title:h.active?"Деактивирай":"Активирай",children:h.active?"Скрий":"Покажи"}),t.jsx("button",{onClick:()=>i(h.id),className:"text-red-600 hover:text-red-900 p-1 rounded",title:"Изтриване",children:t.jsx(pt,{className:"w-4 h-4"})})]})})]},h.id))})]})})}),o&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:o}),a&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Потвърждение за изтриване"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Сигурни ли сте, че искате да изтриете тази страница? Това действие не може да бъде отменено."}),t.jsxs("div",{className:"flex gap-3 justify-end",children:[t.jsx("button",{onClick:()=>i(null),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Отказ"}),t.jsx("button",{onClick:()=>c(a),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Изтрий"})]})]})})]})},Ps=()=>{const n=je(),{id:e}=De(),s=!!e,[r,a]=k.useState(!1),[i,o]=k.useState(""),[d,l]=k.useState({slug:"",title:"",content:"",meta_description:"",active:!0});k.useEffect(()=>{s&&e&&c(e)},[s,e]);const c=async g=>{a(!0);try{const m=await O.getPage(g);m.success&&m.data?l({slug:m.data.slug,title:m.data.title,content:m.data.content,meta_description:m.data.meta_description||"",active:m.data.active}):o(m.error||"Грешка при зареждане на страницата")}catch{o("Грешка при зареждане на страницата")}finally{a(!1)}},u=(g,m)=>{l(x=>({...x,[g]:m}))},h=async g=>{g.preventDefault(),a(!0),o("");try{let m;s&&e?m=await O.updatePage(e,d):m=await O.createPage(d),m.success?n("/admin/pages"):o(m.error||"Грешка при запазване на страницата")}catch{o("Грешка при запазване на страницата")}finally{a(!1)}};return r&&s?t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("header",{className:"bg-white shadow-sm border-b",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"flex justify-between items-center py-6",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("button",{onClick:()=>n("/admin/pages"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[t.jsx(Ve,{className:"w-5 h-5"}),"Назад"]}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s?"Редактиране на страница":"Добавяне на нова страница"}),t.jsx("p",{className:"text-gray-600",children:s?"Редактирайте информацията за страницата":"Попълнете всички полета за новата страница"})]})]})})})}),t.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs("form",{onSubmit:h,className:"space-y-8",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Основна информация"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Заглавие *"}),t.jsx("input",{type:"text",value:d.title,onChange:g=>u("title",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Например: За нас",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL адрес *"}),t.jsx("input",{type:"text",value:d.slug,onChange:g=>u("slug",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"about",required:!0})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meta описание"}),t.jsx("input",{type:"text",value:d.meta_description,onChange:g=>u("meta_description",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Кратко описание за SEO"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Съдържание"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"HTML съдържание *"}),t.jsx("textarea",{value:d.content,onChange:g=>u("content",g.target.value),rows:20,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"<h2>Заглавие</h2><p>Съдържание...</p>",required:!0}),t.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Можете да използвате HTML тагове за форматиране на текста."})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Настройки"}),t.jsx("div",{children:t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:d.active,onChange:g=>u("active",g.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Активна страница"})]})})]}),i&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl",children:i}),t.jsxs("div",{className:"flex items-center justify-end gap-4",children:[t.jsx("button",{type:"button",onClick:()=>n("/admin/pages"),className:"px-6 py-3 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:"Отказ"}),t.jsx("button",{type:"submit",disabled:r,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:r?t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):t.jsxs(t.Fragment,{children:[t.jsx(xt,{className:"w-5 h-5"}),s?"Обнови страница":"Създай страница"]})})]})]})})]})},As={hero:"Главна секция",about:"За нас",services:"Услуги",testimonials:"Отзиви",contact:"Контакти",footer:"Футър",features:"Характеристики"},Da=()=>{const[n,e]=k.useState([]),[s,r]=k.useState(!0),[a,i]=k.useState(null),[o,d]=k.useState(""),[l,c]=k.useState("all");k.useEffect(()=>{u()},[l]);const u=async()=>{try{const p=l!=="all"?{type:l}:{},y=await O.getSections(p);y.success&&y.data?e(y.data):d(y.error||"Грешка при зареждане на секциите")}catch{d("Грешка при зареждане на секциите")}finally{r(!1)}},h=async p=>{try{const y=await O.deleteSection(p);y.success?(e(C=>C.filter(N=>N.id!==p)),i(null)):d(y.error||"Грешка при изтриване")}catch{d("Грешка при изтриване")}},g=async(p,y)=>{try{const C=await O.updateSection(p,{active:!y});C.success?e(N=>N.map(S=>S.id===p?{...S,active:!y}:S)):d(C.error||"Грешка при обновяване")}catch{d("Грешка при обновяване")}},m=async p=>{if(p===0)return;const y=[...n],C=y[p-1].sort_order;y[p-1].sort_order=y[p].sort_order,y[p].sort_order=C,[y[p-1],y[p]]=[y[p],y[p-1]],e(y),await b(y)},x=async p=>{if(p===n.length-1)return;const y=[...n],C=y[p+1].sort_order;y[p+1].sort_order=y[p].sort_order,y[p].sort_order=C,[y[p],y[p+1]]=[y[p+1],y[p]],e(y),await b(y)},b=async p=>{try{const y=p.map(C=>({id:C.id,sort_order:C.sort_order}));await O.updateSectionsSortOrder({sections:y})}catch{d("Грешка при обновяване на реда")}};return s?t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),t.jsx("div",{className:"space-y-4",children:[...Array(5)].map((p,y)=>t.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]},y))})]})}):t.jsxs("div",{className:"p-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Секции"}),t.jsxs("p",{className:"text-gray-600",children:["Управление на всички секции (",n.length," общо)"]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("select",{value:l,onChange:p=>c(p.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"all",children:"Всички типове"}),Object.entries(As).map(([p,y])=>t.jsx("option",{value:p,children:y},p))]}),t.jsxs(B,{to:"/admin/sections/new",className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg",children:[t.jsx(Re,{className:"w-5 h-5"}),"Добави секция"]})]})]}),o&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:o}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Секция"}),t.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Тип"}),t.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Страница"}),t.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Ред"}),t.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),t.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((p,y)=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:t.jsx("div",{className:"h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center",children:t.jsx(ms,{className:"w-5 h-5 text-purple-600"})})}),t.jsxs("div",{className:"ml-4",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:p.title}),t.jsxs("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:[p.content.replace(/<[^>]*>/g,"").substring(0,50),"..."]})]})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:As[p.section_type]||p.section_type})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:p.page_title||"Неизвестна"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm text-gray-900",children:p.sort_order}),t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("button",{onClick:()=>m(y),disabled:y===0,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",title:"Премести нагоре",children:t.jsx(yn,{className:"w-3 h-3"})}),t.jsx("button",{onClick:()=>x(y),disabled:y===n.length-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",title:"Премести надолу",children:t.jsx(vn,{className:"w-3 h-3"})})]})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${p.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:p.active?"Активна":"Неактивна"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(B,{to:`/admin/sections/${p.id}/edit`,className:"text-indigo-600 hover:text-indigo-900 p-1 rounded",title:"Редактиране",children:t.jsx(ft,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>g(p.id,p.active),className:`px-2 py-1 text-xs rounded ${p.active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,title:p.active?"Деактивирай":"Активирай",children:p.active?"Скрий":"Покажи"}),t.jsx("button",{onClick:()=>i(p.id),className:"text-red-600 hover:text-red-900 p-1 rounded",title:"Изтриване",children:t.jsx(pt,{className:"w-4 h-4"})})]})})]},p.id))})]})}),n.length===0&&!s&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(ms,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Няма секции"}),t.jsx("p",{className:"text-gray-500 mb-4",children:"Започнете като добавите първата секция"}),t.jsxs(B,{to:"/admin/sections/new",className:"inline-flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[t.jsx(Re,{className:"w-4 h-4"}),"Добави секция"]})]})]}),a&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Потвърждение за изтриване"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Сигурни ли сте, че искате да изтриете тази секция? Това действие не може да бъде отменено."}),t.jsxs("div",{className:"flex gap-3 justify-end",children:[t.jsx("button",{onClick:()=>i(null),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Отказ"}),t.jsx("button",{onClick:()=>h(a),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Изтрий"})]})]})})]})},Ma=[{value:"hero",label:"Главна секция"},{value:"about",label:"За нас"},{value:"services",label:"Услуги"},{value:"features",label:"Характеристики"},{value:"testimonials",label:"Отзиви"},{value:"contact",label:"Контакти"},{value:"footer",label:"Футър"}],Os=()=>{const n=je(),{id:e}=De(),s=!!e,[r,a]=k.useState(!1),[i,o]=k.useState(""),[d,l]=k.useState([]),[c,u]=k.useState({page_id:"page-001",title:"",content:"",section_type:"hero",sort_order:1,active:!0});k.useEffect(()=>{h(),s&&e&&g(e)},[s,e]);const h=async()=>{try{const b=await O.getPages();b.success&&b.data&&l(b.data)}catch(b){console.error("Error fetching pages:",b)}},g=async b=>{a(!0);try{const p=await O.getSection(b);p.success&&p.data?u({page_id:p.data.page_id,title:p.data.title,content:p.data.content,section_type:p.data.section_type,sort_order:p.data.sort_order||1,active:p.data.active,meta_data:p.data.meta_data}):o(p.error||"Грешка при зареждане на секцията")}catch{o("Грешка при зареждане на секцията")}finally{a(!1)}},m=(b,p)=>{u(y=>({...y,[b]:p}))},x=async b=>{b.preventDefault(),a(!0),o("");try{let p;s&&e?p=await O.updateSection(e,c):p=await O.createSection(c),p.success?n("/admin/sections"):o(p.error||"Грешка при запазване на секцията")}catch{o("Грешка при запазване на секцията")}finally{a(!1)}};return r&&s?t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("header",{className:"bg-white shadow-sm border-b",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"flex justify-between items-center py-6",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("button",{onClick:()=>n("/admin/sections"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[t.jsx(Ve,{className:"w-5 h-5"}),"Назад"]}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s?"Редактиране на секция":"Добавяне на нова секция"}),t.jsx("p",{className:"text-gray-600",children:s?"Редактирайте информацията за секцията":"Попълнете всички полета за новата секция"})]})]})})})}),t.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs("form",{onSubmit:x,className:"space-y-8",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Основна информация"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Заглавие *"}),t.jsx("input",{type:"text",value:c.title,onChange:b=>m("title",b.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Например: Главна секция",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Тип секция *"}),t.jsx("select",{value:c.section_type,onChange:b=>m("section_type",b.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:Ma.map(b=>t.jsx("option",{value:b.value,children:b.label},b.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Страница *"}),t.jsx("select",{value:c.page_id,onChange:b=>m("page_id",b.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:d.map(b=>t.jsx("option",{value:b.id,children:b.title},b.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ред на показване"}),t.jsx("input",{type:"number",value:c.sort_order,onChange:b=>m("sort_order",Number(b.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1"})]}),t.jsx("div",{className:"flex items-center",children:t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:c.active,onChange:b=>m("active",b.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Активна секция"})]})})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Съдържание"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"HTML съдържание *"}),t.jsx("textarea",{value:c.content,onChange:b=>m("content",b.target.value),rows:15,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"<h2>Заглавие</h2><p>Съдържание...</p>",required:!0}),t.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Можете да използвате HTML тагове за форматиране на текста."})]})]}),i&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl",children:i}),t.jsxs("div",{className:"flex items-center justify-end gap-4",children:[t.jsx("button",{type:"button",onClick:()=>n("/admin/sections"),className:"px-6 py-3 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:"Отказ"}),t.jsx("button",{type:"submit",disabled:r,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:r?t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):t.jsxs(t.Fragment,{children:[t.jsx(xt,{className:"w-5 h-5"}),s?"Обнови секция":"Създай секция"]})})]})]})})]})},Ua="modulepreload",Fa=function(n){return"/"+n},Is={},Ye=function(e,s,r){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),d=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(s.map(l=>{if(l=Fa(l),l in Is)return;Is[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Ua,c||(h.as="script"),h.crossOrigin="",h.href=l,d&&h.setAttribute("nonce",d),document.head.appendChild(h),c)return new Promise((g,m)=>{h.addEventListener("load",g),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=o,window.dispatchEvent(d),!d.defaultPrevented)throw o}return a.then(o=>{for(const d of o||[])d.status==="rejected"&&i(d.reason);return e().catch(i)})},Ba=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...s)=>Ye(async()=>{const{default:r}=await Promise.resolve().then(()=>Me);return{default:r}},void 0).then(({default:r})=>r(...s)):e=fetch,(...s)=>e(...s)};class ls extends Error{constructor(e,s="FunctionsError",r){super(e),this.name=s,this.context=r}}class Ha extends ls{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class $s extends ls{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Rs extends ls{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Wt;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Wt||(Wt={}));var qa=function(n,e,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function d(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(d,l)}c((r=r.apply(n,e||[])).next())})};class za{constructor(e,{headers:s={},customFetch:r,region:a=Wt.Any}={}){this.url=e,this.headers=s,this.region=a,this.fetch=Ba(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,s={}){var r;return qa(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=s;let d={},{region:l}=s;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(d["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(d["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(d["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),a),body:u}).catch(b=>{throw new Ha(b)}),g=h.headers.get("x-relay-error");if(g&&g==="true")throw new $s(h);if(!h.ok)throw new Rs(h);let m=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),x;return m==="application/json"?x=yield h.json():m==="application/octet-stream"?x=yield h.blob():m==="text/event-stream"?x=h:m==="multipart/form-data"?x=yield h.formData():x=yield h.text(),{data:x,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof Rs||a instanceof $s?a.context:void 0}}})}}var Y={},cs={},yt={},Ze={},vt={},wt={},Wa=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Le=Wa();const Ga=Le.fetch,Tr=Le.fetch.bind(Le),Pr=Le.Headers,Ja=Le.Request,Ka=Le.Response,Me=Object.freeze(Object.defineProperty({__proto__:null,Headers:Pr,Request:Ja,Response:Ka,default:Tr,fetch:Ga},Symbol.toStringTag,{value:"Module"})),Va=rn(Me);var jt={};Object.defineProperty(jt,"__esModule",{value:!0});let Qa=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};jt.default=Qa;var Ar=ee&&ee.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(wt,"__esModule",{value:!0});const Ya=Ar(Va),Za=Ar(jt);let Xa=class{constructor(e){var s,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(s=e.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Ya.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,s){return this.headers=new Headers(this.headers),this.headers.set(e,s),this}then(e,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,d,l,c;let u=null,h=null,g=null,m=i.status,x=i.statusText;if(i.ok){if(this.method!=="HEAD"){const C=await i.text();C===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?h=C:h=JSON.parse(C))}const p=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),y=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");p&&y&&y.length>1&&(g=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,g=null,m=406,x="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const p=await i.text();try{u=JSON.parse(p),Array.isArray(u)&&i.status===404&&(h=[],u=null,m=200,x="OK")}catch{i.status===404&&p===""?(m=204,x="No Content"):u={message:p}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,m=200,x="OK"),u&&this.shouldThrowOnError)throw new Za.default(u)}return{error:u,data:h,count:g,status:m,statusText:x}});return this.shouldThrowOnError||(a=a.catch(i=>{var o,d,l;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(d=i==null?void 0:i.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,s)}returns(){return this}overrideTypes(){return this}};wt.default=Xa;var ei=ee&&ee.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(vt,"__esModule",{value:!0});const ti=ei(wt);let si=class extends ti.default{select(e){let s=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:s=!0,nullsFirst:r,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",d=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${d?`${d},`:""}${e}.${s?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:s,referencedTable:r=s}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,s,{foreignTable:r,referencedTable:a=r}={}){const i=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${s-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:s=!1,settings:r=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var d;const l=[e?"analyze":null,s?"verbose":null,r?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};vt.default=si;var ri=ee&&ee.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ze,"__esModule",{value:!0});const ni=ri(vt);let ai=class extends ni.default{eq(e,s){return this.url.searchParams.append(e,`eq.${s}`),this}neq(e,s){return this.url.searchParams.append(e,`neq.${s}`),this}gt(e,s){return this.url.searchParams.append(e,`gt.${s}`),this}gte(e,s){return this.url.searchParams.append(e,`gte.${s}`),this}lt(e,s){return this.url.searchParams.append(e,`lt.${s}`),this}lte(e,s){return this.url.searchParams.append(e,`lte.${s}`),this}like(e,s){return this.url.searchParams.append(e,`like.${s}`),this}likeAllOf(e,s){return this.url.searchParams.append(e,`like(all).{${s.join(",")}}`),this}likeAnyOf(e,s){return this.url.searchParams.append(e,`like(any).{${s.join(",")}}`),this}ilike(e,s){return this.url.searchParams.append(e,`ilike.${s}`),this}ilikeAllOf(e,s){return this.url.searchParams.append(e,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(e,s){return this.url.searchParams.append(e,`ilike(any).{${s.join(",")}}`),this}is(e,s){return this.url.searchParams.append(e,`is.${s}`),this}in(e,s){const r=Array.from(new Set(s)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,s){return typeof s=="string"?this.url.searchParams.append(e,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(e,`cs.{${s.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(s)}`),this}containedBy(e,s){return typeof s=="string"?this.url.searchParams.append(e,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(e,`cd.{${s.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(s)}`),this}rangeGt(e,s){return this.url.searchParams.append(e,`sr.${s}`),this}rangeGte(e,s){return this.url.searchParams.append(e,`nxl.${s}`),this}rangeLt(e,s){return this.url.searchParams.append(e,`sl.${s}`),this}rangeLte(e,s){return this.url.searchParams.append(e,`nxr.${s}`),this}rangeAdjacent(e,s){return this.url.searchParams.append(e,`adj.${s}`),this}overlaps(e,s){return typeof s=="string"?this.url.searchParams.append(e,`ov.${s}`):this.url.searchParams.append(e,`ov.{${s.join(",")}}`),this}textSearch(e,s,{config:r,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${s}`),this}match(e){return Object.entries(e).forEach(([s,r])=>{this.url.searchParams.append(s,`eq.${r}`)}),this}not(e,s,r){return this.url.searchParams.append(e,`not.${s}.${r}`),this}or(e,{foreignTable:s,referencedTable:r=s}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,s,r){return this.url.searchParams.append(e,`${s}.${r}`),this}};Ze.default=ai;var ii=ee&&ee.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(yt,"__esModule",{value:!0});const He=ii(Ze);let oi=class{constructor(e,{headers:s={},schema:r,fetch:a}){this.url=e,this.headers=new Headers(s),this.schema=r,this.fetch=a}select(e,{head:s=!1,count:r}={}){const a=s?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(d=>/\s/.test(d)&&!i?"":(d==='"'&&(i=!i),d)).join("");return this.url.searchParams.set("select",o),r&&this.headers.append("Prefer",`count=${r}`),new He.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:s,defaultToNull:r=!0}={}){var a;const i="POST";if(s&&this.headers.append("Prefer",`count=${s}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((d,l)=>d.concat(Object.keys(l)),[]);if(o.length>0){const d=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",d.join(","))}}return new He.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(e,{onConflict:s,ignoreDuplicates:r=!1,count:a,defaultToNull:i=!0}={}){var o;const d="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new He.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:s}={}){var r;const a="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new He.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var s;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new He.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};yt.default=oi;var Or=ee&&ee.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cs,"__esModule",{value:!0});const li=Or(yt),ci=Or(Ze);let di=class Ir{constructor(e,{headers:s={},schema:r,fetch:a}={}){this.url=e,this.headers=new Headers(s),this.schemaName=r,this.fetch=a}from(e){const s=new URL(`${this.url}/${e}`);return new li.default(s,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Ir(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,s={},{head:r=!1,get:a=!1,count:i}={}){var o;let d;const l=new URL(`${this.url}/rpc/${e}`);let c;r||a?(d=r?"HEAD":"GET",Object.entries(s).filter(([h,g])=>g!==void 0).map(([h,g])=>[h,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([h,g])=>{l.searchParams.append(h,g)})):(d="POST",c=s);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new ci.default({method:d,url:l,headers:u,schema:this.schemaName,body:c,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};cs.default=di;var Ue=ee&&ee.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Y,"__esModule",{value:!0});Y.PostgrestError=Y.PostgrestBuilder=Y.PostgrestTransformBuilder=Y.PostgrestFilterBuilder=Y.PostgrestQueryBuilder=Y.PostgrestClient=void 0;const $r=Ue(cs);Y.PostgrestClient=$r.default;const Rr=Ue(yt);Y.PostgrestQueryBuilder=Rr.default;const Lr=Ue(Ze);Y.PostgrestFilterBuilder=Lr.default;const Dr=Ue(vt);Y.PostgrestTransformBuilder=Dr.default;const Mr=Ue(wt);Y.PostgrestBuilder=Mr.default;const Ur=Ue(jt);Y.PostgrestError=Ur.default;var ui=Y.default={PostgrestClient:$r.default,PostgrestQueryBuilder:Rr.default,PostgrestFilterBuilder:Lr.default,PostgrestTransformBuilder:Dr.default,PostgrestBuilder:Mr.default,PostgrestError:Ur.default};const{PostgrestClient:hi,PostgrestQueryBuilder:yl,PostgrestFilterBuilder:vl,PostgrestTransformBuilder:wl,PostgrestBuilder:jl,PostgrestError:_l}=ui;class gi{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const r=s.node,a=parseInt(r.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let s=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(s+=`

Suggested solution: ${e.workaround}`),new Error(s)}static createWebSocket(e,s){const r=this.getWebSocketConstructor();return new r(e,s)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const mi="2.15.5",fi=`realtime-js/${mi}`,pi="1.0.0",Gt=1e4,xi=1e3,bi=100;var ze;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(ze||(ze={}));var G;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(G||(G={}));var se;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(se||(se={}));var Jt;(function(n){n.websocket="websocket"})(Jt||(Jt={}));var xe;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(xe||(xe={}));class yi{constructor(){this.HEADER_LENGTH=1}decode(e,s){return e.constructor===ArrayBuffer?s(this._binaryDecode(e)):s(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const s=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,s,r)}_decodeBroadcast(e,s,r){const a=s.getUint8(1),i=s.getUint8(2);let o=this.HEADER_LENGTH+2;const d=r.decode(e.slice(o,o+a));o=o+a;const l=r.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:d,event:l,payload:c}}}class Fr{constructor(e,s){this.callback=e,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var F;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(F||(F={}));const Ls=(n,e,s={})=>{var r;const a=(r=s.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=vi(o,n,e,a),i),{})},vi=(n,e,s,r)=>{const a=e.find(d=>d.name===n),i=a==null?void 0:a.type,o=s[n];return i&&!r.includes(i)?Br(i,o):Kt(o)},Br=(n,e)=>{if(n.charAt(0)==="_"){const s=n.slice(1,n.length);return Ni(e,s)}switch(n){case F.bool:return wi(e);case F.float4:case F.float8:case F.int2:case F.int4:case F.int8:case F.numeric:case F.oid:return ji(e);case F.json:case F.jsonb:return _i(e);case F.timestamp:return Si(e);case F.abstime:case F.date:case F.daterange:case F.int4range:case F.int8range:case F.money:case F.reltime:case F.text:case F.time:case F.timestamptz:case F.timetz:case F.tsrange:case F.tstzrange:return Kt(e);default:return Kt(e)}},Kt=n=>n,wi=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},ji=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},_i=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Ni=(n,e)=>{if(typeof n!="string")return n;const s=n.length-1,r=n[s];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,s);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(d=>Br(e,d))}return n},Si=n=>typeof n=="string"?n.replace(" ","T"):n,Hr=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Ct{constructor(e,s,r={},a=Gt){this.channel=e,this.event=s,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,s){var r;return this._hasReceived(e)&&s((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:s}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(s))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ds;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Ds||(Ds={}));class We{constructor(e,s){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:o,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=We.syncState(this.state,a,i,o),this.pendingDiffs.forEach(l=>{this.state=We.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],d()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=We.syncDiff(this.state,a,i,o),d())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,s,r,a){const i=this.cloneDeep(e),o=this.transformState(s),d={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const g=u.map(p=>p.presence_ref),m=h.map(p=>p.presence_ref),x=u.filter(p=>m.indexOf(p.presence_ref)<0),b=h.filter(p=>g.indexOf(p.presence_ref)<0);x.length>0&&(d[c]=x),b.length>0&&(l[c]=b)}else d[c]=u}),this.syncDiff(i,{joins:d,leaves:l},r,a)}static syncDiff(e,s,r,a){const{joins:i,leaves:o}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(d,l)=>{var c;const u=(c=e[d])!==null&&c!==void 0?c:[];if(e[d]=this.cloneDeep(l),u.length>0){const h=e[d].map(m=>m.presence_ref),g=u.filter(m=>h.indexOf(m.presence_ref)<0);e[d].unshift(...g)}r(d,u,l)}),this.map(o,(d,l)=>{let c=e[d];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[d]=c,a(d,c,l),c.length===0&&delete e[d]}),e}static map(e,s){return Object.getOwnPropertyNames(e).map(r=>s(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((s,r)=>{const a=e[r];return"metas"in a?s[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):s[r]=a,s},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ms;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Ms||(Ms={}));var Ge;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Ge||(Ge={}));var oe;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(oe||(oe={}));class ds{constructor(e,s={config:{}},r){this.topic=e,this.params=s,this.socket=r,this.bindings={},this.state=G.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new Ct(this,se.join,this.params,this.timeout),this.rejoinTimer=new Fr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=G.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=G.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=G.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=G.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=G.errored,this.rejoinTimer.scheduleTimeout())}),this._on(se.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new We(this),this.broadcastEndpointURL=Hr(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,s=this.timeout){var r,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==G.closed){const{config:{broadcast:o,presence:d,private:l}}=this.params,c=(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(m=>m.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[Ge.PRESENCE]&&this.bindings[Ge.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},g={broadcast:o,presence:Object.assign(Object.assign({},d),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(oe.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(oe.CLOSED)),this.updateJoinPayload(Object.assign({config:g},h)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:m})=>{var x;if(this.socket.setAuth(),m===void 0){e==null||e(oe.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,p=(x=b==null?void 0:b.length)!==null&&x!==void 0?x:0,y=[];for(let C=0;C<p;C++){const N=b[C],{filter:{event:S,schema:j,table:w,filter:T}}=N,I=m&&m[C];if(I&&I.event===S&&I.schema===j&&I.table===w&&I.filter===T)y.push(Object.assign(Object.assign({},N),{id:I.id}));else{this.unsubscribe(),this.state=G.errored,e==null||e(oe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(oe.SUBSCRIBED);return}}).receive("error",m=>{this.state=G.errored,e==null||e(oe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(oe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,s={}){return await this.send({type:"presence",event:"track",payload:e},s.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,s,r){return this.state===G.joined&&e===Ge.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,s,r)}async send(e,s={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,d,l;const c=this._push(e.type,e,s.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(d=(o=this.params)===null||o===void 0?void 0:o.config)===null||d===void 0?void 0:d.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=G.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(se.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new Ct(this,se.leave,{},e),r.receive("ok",()=>{s(),a("ok")}).receive("timeout",()=>{s(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=G.closed,this.bindings={}}async _fetchWithTimeout(e,s,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},s),{signal:a.signal}));return clearTimeout(i),o}_push(e,s,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Ct(this,e,s,r);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>bi){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(e,s,r){return s}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,s,r){var a,i;const o=e.toLocaleLowerCase(),{close:d,error:l,leave:c,join:u}=se;if(r&&[d,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let g=this._onMessage(o,s,r);if(s&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(m=>{var x,b,p;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((p=(b=m.filter)===null||b===void 0?void 0:b.event)===null||p===void 0?void 0:p.toLocaleLowerCase())===o}).map(m=>m.callback(g,r)):(i=this.bindings[o])===null||i===void 0||i.filter(m=>{var x,b,p,y,C,N;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const S=m.id,j=(x=m.filter)===null||x===void 0?void 0:x.event;return S&&((b=s.ids)===null||b===void 0?void 0:b.includes(S))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((p=s.data)===null||p===void 0?void 0:p.type.toLocaleLowerCase()))}else{const S=(C=(y=m==null?void 0:m.filter)===null||y===void 0?void 0:y.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return S==="*"||S===((N=s==null?void 0:s.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof g=="object"&&"ids"in g){const x=g.data,{schema:b,table:p,commit_timestamp:y,type:C,errors:N}=x;g=Object.assign(Object.assign({},{schema:b,table:p,commit_timestamp:y,eventType:C,new:{},old:{},errors:N}),this._getPayloadRecords(x))}m.callback(g,r)})}_isClosed(){return this.state===G.closed}_isJoined(){return this.state===G.joined}_isJoining(){return this.state===G.joining}_isLeaving(){return this.state===G.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,s,r){const a=e.toLocaleLowerCase(),i={type:a,filter:s,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,s){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&ds.isEqual(a.filter,s))})),this}static isEqual(e,s){if(Object.keys(e).length!==Object.keys(s).length)return!1;for(const r in e)if(e[r]!==s[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(se.close,{},e)}_onError(e){this._on(se.error,{},s=>e(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=G.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const s={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(s.new=Ls(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(s.old=Ls(e.columns,e.old_record)),s}}const Tt=()=>{},rt={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ki=[1e3,2e3,5e3,1e4],Ei=1e4,Ci=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ti{constructor(e,s){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Gt,this.transport=null,this.heartbeatIntervalMs=rt.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Tt,this.ref=0,this.reconnectTimer=null,this.logger=Tt,this.conn=null,this.sendBuffer=[],this.serializer=new yi,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>Ye(async()=>{const{default:d}=await Promise.resolve().then(()=>Me);return{default:d}},void 0).then(({default:d})=>d(...o)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((r=s==null?void 0:s.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${e}/${Jt.websocket}`,this.httpEndpoint=Hr(e),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s==null?void 0:s.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=gi.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const s=e.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:pi}))}disconnect(e,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,s??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const s=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const e=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,s,r){this.logger(e,s,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ze.connecting:return xe.Connecting;case ze.open:return xe.Open;case ze.closing:return xe.Closing;default:return xe.Closed}}isConnected(){return this.connectionState()===xe.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,s={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new ds(`realtime:${e}`,s,this);return this.channels.push(i),i}}push(e){const{topic:s,event:r,payload:a,ref:i}=e,o=()=>{this.encode(e,d=>{var l;(l=this.conn)===null||l===void 0||l.send(d)})};this.log("push",`${s} ${r} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(xi,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},rt.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let s=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${e}"`),s.unsubscribe())}_remove(e){this.channels=this.channels.filter(s=>s.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:a,payload:i,ref:o}=s,d=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${r} ${a} ${d}`.trim(),i),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(a,i,o)),this._triggerStateCallbacks("message",s)})}_clearTimer(e){var s;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var s;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(se.error))}_appendParams(e,s){if(Object.keys(s).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(s);return`${e}${r}${a}`}_workerObjectUrl(e){let s;if(e)s=e;else{const r=new Blob([Ci],{type:"application/javascript"});s=URL.createObjectURL(r)}return s}_setConnectionState(e,s=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(e=null){let s;e?s=e:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(r=>{const a={access_token:s,version:fi};s&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(se.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${e}`,s)})}_triggerStateCallbacks(e,s){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(s)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Fr(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},rt.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var s,r,a,i,o,d,l,c,u;if(this.transport=(s=e==null?void 0:e.transport)!==null&&s!==void 0?s:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:Gt,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:rt.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(d=e==null?void 0:e.heartbeatCallback)!==null&&d!==void 0?d:Tt,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:h=>ki[h-1]||Ei,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(h,g)=>g(JSON.stringify(h)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class us extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function J(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Pi extends us{constructor(e,s,r){super(e),this.name="StorageApiError",this.status=s,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Vt extends us{constructor(e,s){super(e),this.name="StorageUnknownError",this.originalError=s}}var Ai=function(n,e,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function d(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(d,l)}c((r=r.apply(n,e||[])).next())})};const qr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...s)=>Ye(async()=>{const{default:r}=await Promise.resolve().then(()=>Me);return{default:r}},void 0).then(({default:r})=>r(...s)):e=fetch,(...s)=>e(...s)},Oi=()=>Ai(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ye(()=>Promise.resolve().then(()=>Me),void 0)).Response:Response}),Qt=n=>{if(Array.isArray(n))return n.map(s=>Qt(s));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([s,r])=>{const a=s.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=Qt(r)}),e},Ii=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var _e=function(n,e,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function d(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(d,l)}c((r=r.apply(n,e||[])).next())})};const Pt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),$i=(n,e,s)=>_e(void 0,void 0,void 0,function*(){const r=yield Oi();n instanceof r&&!(s!=null&&s.noResolveJson)?n.json().then(a=>{const i=n.status||500,o=(a==null?void 0:a.statusCode)||i+"";e(new Pi(Pt(a),i,o))}).catch(a=>{e(new Vt(Pt(a),a))}):e(new Vt(Pt(n),n))}),Ri=(n,e,s,r)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!r?a:(Ii(r)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(r)):a.body=r,e!=null&&e.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),s))};function Xe(n,e,s,r,a,i){return _e(this,void 0,void 0,function*(){return new Promise((o,d)=>{n(s,Ri(e,r,a,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>$i(l,d,r))})})}function gt(n,e,s,r){return _e(this,void 0,void 0,function*(){return Xe(n,"GET",e,s,r)})}function ae(n,e,s,r,a){return _e(this,void 0,void 0,function*(){return Xe(n,"POST",e,r,a,s)})}function Yt(n,e,s,r,a){return _e(this,void 0,void 0,function*(){return Xe(n,"PUT",e,r,a,s)})}function Li(n,e,s,r){return _e(this,void 0,void 0,function*(){return Xe(n,"HEAD",e,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)})}function zr(n,e,s,r,a){return _e(this,void 0,void 0,function*(){return Xe(n,"DELETE",e,r,a,s)})}var V=function(n,e,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function d(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(d,l)}c((r=r.apply(n,e||[])).next())})};const Di={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Us={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Mi{constructor(e,s={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=s,this.bucketId=r,this.fetch=qr(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,s,r,a){return V(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Us),a);let d=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=r,d["cache-control"]=`max-age=${o.cacheControl}`,d["content-type"]=o.contentType,l&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(d=Object.assign(Object.assign({},d),a.headers));const c=this._removeEmptyFolders(s),u=this._getFinalPath(c),h=yield(e=="PUT"?Yt:ae)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:d},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(J(i))return{data:null,error:i};throw i}})}upload(e,s,r){return V(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,s,r)})}uploadToSignedUrl(e,s,r,a){return V(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),d=new URL(this.url+`/object/upload/sign/${o}`);d.searchParams.set("token",s);try{let l;const c=Object.assign({upsert:Us.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield Yt(this.fetch,d.toString(),l,{headers:u});return{data:{path:i,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(J(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,s){return V(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);s!=null&&s.upsert&&(a["x-upsert"]="true");const i=yield ae(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),o=new URL(this.url+i.url),d=o.searchParams.get("token");if(!d)throw new us("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:d},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(J(r))return{data:null,error:r};throw r}})}update(e,s,r){return V(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,s,r)})}move(e,s,r){return V(this,void 0,void 0,function*(){try{return{data:yield ae(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(J(a))return{data:null,error:a};throw a}})}copy(e,s,r){return V(this,void 0,void 0,function*(){try{return{data:{path:(yield ae(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(J(a))return{data:null,error:a};throw a}})}createSignedUrl(e,s,r){return V(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield ae(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:s},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(J(a))return{data:null,error:a};throw a}})}createSignedUrls(e,s,r){return V(this,void 0,void 0,function*(){try{const a=yield ae(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(J(a))return{data:null,error:a};throw a}})}download(e,s){return V(this,void 0,void 0,function*(){const a=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),o=i?`?${i}`:"";try{const d=this._getFinalPath(e);return{data:yield(yield gt(this.fetch,`${this.url}/${a}/${d}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(J(d))return{data:null,error:d};throw d}})}info(e){return V(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{const r=yield gt(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:Qt(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(J(r))return{data:null,error:r};throw r}})}exists(e){return V(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{return yield Li(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(J(r)&&r instanceof Vt){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,s){const r=this._getFinalPath(e),a=[],i=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";i!==""&&a.push(i);const d=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${r}${c}`)}}}remove(e){return V(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(J(s))return{data:null,error:s};throw s}})}list(e,s,r){return V(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Di),s),{prefix:e||""});return{data:yield ae(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(J(a))return{data:null,error:a};throw a}})}listV2(e,s){return V(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield ae(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(J(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const s=[];return e.width&&s.push(`width=${e.width}`),e.height&&s.push(`height=${e.height}`),e.resize&&s.push(`resize=${e.resize}`),e.format&&s.push(`format=${e.format}`),e.quality&&s.push(`quality=${e.quality}`),s.join("&")}}const Ui="2.12.1",Fi={"X-Client-Info":`storage-js/${Ui}`};var Se=function(n,e,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function d(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(d,l)}c((r=r.apply(n,e||[])).next())})};class Bi{constructor(e,s={},r,a){this.shouldThrowOnError=!1;const i=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},Fi),s),this.fetch=qr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Se(this,void 0,void 0,function*(){try{return{data:yield gt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(J(e))return{data:null,error:e};throw e}})}getBucket(e){return Se(this,void 0,void 0,function*(){try{return{data:yield gt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(J(s))return{data:null,error:s};throw s}})}createBucket(e,s={public:!1}){return Se(this,void 0,void 0,function*(){try{return{data:yield ae(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(J(r))return{data:null,error:r};throw r}})}updateBucket(e,s){return Se(this,void 0,void 0,function*(){try{return{data:yield Yt(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(J(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Se(this,void 0,void 0,function*(){try{return{data:yield ae(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(J(s))return{data:null,error:s};throw s}})}deleteBucket(e){return Se(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(J(s))return{data:null,error:s};throw s}})}}class Hi extends Bi{constructor(e,s={},r,a){super(e,s,r,a)}from(e){return new Mi(this.url,this.headers,e,this.fetch)}}const qi="2.57.4";let qe="";typeof Deno<"u"?qe="deno":typeof document<"u"?qe="web":typeof navigator<"u"&&navigator.product==="ReactNative"?qe="react-native":qe="node";const zi={"X-Client-Info":`supabase-js-${qe}/${qi}`},Wi={headers:zi},Gi={schema:"public"},Ji={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ki={};var Vi=function(n,e,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function d(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(d,l)}c((r=r.apply(n,e||[])).next())})};const Qi=n=>{let e;return n?e=n:typeof fetch>"u"?e=Tr:e=fetch,(...s)=>e(...s)},Yi=()=>typeof Headers>"u"?Pr:Headers,Zi=(n,e,s)=>{const r=Qi(s),a=Yi();return(i,o)=>Vi(void 0,void 0,void 0,function*(){var d;const l=(d=yield e())!==null&&d!==void 0?d:n;let c=new a(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},o),{headers:c}))})};var Xi=function(n,e,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function d(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(d,l)}c((r=r.apply(n,e||[])).next())})};function eo(n){return n.endsWith("/")?n:n+"/"}function to(n,e){var s,r;const{db:a,auth:i,realtime:o,global:d}=n,{db:l,auth:c,realtime:u,global:h}=e,g={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),d),{headers:Object.assign(Object.assign({},(s=h==null?void 0:h.headers)!==null&&s!==void 0?s:{}),(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Xi(this,void 0,void 0,function*(){return""})};return n.accessToken?g.accessToken=n.accessToken:delete g.accessToken,g}function so(n){const e=n==null?void 0:n.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(eo(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Wr="2.71.1",Pe=30*1e3,Zt=3,At=Zt*Pe,ro="http://localhost:9999",no="supabase.auth.token",ao={"X-Client-Info":`gotrue-js/${Wr}`},Xt="X-Supabase-Api-Version",Gr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},io=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,oo=10*60*1e3;class hs extends Error{constructor(e,s,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=r}}function A(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class lo extends hs{constructor(e,s,r){super(e,s,r),this.name="AuthApiError",this.status=s,this.code=r}}function co(n){return A(n)&&n.name==="AuthApiError"}class Jr extends hs{constructor(e,s){super(e),this.name="AuthUnknownError",this.originalError=s}}class he extends hs{constructor(e,s,r,a){super(e,r,a),this.name=s,this.status=r}}class de extends he{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function uo(n){return A(n)&&n.name==="AuthSessionMissingError"}class nt extends he{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class at extends he{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class it extends he{constructor(e,s=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ho(n){return A(n)&&n.name==="AuthImplicitGrantRedirectError"}class Fs extends he{constructor(e,s=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class es extends he{constructor(e,s){super(e,"AuthRetryableFetchError",s,void 0)}}function Ot(n){return A(n)&&n.name==="AuthRetryableFetchError"}class Bs extends he{constructor(e,s,r){super(e,"AuthWeakPasswordError",s,"weak_password"),this.reasons=r}}class ts extends he{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Hs=` 	
\r=`.split(""),go=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Hs.length;e+=1)n[Hs[e].charCodeAt(0)]=-2;for(let e=0;e<mt.length;e+=1)n[mt[e].charCodeAt(0)]=e;return n})();function qs(n,e,s){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;s(mt[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;s(mt[r]),e.queuedBits-=6}}function Kr(n,e,s){const r=go[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)s(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function zs(n){const e=[],s=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{po(o,r,s)};for(let o=0;o<n.length;o+=1)Kr(n.charCodeAt(o),a,i);return e.join("")}function mo(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function fo(n,e){for(let s=0;s<n.length;s+=1){let r=n.charCodeAt(s);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(n.charCodeAt(s+1)-56320&65535|a)+65536,s+=1}mo(r,e)}}function po(n,e,s){if(e.utf8seq===0){if(n<=127){s(n);return}for(let r=1;r<6;r+=1)if(!(n>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&s(e.codepoint)}}function xo(n){const e=[],s={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<n.length;a+=1)Kr(n.charCodeAt(a),s,r);return new Uint8Array(e)}function bo(n){const e=[];return fo(n,s=>e.push(s)),new Uint8Array(e)}function yo(n){const e=[],s={queue:0,queuedBits:0},r=a=>{e.push(a)};return n.forEach(a=>qs(a,s,r)),qs(null,s,r),e.join("")}function vo(n){return Math.round(Date.now()/1e3)+n}function wo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const te=()=>typeof window<"u"&&typeof document<"u",me={tested:!1,writable:!1},Vr=()=>{if(!te())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(me.tested)return me.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),me.tested=!0,me.writable=!0}catch{me.tested=!0,me.writable=!1}return me.writable};function jo(n){const e={},s=new URL(n);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return s.searchParams.forEach((r,a)=>{e[a]=r}),e}const Qr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...s)=>Ye(async()=>{const{default:r}=await Promise.resolve().then(()=>Me);return{default:r}},void 0).then(({default:r})=>r(...s)):e=fetch,(...s)=>e(...s)},_o=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Ae=async(n,e,s)=>{await n.setItem(e,JSON.stringify(s))},fe=async(n,e)=>{const s=await n.getItem(e);if(!s)return null;try{return JSON.parse(s)}catch{return s}},ce=async(n,e)=>{await n.removeItem(e)};class _t{constructor(){this.promise=new _t.promiseConstructor((e,s)=>{this.resolve=e,this.reject=s})}}_t.promiseConstructor=Promise;function It(n){const e=n.split(".");if(e.length!==3)throw new ts("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!io.test(e[r]))throw new ts("JWT not in base64url format");return{header:JSON.parse(zs(e[0])),payload:JSON.parse(zs(e[1])),signature:xo(e[2]),raw:{header:e[0],payload:e[1]}}}async function No(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function So(n,e){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function ko(n){return("0"+n.toString(16)).substr(-2)}function Eo(){const e=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=s.length;let a="";for(let i=0;i<56;i++)a+=s.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,ko).join("")}async function Co(n){const s=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",s),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function To(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const s=await Co(n);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ke(n,e,s=!1){const r=Eo();let a=r;s&&(a+="/PASSWORD_RECOVERY"),await Ae(n,`${e}-code-verifier`,a);const i=await To(r);return[i,r===i?"plain":"s256"]}const Po=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ao(n){const e=n.headers.get(Xt);if(!e||!e.match(Po))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Oo(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function Io(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const $o=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ee(n){if(!$o.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function $t(){const n={};return new Proxy(n,{get:(e,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const r=s.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ws(n){return JSON.parse(JSON.stringify(n))}var Ro=function(n,e){var s={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(s[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(s[r[a]]=n[r[a]]);return s};const pe=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Lo=[502,503,504];async function Gs(n){var e;if(!_o(n))throw new es(pe(n),0);if(Lo.includes(n.status))throw new es(pe(n),n.status);let s;try{s=await n.json()}catch(i){throw new Jr(pe(i),i)}let r;const a=Ao(n);if(a&&a.getTime()>=Gr["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?r=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(r=s.error_code),r){if(r==="weak_password")throw new Bs(pe(s),n.status,((e=s.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new de}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Bs(pe(s),n.status,s.weak_password.reasons);throw new lo(pe(s),n.status||500,r)}const Do=(n,e,s,r)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),s))};async function D(n,e,s,r){var a;const i=Object.assign({},r==null?void 0:r.headers);i[Xt]||(i[Xt]=Gr["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const d=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Mo(n,e,s+d,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function Mo(n,e,s,r,a,i){const o=Do(e,r,a,i);let d;try{d=await n(s,Object.assign({},o))}catch(l){throw console.error(l),new es(pe(l),0)}if(d.ok||await Gs(d),r!=null&&r.noResolveJson)return d;try{return await d.json()}catch(l){await Gs(l)}}function ie(n){var e;let s=null;Ho(n)&&(s=Object.assign({},n),n.expires_at||(s.expires_at=vo(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:s,user:r},error:null}}function Js(n){const e=ie(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((s,r)=>s&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function ue(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Uo(n){return{data:n,error:null}}function Fo(n){const{action_link:e,email_otp:s,hashed_token:r,redirect_to:a,verification_type:i}=n,o=Ro(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:s,hashed_token:r,redirect_to:a,verification_type:i},l=Object.assign({},o);return{data:{properties:d,user:l},error:null}}function Bo(n){return n}function Ho(n){return n.access_token&&n.refresh_token&&n.expires_in}const Rt=["global","local","others"];var qo=function(n,e){var s={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(s[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(s[r[a]]=n[r[a]]);return s};class zo{constructor({url:e="",headers:s={},fetch:r}){this.url=e,this.headers=s,this.fetch=Qr(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,s=Rt[0]){if(Rt.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Rt.join(", ")}`);try{return await D(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(A(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,s={}){try{return await D(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:ue})}catch(r){if(A(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:s}=e,r=qo(e,["options"]),a=Object.assign(Object.assign({},r),s);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await D(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Fo,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(A(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(e){try{return await D(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ue})}catch(s){if(A(s))return{data:{user:null},error:s};throw s}}async listUsers(e){var s,r,a,i,o,d,l;try{const c={nextPage:null,lastPage:0,total:0},u=await D(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(s=e==null?void 0:e.page)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:Bo});if(u.error)throw u.error;const h=await u.json(),g=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(l=(d=u.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(x=>{const b=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(x.split(";")[1].split("=")[1]);c[`${p}Page`]=b}),c.total=parseInt(g)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(A(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Ee(e);try{return await D(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ue})}catch(s){if(A(s))return{data:{user:null},error:s};throw s}}async updateUserById(e,s){Ee(e);try{return await D(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:s,headers:this.headers,xform:ue})}catch(r){if(A(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,s=!1){Ee(e);try{return await D(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:s},xform:ue})}catch(r){if(A(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Ee(e.userId);try{const{data:s,error:r}=await D(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:s,error:r}}catch(s){if(A(s))return{data:null,error:s};throw s}}async _deleteFactor(e){Ee(e.userId),Ee(e.id);try{return{data:await D(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(s){if(A(s))return{data:null,error:s};throw s}}}function Ks(n={}){return{getItem:e=>n[e]||null,setItem:(e,s)=>{n[e]=s},removeItem:e=>{delete n[e]}}}function Wo(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ce={debug:!!(globalThis&&Vr()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Yr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Go extends Yr{}async function Jo(n,e,s){Ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Ce.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){Ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,a.name);try{return await s()}finally{Ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,a.name)}}else{if(e===0)throw Ce.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Go(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Ce.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}Wo();const Ko={url:ro,storageKey:no,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ao,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Vs(n,e,s){return await s()}const Te={};class Ke{constructor(e){var s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ke.nextInstanceID,Ke.nextInstanceID+=1,this.instanceID>0&&te()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Ko),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new zo({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Qr(a.fetch),this.lock=a.lock||Vs,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:te()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=Jo:this.lock=Vs,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Vr()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ks(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Ks(this.memoryStorage)),te()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,s;return(s=(e=Te[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(e){Te[this.storageKey]=Object.assign(Object.assign({},Te[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,s;return(s=(e=Te[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Te[this.storageKey]=Object.assign(Object.assign({},Te[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Wr}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const s=jo(window.location.href);let r="none";if(this._isImplicitGrantCallback(s)?r="implicit":await this._isPKCECallback(s)&&(r="pkce"),te()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(s,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),ho(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",d),await this._saveSession(o),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return A(s)?{error:s}:{error:new Jr("Unexpected error during initialization",s)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var s,r,a;try{const i=await D(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:ie}),{data:o,error:d}=i;if(d||!o)return{data:{user:null,session:null},error:d};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(A(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var s,r,a;try{let i;if("email"in e){const{email:u,password:h,options:g}=e;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await ke(this.storage,this.storageKey)),i=await D(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:u,password:h,data:(s=g==null?void 0:g.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:x},xform:ie})}else if("phone"in e){const{phone:u,password:h,options:g}=e;i=await D(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},channel:(a=g==null?void 0:g.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:ie})}else throw new at("You must provide either an email or phone number and a password");const{data:o,error:d}=i;if(d||!o)return{data:{user:null,session:null},error:d};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(A(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let s;if("email"in e){const{email:i,password:o,options:d}=e;s=await D(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Js})}else if("phone"in e){const{phone:i,password:o,options:d}=e;s=await D(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Js})}else throw new at("You must provide either an email or phone number and a password");const{data:r,error:a}=s;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new nt}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(s){if(A(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOAuth(e){var s,r,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:s}=e;if(s==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}async signInWithSolana(e){var s,r,a,i,o,d,l,c,u,h,g,m;let x,b;if("message"in e)x=e.message,b=e.signature;else{const{chain:p,wallet:y,statement:C,options:N}=e;let S;if(te())if(typeof y=="object")S=y;else{const w=window;if("solana"in w&&typeof w.solana=="object"&&("signIn"in w.solana&&typeof w.solana.signIn=="function"||"signMessage"in w.solana&&typeof w.solana.signMessage=="function"))S=w.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=y}const j=new URL((s=N==null?void 0:N.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in S&&S.signIn){const w=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),C?{statement:C}:null));let T;if(Array.isArray(w)&&w[0]&&typeof w[0]=="object")T=w[0];else if(w&&typeof w=="object"&&"signedMessage"in w&&"signature"in w)T=w;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)x=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),b=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${j.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(a=(r=N==null?void 0:N.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=N==null?void 0:N.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((o=N==null?void 0:N.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((d=N==null?void 0:N.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((l=N==null?void 0:N.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((c=N==null?void 0:N.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((h=(u=N==null?void 0:N.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...N.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const w=await S.signMessage(new TextEncoder().encode(x),"utf8");if(!w||!(w instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=w}}try{const{data:p,error:y}=await D(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:yo(b)},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:ie});if(y)throw y;return!p||!p.session||!p.user?{data:{user:null,session:null},error:new nt}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),{data:Object.assign({},p),error:y})}catch(p){if(A(p))return{data:{user:null,session:null},error:p};throw p}}async _exchangeCodeForSession(e){const s=await fe(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(s??"").split("/");try{const{data:i,error:o}=await D(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ie});if(await ce(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new nt}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(A(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:s,provider:r,token:a,access_token:i,nonce:o}=e,d=await D(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:ie}),{data:l,error:c}=d;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new nt}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(s){if(A(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(e){var s,r,a,i,o;try{if("email"in e){const{email:d,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await ke(this.storage,this.storageKey));const{error:h}=await D(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:d,options:l}=e,{data:c,error:u}=await D(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new at("You must provide either an email or phone number.")}catch(d){if(A(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(e){var s,r;try{let a,i;"options"in e&&(a=(s=e.options)===null||s===void 0?void 0:s.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:d}=await D(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:ie});if(d)throw d;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(A(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var s,r,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await ke(this.storage,this.storageKey)),await D(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(s=e.options)===null||s===void 0?void 0:s.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Uo})}catch(i){if(A(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:s},error:r}=e;if(r)throw r;if(!s)throw new de;const{error:a}=await D(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(A(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const s=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:i}=e,{error:o}=await D(this.fetch,"POST",s,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:a,options:i}=e,{data:o,error:d}=await D(this.fetch,"POST",s,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:d}}throw new at("You must provide either an email or phone number and a type")}catch(s){if(A(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(e,s){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await s()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=s();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await e(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const s=await fe(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?e=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<At:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await fe(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=$t()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await D(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ue}):await this._useSession(async s=>{var r,a,i;const{data:o,error:d}=s;if(d)throw d;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new de}:await D(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:ue})})}catch(s){if(A(s))return uo(s)&&(await this._removeSession(),await ce(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(e,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,s))}async _updateUser(e,s={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new de;const o=a.session;let d=null,l=null;this.flowType==="pkce"&&e.email!=null&&([d,l]=await ke(this.storage,this.storageKey));const{data:c,error:u}=await D(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:l}),jwt:o.access_token,xform:ue});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(A(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new de;const s=Date.now()/1e3;let r=s,a=!0,i=null;const{payload:o}=It(e.access_token);if(o.exp&&(r=o.exp,a=r<=s),a){const{session:d,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!d)return{data:{user:null,session:null},error:null};i=d}else{const{data:d,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:r-s,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(s){if(A(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async s=>{var r;if(!e){const{data:o,error:d}=s;if(d)throw d;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new de;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(A(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(e,s){try{if(!te())throw new it("No browser detected.");if(e.error||e.error_description||e.error_code)throw new it(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Fs("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new it("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Fs("No code detected.");const{data:C,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:d,expires_at:l,token_type:c}=e;if(!i||!d||!o||!c)throw new it("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(d);let g=u+h;l&&(g=parseInt(l));const m=g-u;m*1e3<=Pe&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const x=g-h;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,g,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,g,u);const{data:b,error:p}=await this._getUser(i);if(p)throw p;const y={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:g,refresh_token:o,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(r){if(A(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const s=await fe(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&s)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async s=>{var r;const{data:a,error:i}=s;if(i)return{error:i};const o=(r=a.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:d}=await this.admin.signOut(o,e);if(d&&!(co(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return e!=="others"&&(await this._removeSession(),await ce(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const s=wo(),r={id:s,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async s=>{var r,a;try{const{data:{session:i},error:o}=s;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,s={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await ke(this.storage,this.storageKey,!0));try{return await D(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(i){if(A(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:s,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=s.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(s){if(A(s))return{data:null,error:s};throw s}}async linkIdentity(e){var s;try{const{data:r,error:a}=await this._useSession(async i=>{var o,d,l,c,u;const{data:h,error:g}=i;if(g)throw g;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await D(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return te()&&!(!((s=e.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(A(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async s=>{var r,a;const{data:i,error:o}=s;if(o)throw o;return await D(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(s){if(A(s))return{data:null,error:s};throw s}}async _refreshAccessToken(e){const s=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{const r=Date.now();return await So(async a=>(a>0&&await No(200*Math.pow(2,a-1)),this._debug(s,"refreshing attempt",a),await D(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ie})),(a,i)=>{const o=200*Math.pow(2,a);return i&&Ot(i)&&Date.now()+o-r<Pe})}catch(r){if(this._debug(s,"error",r),A(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(s,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,s){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",s,"url",r),te()&&!s.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,s;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await fe(this.storage,this.storageKey);if(a&&this.userStorage){let o=await fe(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await Ae(this.userStorage,this.storageKey+"-user",o)),a.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:$t()}else if(a&&!a.user&&!a.user){const o=await fe(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await ce(this.storage,this.storageKey+"-user"),await Ae(this.storage,this.storageKey,a)):a.user=$t()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const i=((s=a.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<At;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${At}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),Ot(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:d}=await this._getUser(a.access_token);!d&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var s,r;if(!e)throw new de;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new _t;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new de;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const d={session:i.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(i){if(this._debug(a,"error",i),A(i)){const o={session:null,error:i};return Ot(i)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,s,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",s,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:s});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,s)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let d=0;d<i.length;d+=1)console.error(i[d]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const s=Object.assign({},e),r=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&s.user&&await Ae(this.userStorage,this.storageKey+"-user",{user:s.user});const a=Object.assign({},s);delete a.user;const i=Ws(a);await Ae(this.storage,this.storageKey,i)}else{const a=Ws(s);await Ae(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await ce(this.storage,this.storageKey),await ce(this.storage,this.storageKey+"-code-verifier"),await ce(this.storage,this.storageKey+"-user"),this.userStorage&&await ce(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&te()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Pe);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async s=>{const{data:{session:r}}=s;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/Pe);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Pe}ms, refresh threshold is ${Zt} ticks`),a<=Zt&&await this._callRefreshToken(r.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Yr)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!te()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const s=`#_onVisibilityChanged(${e})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,s,r){const a=[`provider=${encodeURIComponent(s)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await ke(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(d.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async s=>{var r;const{data:a,error:i}=s;return i?{data:null,error:i}:await D(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(A(s))return{data:null,error:s};throw s}}async _enroll(e){try{return await this._useSession(async s=>{var r,a;const{data:i,error:o}=s;if(o)return{data:null,error:o};const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await D(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(s){if(A(s))return{data:null,error:s};throw s}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:a,error:i}=s;if(i)return{data:null,error:i};const{data:o,error:d}=await D(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:d})})}catch(s){if(A(s))return{data:null,error:s};throw s}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:a,error:i}=s;return i?{data:null,error:i}:await D(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(A(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(e){const{data:s,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:s.id,code:e.code})}async _listFactors(){const{data:{user:e},error:s}=await this.getUser();if(s)return{data:null,error:s};const r=(e==null?void 0:e.factors)||[],a=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var s,r;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=It(a.access_token);let d=null;o.aal&&(d=o.aal);let l=d;((r=(s=a.user.factors)===null||s===void 0?void 0:s.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:d,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,s={keys:[]}){let r=s.keys.find(d=>d.kid===e);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(d=>d.kid===e),r&&this.jwks_cached_at+oo>a)return r;const{data:i,error:o}=await D(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,r=i.keys.find(d=>d.kid===e),!r)?null:r}async getClaims(e,s={}){try{let r=e;if(!r){const{data:m,error:x}=await this.getSession();if(x||!m.session)return{data:null,error:x};r=m.session.access_token}const{header:a,payload:i,signature:o,raw:{header:d,payload:l}}=It(r);s!=null&&s.allowExpired||Oo(i.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,s!=null&&s.keys?{keys:s.keys}:s==null?void 0:s.jwks);if(!c){const{error:m}=await this.getUser(r);if(m)throw m;return{data:{claims:i,header:a,signature:o},error:null}}const u=Io(a.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,bo(`${d}.${l}`)))throw new ts("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(r){if(A(r))return{data:null,error:r};throw r}}}Ke.nextInstanceID=0;const Vo=Ke;class Qo extends Vo{constructor(e){super(e)}}var Yo=function(n,e,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function d(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(d,l)}c((r=r.apply(n,e||[])).next())})};class Zo{constructor(e,s,r){var a,i,o;this.supabaseUrl=e,this.supabaseKey=s;const d=so(e);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const l=`sb-${d.hostname.split(".")[0]}-auth-token`,c={db:Gi,realtime:Ki,auth:Object.assign(Object.assign({},Ji),{storageKey:l}),global:Wi},u=to(r??{},c);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=Zi(s,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new hi(new URL("rest/v1",d).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Hi(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new za(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,s={},r={}){return this.rest.rpc(e,s,r)}channel(e,s={config:{}}){return this.realtime.channel(e,s)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,s;return Yo(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(s=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&s!==void 0?s:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:s,detectSessionInUrl:r,storage:a,userStorage:i,storageKey:o,flowType:d,lock:l,debug:c},u,h){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Qo({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),u),storageKey:o,autoRefreshToken:e,persistSession:s,detectSessionInUrl:r,storage:a,userStorage:i,flowType:d,lock:l,debug:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Ti(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,r)=>{this._handleTokenChanged(s,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,s,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Xo=(n,e,s)=>new Zo(n,e,s);function el(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}el()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const tl="https://mveeovfztfczibtvkpas.supabase.co",sl="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im12ZWVvdmZ6dGZjemlidHZrcGFzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxNzc1NDMsImV4cCI6MjA3Mjc1MzU0M30.XMAd9FCnLt57L_HgE3BLkGj1oURCvD7ay9B2SJBhtDI",Q=Xo(tl,sl,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},realtime:{params:{eventsPerSecond:10}}});console.log("Supabase client initialized successfully");class rl{async getProperties(e,s=1,r=16){try{let a=Q.from("properties").select(`
          *,
          images:property_images(*)
        `).eq("active",!0).order("featured",{ascending:!1}).order("created_at",{ascending:!1});e!=null&&e.keyword&&(a=a.or(`title.ilike.%${e.keyword}%,description.ilike.%${e.keyword}%,district.ilike.%${e.keyword}%`)),e!=null&&e.transaction_type&&(a=a.eq("transaction_type",e.transaction_type)),e!=null&&e.city_region&&(a=a.eq("city_region",e.city_region)),e!=null&&e.property_type&&(a=a.eq("property_type",e.property_type)),e!=null&&e.district&&(a=a.eq("district",e.district)),(e==null?void 0:e.featured)==="true"&&(a=a.eq("featured",!0)),e!=null&&e.price_min&&(a=a.gte("price",parseFloat(e.price_min))),e!=null&&e.price_max&&(a=a.lte("price",parseFloat(e.price_max))),e!=null&&e.area_min&&(a=a.gte("area",parseFloat(e.area_min))),e!=null&&e.area_max&&(a=a.lte("area",parseFloat(e.area_max)));const i=(s-1)*r,o=i+r-1,{data:d,error:l,count:c}=await a.range(i,o).limit(r);if(l)return console.error("Supabase error:",l),{success:!1,error:l.message};const u=c||0,h=Math.ceil(u/r);return{success:!0,data:d||[],meta:{page:s,limit:r,total:u,pages:h,hasPrev:s>1,hasNext:s<h}}}catch(a){return console.error("Error fetching properties:",a),{success:!1,error:"Failed to fetch properties"}}}async getProperty(e){try{const{data:s,error:r}=await Q.from("properties").select(`
          *,
          images:property_images(*)
        `).eq("id",e).eq("active",!0).single();return r?(console.error("Supabase error:",r),{success:!1,error:r.message}):{success:!0,data:s}}catch(s){return console.error("Error fetching property:",s),{success:!1,error:"Failed to fetch property"}}}async createProperty(e){try{const{data:s,error:r}=await Q.from("properties").insert(e).select().single();return r?(console.error("Supabase error:",r),{success:!1,error:r.message}):{success:!0,data:s}}catch(s){return console.error("Error creating property:",s),{success:!1,error:"Failed to create property"}}}async updateProperty(e,s){try{const{data:r,error:a}=await Q.from("properties").update(s).eq("id",e).select().single();return a?(console.error("Supabase error:",a),{success:!1,error:a.message}):{success:!0,data:r}}catch(r){return console.error("Error updating property:",r),{success:!1,error:"Failed to update property"}}}async deleteProperty(e){try{const{error:s}=await Q.from("properties").delete().eq("id",e);return s?(console.error("Supabase error:",s),{success:!1,error:s.message}):{success:!0}}catch(s){return console.error("Error deleting property:",s),{success:!1,error:"Failed to delete property"}}}async uploadPropertyImage(e,s,r=!1,a=0){try{r&&await Q.from("property_images").update({is_main:!1}).eq("property_id",e);const{data:i,error:o}=await Q.from("property_images").insert({property_id:e,image_url:s,is_main:r,sort_order:a}).select().single();return o?(console.error("Supabase error:",o),{success:!1,error:o.message}):{success:!0,data:i}}catch(i){return console.error("Error uploading image:",i),{success:!1,error:"Failed to upload image"}}}async setMainImage(e,s){try{await Q.from("property_images").update({is_main:!1}).eq("property_id",e);const{error:r}=await Q.from("property_images").update({is_main:!0}).eq("id",s).eq("property_id",e);return r?(console.error("Supabase error:",r),{success:!1,error:r.message}):{success:!0}}catch(r){return console.error("Error setting main image:",r),{success:!1,error:"Failed to set main image"}}}async deletePropertyImage(e){try{const{error:s}=await Q.from("property_images").delete().eq("id",e);return s?(console.error("Supabase error:",s),{success:!1,error:s.message}):{success:!0}}catch(s){return console.error("Error deleting image:",s),{success:!1,error:"Failed to delete image"}}}async getPages(e=!0){try{let s=Q.from("pages").select("*").order("title");e&&(s=s.eq("active",!0));const{data:r,error:a}=await s;return a?(console.error("Supabase error:",a),{success:!1,error:a.message}):{success:!0,data:r||[]}}catch(s){return console.error("Error fetching pages:",s),{success:!1,error:"Failed to fetch pages"}}}async getPageBySlug(e){try{const{data:s,error:r}=await Q.from("pages").select("*").eq("slug",e).eq("active",!0).single();return r?(console.error("Supabase error:",r),{success:!1,error:r.message}):{success:!0,data:s}}catch(s){return console.error("Error fetching page:",s),{success:!1,error:"Failed to fetch page"}}}async getServices(e=!0){try{let s=Q.from("services").select("*").order("sort_order");e&&(s=s.eq("active",!0));const{data:r,error:a}=await s;return a?(console.error("Supabase error:",a),{success:!1,error:a.message}):{success:!0,data:r||[]}}catch(s){return console.error("Error fetching services:",s),{success:!1,error:"Failed to fetch services"}}}async getPropertyStats(){try{const{data:e,error:s}=await Q.from("properties").select("id, active, featured, transaction_type");return s?(console.error("Supabase error:",s),{success:!1,error:s.message}):{success:!0,data:{totalProperties:(e==null?void 0:e.length)||0,activeProperties:(e==null?void 0:e.filter(a=>a.active).length)||0,featuredProperties:(e==null?void 0:e.filter(a=>a.featured).length)||0,saleProperties:(e==null?void 0:e.filter(a=>a.transaction_type==="sale").length)||0,rentProperties:(e==null?void 0:e.filter(a=>a.transaction_type==="rent").length)||0}}}catch(e){return console.error("Error fetching stats:",e),{success:!1,error:"Failed to fetch statistics"}}}}const nl=new rl,al=()=>{const[n,e]=k.useState("loading"),[s,r]=k.useState([]),[a,i]=k.useState("");k.useEffect(()=>{o()},[]);const o=async()=>{try{e("loading");const{data:d,error:l}=await Q.from("properties").select("id, title, price, city_region").limit(5);if(l)throw l;r(d||[]),e("success");const c=await nl.getProperties({},1,3);console.log("Service test result:",c)}catch(d){console.error("Supabase connection test failed:",d),i(d.message||"Connection failed"),e("error")}};return t.jsx("div",{className:"max-w-4xl mx-auto p-6",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx(wn,{className:"w-8 h-8 text-blue-600"}),t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Supabase Connection Test"})]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n==="loading"&&t.jsxs(t.Fragment,{children:[t.jsx(jn,{className:"w-5 h-5 text-blue-600 animate-spin"}),t.jsx("span",{className:"text-blue-600 font-medium",children:"Testing connection..."})]}),n==="success"&&t.jsxs(t.Fragment,{children:[t.jsx(_n,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"text-green-600 font-medium",children:"Connected successfully!"})]}),n==="error"&&t.jsxs(t.Fragment,{children:[t.jsx(Nn,{className:"w-5 h-5 text-red-600"}),t.jsx("span",{className:"text-red-600 font-medium",children:"Connection failed"})]})]}),a&&t.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:[t.jsx("strong",{children:"Error:"})," ",a]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[t.jsx("h3",{className:"font-bold text-gray-900 mb-3",children:"Connection Details"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"URL:"})," ","https://mveeovfztfczibtvkpas.supabase.co"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"API Key:"})," ","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im12ZWVvdmZ6dGZjemlidHZrcGFzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxNzc1NDMsImV4cCI6MjA3Mjc1MzU0M30.XMAd9FCnLt57L_HgE3BLkGj1oURCvD7ay9B2SJBhtDI".substring(0,20),"..."]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Database:"})," PostgreSQL"]})]})]}),s.length>0&&t.jsxs("div",{children:[t.jsxs("h3",{className:"font-bold text-gray-900 mb-4",children:["Sample Properties (",s.length,")"]}),t.jsx("div",{className:"space-y-3",children:s.map(d=>t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900",children:d.title}),t.jsx("p",{className:"text-sm text-gray-600",children:d.city_region})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"font-bold text-blue-600",children:["€",Math.floor(d.price||0).toLocaleString()]}),t.jsx("div",{className:"text-xs text-gray-500",children:d.id})]})]})},d.id))})]}),t.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:t.jsx("button",{onClick:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Test Connection Again"})})]})})},il=()=>t.jsxs("div",{children:[t.jsx(ma,{}),t.jsx(pa,{}),t.jsx(ya,{})]});function ol(){return t.jsx(lr,{children:t.jsx(En,{children:t.jsxs("div",{className:"flex flex-col min-h-screen",children:[t.jsx("main",{className:"flex-grow",children:t.jsxs(Cn,{children:[t.jsx(z,{path:"/",element:t.jsx(il,{})}),t.jsx(z,{path:"/properties",element:t.jsx(Ta,{})}),t.jsx(z,{path:"/properties/:id",element:t.jsx(ks,{})}),t.jsx(z,{path:"/contact",element:t.jsx(Pa,{})}),t.jsx(z,{path:"/about",element:t.jsx(Es,{})}),t.jsx(z,{path:"/:slug",element:t.jsx(Es,{})}),t.jsx(z,{path:"/property/:id",element:t.jsx(ks,{})}),t.jsx(z,{path:"/admin/login",element:t.jsx(Aa,{})}),t.jsx(z,{path:"/admin",element:t.jsx(Oa,{})}),t.jsx(z,{path:"/admin/new",element:t.jsx(Cs,{mode:"create"})}),t.jsx(z,{path:"/admin/edit/:id",element:t.jsx(Cs,{mode:"edit"})}),t.jsx(z,{path:"/admin/services",element:t.jsx(Ia,{})}),t.jsx(z,{path:"/admin/services/new",element:t.jsx(Ts,{})}),t.jsx(z,{path:"/admin/services/:id/edit",element:t.jsx(Ts,{})}),t.jsx(z,{path:"/admin/pages",element:t.jsx(La,{})}),t.jsx(z,{path:"/admin/pages/new",element:t.jsx(Ps,{})}),t.jsx(z,{path:"/admin/pages/:id/edit",element:t.jsx(Ps,{})}),t.jsx(z,{path:"/admin/sections",element:t.jsx(Da,{})}),t.jsx(z,{path:"/admin/sections/new",element:t.jsx(Os,{})}),t.jsx(z,{path:"/admin/sections/:id/edit",element:t.jsx(Os,{})}),t.jsx(z,{path:"/supabase-test",element:t.jsx(al,{})})]})}),t.jsx(Cr,{})]})})})}tr(document.getElementById("root")).render(t.jsx(k.StrictMode,{children:t.jsx(ol,{})}));
